{"pageProps":{"state":{"globalHeaders":{"https://napari-hub.org":{"level":1,"children":[],"href":"https://napari-hub.org","text":"napari hub"},"https://github.com/napari/napari":{"level":1,"children":[],"href":"https://github.com/napari/napari","text":"napari source code"},"/developers/index.html":{"level":1,"children":["/developers/benchmarks.html","/developers/contributing.html","/developers/core_dev_guide.html","/developers/profiling.html","/developers/release.html","/developers/testing.html","/developers/docs.html","/developers/translations.html"],"href":"/developers/index.html","text":"Developer resources"},"/developers/translations.html":{"level":2,"children":[],"href":"/developers/translations.html","text":"Translations"},"/developers/docs.html":{"level":2,"children":[],"href":"/developers/docs.html","text":"Organization of Documentation for napari"},"/developers/testing.html":{"level":2,"children":[],"href":"/developers/testing.html","text":"Testing"},"/developers/release.html":{"level":2,"children":[],"href":"/developers/release.html","text":"Release guide"},"/developers/profiling.html":{"level":2,"children":[],"href":"/developers/profiling.html","text":"Profiling"},"/developers/core_dev_guide.html":{"level":2,"children":[],"href":"/developers/core_dev_guide.html","text":"Core Developer guide"},"/developers/contributing.html":{"level":2,"children":[],"href":"/developers/contributing.html","text":"Contributing guide"},"/developers/benchmarks.html":{"level":2,"children":[],"href":"/developers/benchmarks.html","text":"Benchmarks"},"/guides/stable/index.html":{"level":1,"children":["/guides/stable/event_loop.html","/guides/stable/threading.html","/guides/stable/rendering.html","/guides/stable/performance.html","/guides/stable/magicgui.html","/guides/stable/rendering-explanation.html","/guides/stable/3D_interactivity.html","/guides/stable/events_reference.html","/guides/stable/contexts_expressions.html"],"href":"/guides/stable/index.html","text":"Developer guides"},"/guides/stable/contexts_expressions.html":{"level":2,"children":[],"href":"/guides/stable/contexts_expressions.html","text":"Contexts and Expressions in napari"},"/guides/stable/events_reference.html":{"level":2,"children":[],"href":"/guides/stable/events_reference.html","text":"Events reference"},"/guides/stable/3D_interactivity.html":{"level":2,"children":[],"href":"/guides/stable/3D_interactivity.html","text":"3D interactivity"},"/guides/stable/rendering-explanation.html":{"level":2,"children":[],"href":"/guides/stable/rendering-explanation.html","text":"Rendering in napari"},"/guides/stable/magicgui.html":{"level":2,"children":[],"href":"/guides/stable/magicgui.html","text":"Using magicgui in napari"},"/guides/stable/performance.html":{"level":2,"children":[],"href":"/guides/stable/performance.html","text":"napari performance"},"/guides/stable/rendering.html":{"level":2,"children":[],"href":"/guides/stable/rendering.html","text":"Asynchronous rendering"},"/guides/stable/threading.html":{"level":2,"children":[],"href":"/guides/stable/threading.html","text":"Multithreading in napari"},"/guides/stable/event_loop.html":{"level":2,"children":[],"href":"/guides/stable/event_loop.html","text":"An introduction to the event loop in napari"},"/roadmaps/index.html":{"level":1,"children":["/roadmaps/0_4.html","/roadmaps/0_3_retrospective.html","/roadmaps/0_3.html"],"href":"/roadmaps/index.html","text":"Roadmaps"},"/roadmaps/0_3.html":{"level":2,"children":[],"href":"/roadmaps/0_3.html","text":"Roadmap 0.3"},"/roadmaps/0_3_retrospective.html":{"level":2,"children":[],"href":"/roadmaps/0_3_retrospective.html","text":"Roadmap 0.3 Retrospective"},"/roadmaps/0_4.html":{"level":2,"children":[],"href":"/roadmaps/0_4.html","text":"Roadmap 0.4"},"/api/stable/index.html":{"level":1,"children":["/api/stable/napari.layers.html","/api/stable/napari.view_layers.html","/api/stable/napari.types.html","/api/stable/napari.utils.html","/api/stable/napari.plugins.html","/api/stable/napari.components.html","/api/stable/napari.qt.threading.html","/api/stable/napari.utils.perf.html","/api/stable/napari.html","/api/stable/napari.html"],"href":"/api/stable/index.html","text":"API reference"},"/api/stable/napari.html":{"level":2,"children":["/api/stable/napari.Viewer.html"],"href":"/api/stable/napari.html","text":"napari"},"/api/stable/napari.Viewer.html":{"level":3,"children":[],"href":"/api/stable/napari.Viewer.html","text":"napari.Viewer"},"/api/stable/napari.utils.perf.html":{"level":2,"children":["/api/stable/napari.utils.perf.PerfEvent.html"],"href":"/api/stable/napari.utils.perf.html","text":"napari.utils.perf"},"/api/stable/napari.utils.perf.PerfEvent.html":{"level":3,"children":[],"href":"/api/stable/napari.utils.perf.PerfEvent.html","text":"napari.utils.perf.PerfEvent"},"/api/stable/napari.qt.threading.html":{"level":2,"children":["/api/stable/napari.qt.threading.FunctionWorker.html","/api/stable/napari.qt.threading.GeneratorWorker.html","/api/stable/napari.qt.threading.GeneratorWorkerSignals.html","/api/stable/napari.qt.threading.WorkerBase.html","/api/stable/napari.qt.threading.WorkerBaseSignals.html"],"href":"/api/stable/napari.qt.threading.html","text":"napari.qt.threading"},"/api/stable/napari.qt.threading.WorkerBaseSignals.html":{"level":3,"children":[],"href":"/api/stable/napari.qt.threading.WorkerBaseSignals.html","text":"napari.qt.threading.WorkerBaseSignals"},"/api/stable/napari.qt.threading.WorkerBase.html":{"level":3,"children":[],"href":"/api/stable/napari.qt.threading.WorkerBase.html","text":"napari.qt.threading.WorkerBase"},"/api/stable/napari.qt.threading.GeneratorWorkerSignals.html":{"level":3,"children":[],"href":"/api/stable/napari.qt.threading.GeneratorWorkerSignals.html","text":"napari.qt.threading.GeneratorWorkerSignals"},"/api/stable/napari.qt.threading.GeneratorWorker.html":{"level":3,"children":[],"href":"/api/stable/napari.qt.threading.GeneratorWorker.html","text":"napari.qt.threading.GeneratorWorker"},"/api/stable/napari.qt.threading.FunctionWorker.html":{"level":3,"children":[],"href":"/api/stable/napari.qt.threading.FunctionWorker.html","text":"napari.qt.threading.FunctionWorker"},"/api/stable/napari.components.html":{"level":2,"children":["/api/stable/napari.components.Camera.html","/api/stable/napari.components.Dims.html","/api/stable/napari.components.LayerList.html","/api/stable/napari.components.ViewerModel.html"],"href":"/api/stable/napari.components.html","text":"napari.components"},"/api/stable/napari.components.ViewerModel.html":{"level":3,"children":[],"href":"/api/stable/napari.components.ViewerModel.html","text":"napari.components.ViewerModel"},"/api/stable/napari.components.LayerList.html":{"level":3,"children":[],"href":"/api/stable/napari.components.LayerList.html","text":"napari.components.LayerList"},"/api/stable/napari.components.Dims.html":{"level":3,"children":[],"href":"/api/stable/napari.components.Dims.html","text":"napari.components.Dims"},"/api/stable/napari.components.Camera.html":{"level":3,"children":[],"href":"/api/stable/napari.components.Camera.html","text":"napari.components.Camera"},"/api/stable/napari.plugins.html":{"level":2,"children":["/api/stable/napari.plugins.NapariPluginManager.html"],"href":"/api/stable/napari.plugins.html","text":"napari.plugins"},"/api/stable/napari.plugins.NapariPluginManager.html":{"level":3,"children":[],"href":"/api/stable/napari.plugins.NapariPluginManager.html","text":"napari.plugins.NapariPluginManager"},"/api/stable/napari.utils.html":{"level":2,"children":["/api/stable/napari.utils.Colormap.html","/api/stable/napari.utils.nbscreenshot.html","/api/stable/napari.utils.progress.html"],"href":"/api/stable/napari.utils.html","text":"napari.utils"},"/api/stable/napari.utils.progress.html":{"level":3,"children":[],"href":"/api/stable/napari.utils.progress.html","text":"napari.utils.progress"},"/api/stable/napari.utils.nbscreenshot.html":{"level":3,"children":[],"href":"/api/stable/napari.utils.nbscreenshot.html","text":"napari.utils.nbscreenshot"},"/api/stable/napari.utils.Colormap.html":{"level":3,"children":[],"href":"/api/stable/napari.utils.Colormap.html","text":"napari.utils.Colormap"},"/api/stable/napari.types.html":{"level":2,"children":["/api/stable/napari.types.ArrayBase.html","/api/stable/napari.types.Path.html","/api/stable/napari.types.SampleDict.html","/api/stable/napari.types.TracebackType.html","/api/stable/napari.types.TypedDict.html","/api/stable/napari.types.partial.html"],"href":"/api/stable/napari.types.html","text":"napari.types"},"/api/stable/napari.types.partial.html":{"level":3,"children":[],"href":"/api/stable/napari.types.partial.html","text":"napari.types.partial"},"/api/stable/napari.types.TypedDict.html":{"level":3,"children":[],"href":"/api/stable/napari.types.TypedDict.html","text":"napari.types.TypedDict"},"/api/stable/napari.types.TracebackType.html":{"level":3,"children":[],"href":"/api/stable/napari.types.TracebackType.html","text":"napari.types.TracebackType"},"/api/stable/napari.types.SampleDict.html":{"level":3,"children":[],"href":"/api/stable/napari.types.SampleDict.html","text":"napari.types.SampleDict"},"/api/stable/napari.types.Path.html":{"level":3,"children":[],"href":"/api/stable/napari.types.Path.html","text":"napari.types.Path"},"/api/stable/napari.types.ArrayBase.html":{"level":3,"children":[],"href":"/api/stable/napari.types.ArrayBase.html","text":"napari.types.ArrayBase"},"/api/stable/napari.view_layers.html":{"level":2,"children":["/api/stable/napari.view_layers.Viewer.html"],"href":"/api/stable/napari.view_layers.html","text":"napari.view_layers"},"/api/stable/napari.view_layers.Viewer.html":{"level":3,"children":[],"href":"/api/stable/napari.view_layers.Viewer.html","text":"napari.view_layers.Viewer"},"/api/stable/napari.layers.html":{"level":2,"children":["/api/stable/napari.layers.Image.html","/api/stable/napari.layers.Labels.html","/api/stable/napari.layers.Layer.html","/api/stable/napari.layers.Points.html","/api/stable/napari.layers.Shapes.html","/api/stable/napari.layers.Surface.html","/api/stable/napari.layers.Tracks.html","/api/stable/napari.layers.Vectors.html"],"href":"/api/stable/napari.layers.html","text":"napari.layers"},"/api/stable/napari.layers.Vectors.html":{"level":3,"children":[],"href":"/api/stable/napari.layers.Vectors.html","text":"napari.layers.Vectors"},"/api/stable/napari.layers.Tracks.html":{"level":3,"children":[],"href":"/api/stable/napari.layers.Tracks.html","text":"napari.layers.Tracks"},"/api/stable/napari.layers.Surface.html":{"level":3,"children":[],"href":"/api/stable/napari.layers.Surface.html","text":"napari.layers.Surface"},"/api/stable/napari.layers.Shapes.html":{"level":3,"children":[],"href":"/api/stable/napari.layers.Shapes.html","text":"napari.layers.Shapes"},"/api/stable/napari.layers.Points.html":{"level":3,"children":[],"href":"/api/stable/napari.layers.Points.html","text":"napari.layers.Points"},"/api/stable/napari.layers.Layer.html":{"level":3,"children":[],"href":"/api/stable/napari.layers.Layer.html","text":"napari.layers.Layer"},"/api/stable/napari.layers.Labels.html":{"level":3,"children":[],"href":"/api/stable/napari.layers.Labels.html","text":"napari.layers.Labels"},"/api/stable/napari.layers.Image.html":{"level":3,"children":[],"href":"/api/stable/napari.layers.Image.html","text":"napari.layers.Image"},"/release/index.html":{"level":1,"children":["/release/release_0_4_12.html","/release/release_0_4_11.html","/release/release_0_4_10.html","/release/release_0_4_9.html","/release/release_0_4_8.html","/release/release_0_4_7.html","/release/release_0_4_6.html","/release/release_0_4_5.html","/release/release_0_4_4.html","/release/release_0_4_3.html","/release/release_0_4_2.html","/release/release_0_4_1.html","/release/release_0_4_0.html","/release/release_0_3_8.html","/release/release_0_3_7.html","/release/release_0_3_6.html","/release/release_0_3_5.html","/release/release_0_3_4.html","/release/release_0_3_3.html","/release/release_0_3_2.html","/release/release_0_3_1.html","/release/release_0_3_0.html","/release/release_0_2_12.html","/release/release_0_2_11.html","/release/release_0_2_10.html","/release/release_0_2_9.html","/release/release_0_2_8.html","/release/release_0_2_7.html","/release/release_0_2_6.html","/release/release_0_2_5.html","/release/release_0_2_4.html","/release/release_0_2_3.html","/release/release_0_2_1.html","/release/release_0_2_0.html","/release/release_0_1_5.html","/release/release_0_1_3.html","/release/release_0_1_0.html"],"href":"/release/index.html","text":"Release notes"},"/release/release_0_1_0.html":{"level":2,"children":[],"href":"/release/release_0_1_0.html","text":"napari 0.1.0"},"/release/release_0_1_3.html":{"level":2,"children":[],"href":"/release/release_0_1_3.html","text":"napari 0.1.3"},"/release/release_0_1_5.html":{"level":2,"children":[],"href":"/release/release_0_1_5.html","text":"napari 0.1.5"},"/release/release_0_2_0.html":{"level":2,"children":[],"href":"/release/release_0_2_0.html","text":"napari 0.2.0"},"/release/release_0_2_1.html":{"level":2,"children":[],"href":"/release/release_0_2_1.html","text":"napari 0.2.1"},"/release/release_0_2_3.html":{"level":2,"children":[],"href":"/release/release_0_2_3.html","text":"napari 0.2.3"},"/release/release_0_2_4.html":{"level":2,"children":[],"href":"/release/release_0_2_4.html","text":"napari 0.2.4"},"/release/release_0_2_5.html":{"level":2,"children":[],"href":"/release/release_0_2_5.html","text":"napari 0.2.5"},"/release/release_0_2_6.html":{"level":2,"children":[],"href":"/release/release_0_2_6.html","text":"napari 0.2.6"},"/release/release_0_2_7.html":{"level":2,"children":[],"href":"/release/release_0_2_7.html","text":"napari 0.2.7"},"/release/release_0_2_8.html":{"level":2,"children":[],"href":"/release/release_0_2_8.html","text":"napari 0.2.8"},"/release/release_0_2_9.html":{"level":2,"children":[],"href":"/release/release_0_2_9.html","text":"napari 0.2.9"},"/release/release_0_2_10.html":{"level":2,"children":[],"href":"/release/release_0_2_10.html","text":"napari 0.2.10"},"/release/release_0_2_11.html":{"level":2,"children":[],"href":"/release/release_0_2_11.html","text":"napari 0.2.11"},"/release/release_0_2_12.html":{"level":2,"children":[],"href":"/release/release_0_2_12.html","text":"napari 0.2.12"},"/release/release_0_3_0.html":{"level":2,"children":[],"href":"/release/release_0_3_0.html","text":"napari 0.3.0"},"/release/release_0_3_1.html":{"level":2,"children":[],"href":"/release/release_0_3_1.html","text":"napari 0.3.1"},"/release/release_0_3_2.html":{"level":2,"children":[],"href":"/release/release_0_3_2.html","text":"napari 0.3.2"},"/release/release_0_3_3.html":{"level":2,"children":[],"href":"/release/release_0_3_3.html","text":"napari 0.3.3"},"/release/release_0_3_4.html":{"level":2,"children":[],"href":"/release/release_0_3_4.html","text":"napari 0.3.4"},"/release/release_0_3_5.html":{"level":2,"children":[],"href":"/release/release_0_3_5.html","text":"napari 0.3.5"},"/release/release_0_3_6.html":{"level":2,"children":[],"href":"/release/release_0_3_6.html","text":"napari 0.3.6"},"/release/release_0_3_7.html":{"level":2,"children":[],"href":"/release/release_0_3_7.html","text":"napari 0.3.7"},"/release/release_0_3_8.html":{"level":2,"children":[],"href":"/release/release_0_3_8.html","text":"napari 0.3.8"},"/release/release_0_4_0.html":{"level":2,"children":[],"href":"/release/release_0_4_0.html","text":"napari 0.4.0"},"/release/release_0_4_1.html":{"level":2,"children":[],"href":"/release/release_0_4_1.html","text":"napari 0.4.1"},"/release/release_0_4_2.html":{"level":2,"children":[],"href":"/release/release_0_4_2.html","text":"napari 0.4.2"},"/release/release_0_4_3.html":{"level":2,"children":[],"href":"/release/release_0_4_3.html","text":"napari 0.4.3"},"/release/release_0_4_4.html":{"level":2,"children":[],"href":"/release/release_0_4_4.html","text":"napari 0.4.4"},"/release/release_0_4_5.html":{"level":2,"children":[],"href":"/release/release_0_4_5.html","text":"napari 0.4.5"},"/release/release_0_4_6.html":{"level":2,"children":[],"href":"/release/release_0_4_6.html","text":"napari 0.4.6"},"/release/release_0_4_7.html":{"level":2,"children":[],"href":"/release/release_0_4_7.html","text":"napari 0.4.7"},"/release/release_0_4_8.html":{"level":2,"children":[],"href":"/release/release_0_4_8.html","text":"napari 0.4.8"},"/release/release_0_4_9.html":{"level":2,"children":[],"href":"/release/release_0_4_9.html","text":"napari 0.4.9"},"/release/release_0_4_10.html":{"level":2,"children":[],"href":"/release/release_0_4_10.html","text":"napari 0.4.10"},"/release/release_0_4_11.html":{"level":2,"children":[],"href":"/release/release_0_4_11.html","text":"napari 0.4.11"},"/release/release_0_4_12.html":{"level":2,"children":[],"href":"/release/release_0_4_12.html","text":"napari 0.4.12"},"/plugins/stable/index.html":{"level":1,"children":["/plugins/stable/for_napari_developers.html","/plugins/stable/for_plugin_developers.html","/plugins/stable/hook_specifications.html","/plugins/stable/find-and-install-plugin.html","/plugins/stable/best_practices.html"],"href":"/plugins/stable/index.html","text":"Plugins"},"/plugins/stable/best_practices.html":{"level":2,"children":[],"href":"/plugins/stable/best_practices.html","text":"Best practices when developing napari plugins"},"/plugins/stable/find-and-install-plugin.html":{"level":2,"children":[],"href":"/plugins/stable/find-and-install-plugin.html","text":"Finding and installing a napari plugin"},"/plugins/stable/hook_specifications.html":{"level":2,"children":[],"href":"/plugins/stable/hook_specifications.html","text":"napari hook specification reference"},"/plugins/stable/for_plugin_developers.html":{"level":2,"children":[],"href":"/plugins/stable/for_plugin_developers.html","text":"Creating a napari plugin"},"/plugins/stable/for_napari_developers.html":{"level":2,"children":[],"href":"/plugins/stable/for_napari_developers.html","text":"napari plugin architecture"},"/tutorials/index.html":{"level":1,"children":["/tutorials/fundamentals/index.html","/tutorials/applications/index.html","/tutorials/further-resources/napari-workshops.html"],"href":"/tutorials/index.html","text":"Tutorials"},"/tutorials/further-resources/napari-workshops.html":{"level":2,"children":[],"href":"/tutorials/further-resources/napari-workshops.html","text":"napari workshops"},"/tutorials/applications/index.html":{"level":2,"children":["/tutorials/applications/annotate_segmentation.html","/tutorials/applications/annotate_points.html","/tutorials/applications/dask.html","/tutorials/applications/napari_imageJ.html","/tutorials/applications/cell_tracking.html"],"href":"/tutorials/applications/index.html","text":"Applications"},"/tutorials/applications/cell_tracking.html":{"level":3,"children":[],"href":"/tutorials/applications/cell_tracking.html","text":"Single cell tracking with napari"},"/tutorials/applications/napari_imageJ.html":{"level":3,"children":[],"href":"/tutorials/applications/napari_imageJ.html","text":"napari + ImageJ how-to guide"},"/tutorials/applications/dask.html":{"level":3,"children":[],"href":"/tutorials/applications/dask.html","text":"Using Dask and napari to process & view large datasets"},"/tutorials/applications/annotate_points.html":{"level":3,"children":[],"href":"/tutorials/applications/annotate_points.html","text":"Annotating videos with napari"},"/tutorials/applications/annotate_segmentation.html":{"level":3,"children":[],"href":"/tutorials/applications/annotate_segmentation.html","text":"Annotating segmentation with text and bounding boxes"},"/tutorials/fundamentals/index.html":{"level":2,"children":["/tutorials/fundamentals/installation.html","/tutorials/fundamentals/getting_started.html","/tutorials/fundamentals/viewer.html","/tutorials/fundamentals/image.html","/tutorials/fundamentals/labels.html","/tutorials/fundamentals/points.html","/tutorials/fundamentals/shapes.html","/tutorials/fundamentals/surface.html","/tutorials/fundamentals/tracks.html","/tutorials/fundamentals/vectors.html"],"href":"/tutorials/fundamentals/index.html","text":"Fundamentals"},"/tutorials/fundamentals/vectors.html":{"level":3,"children":[],"href":"/tutorials/fundamentals/vectors.html","text":"vectors layer tutorial"},"/tutorials/fundamentals/tracks.html":{"level":3,"children":[],"href":"/tutorials/fundamentals/tracks.html","text":"tracks layer tutorial"},"/tutorials/fundamentals/surface.html":{"level":3,"children":[],"href":"/tutorials/fundamentals/surface.html","text":"surface layer tutorial"},"/tutorials/fundamentals/shapes.html":{"level":3,"children":[],"href":"/tutorials/fundamentals/shapes.html","text":"shapes layer tutorial"},"/tutorials/fundamentals/points.html":{"level":3,"children":[],"href":"/tutorials/fundamentals/points.html","text":"points layer tutorial"},"/tutorials/fundamentals/labels.html":{"level":3,"children":[],"href":"/tutorials/fundamentals/labels.html","text":"labels layer tutorial"},"/tutorials/fundamentals/image.html":{"level":3,"children":[],"href":"/tutorials/fundamentals/image.html","text":"image layer tutorial"},"/tutorials/fundamentals/viewer.html":{"level":3,"children":[],"href":"/tutorials/fundamentals/viewer.html","text":"napari viewer tutorial"},"/tutorials/fundamentals/getting_started.html":{"level":3,"children":[],"href":"/tutorials/fundamentals/getting_started.html","text":"Getting started with napari"},"/tutorials/fundamentals/installation.html":{"level":3,"children":[],"href":"/tutorials/fundamentals/installation.html","text":"How to install napari on your machine"},"/community/index.html":{"level":1,"children":["/community/mission_and_values.html","/community/team.html","/community/code_of_conduct.html","/community/code_of_conduct_reporting.html","/community/governance.html","/community/working_groups.html"],"href":"/community/index.html","text":"Community"},"/community/working_groups.html":{"level":2,"children":[],"href":"/community/working_groups.html","text":"Working groups"},"/community/governance.html":{"level":2,"children":[],"href":"/community/governance.html","text":"Governance model"},"/community/code_of_conduct_reporting.html":{"level":2,"children":[],"href":"/community/code_of_conduct_reporting.html","text":"Handling Code of Conduct reports"},"/community/code_of_conduct.html":{"level":2,"children":[],"href":"/community/code_of_conduct.html","text":"Code of Conduct"},"/community/team.html":{"level":2,"children":[],"href":"/community/team.html","text":"About the project and team"},"/community/mission_and_values.html":{"level":2,"children":[],"href":"/community/mission_and_values.html","text":"Mission and Values"}},"rootGlobalHeaders":["/community/index.html","/tutorials/index.html","/plugins/stable/index.html","/release/index.html","/api/stable/index.html","/roadmaps/index.html","/guides/stable/index.html","/developers/index.html","https://github.com/napari/napari","https://napari-hub.org"],"pageTitle":"Source code for napari.layers.labels.labels","pageFrontMatter":{},"previewImage":"/_data-images/w9U5ybFZ-0-BPwXGjdDg4qUXOfQwRU6rAdba8uZf4go.png","previewDescription":"","appScripts":[{"src":"/_static/documentation_options.js"},{"src":"/_static/jquery.js"},{"src":"/_static/underscore.js"},{"src":"/_static/doctools.js"},{"src":"/_static/togglebutton.js"},{"src":"/_static/clipboard.min.js"},{"src":"/_static/copybutton.js"},{"children":"var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';"}],"appStyleSheets":[{"href":"/_static/pygments.css","rel":"stylesheet"},{"href":"/_static/togglebutton.css","rel":"stylesheet","type":"text/css"},{"href":"/_static/copybutton.css","rel":"stylesheet","type":"text/css"},{"href":"/_static/mystnb.css","rel":"stylesheet","type":"text/css"},{"href":"/_static/sphinx-thebe.css","rel":"stylesheet","type":"text/css"},{"href":"/_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css","rel":"stylesheet","type":"text/css"},{"href":"/_static/panels-variables.06eb56fa6e07937060861dad626602ad.css","rel":"stylesheet","type":"text/css"}],"pageBodyHtml":"\n        <div id=\"documentation_options\" data-url_root=\"../../../../\"></div>\n        <div class=\"highlight\"><pre><span></span><span class=\"kn\">import</span> <span class=\"nn\">warnings</span>\n<span class=\"kn\">from</span> <span class=\"nn\">collections</span> <span class=\"kn\">import</span> <span class=\"n\">deque</span>\n<span class=\"kn\">from</span> <span class=\"nn\">typing</span> <span class=\"kn\">import</span> <span class=\"n\">Dict</span><span class=\"p\">,</span> <span class=\"n\">List</span><span class=\"p\">,</span> <span class=\"n\">Optional</span><span class=\"p\">,</span> <span class=\"n\">Tuple</span><span class=\"p\">,</span> <span class=\"n\">Union</span>\n\n<span class=\"kn\">import</span> <span class=\"nn\">numpy</span> <span class=\"k\">as</span> <span class=\"nn\">np</span>\n<span class=\"kn\">from</span> <span class=\"nn\">scipy</span> <span class=\"kn\">import</span> <span class=\"n\">ndimage</span> <span class=\"k\">as</span> <span class=\"n\">ndi</span>\n\n<span class=\"kn\">from</span> <span class=\"nn\">...utils</span> <span class=\"kn\">import</span> <span class=\"n\">config</span>\n<span class=\"kn\">from</span> <span class=\"nn\">...utils._dtype</span> <span class=\"kn\">import</span> <span class=\"n\">normalize_dtype</span>\n<span class=\"kn\">from</span> <span class=\"nn\">...utils.colormaps</span> <span class=\"kn\">import</span> <span class=\"p\">(</span>\n    <span class=\"n\">color_dict_to_colormap</span><span class=\"p\">,</span>\n    <span class=\"n\">label_colormap</span><span class=\"p\">,</span>\n    <span class=\"n\">low_discrepancy_image</span><span class=\"p\">,</span>\n<span class=\"p\">)</span>\n<span class=\"kn\">from</span> <span class=\"nn\">...utils.events</span> <span class=\"kn\">import</span> <span class=\"n\">Event</span>\n<span class=\"kn\">from</span> <span class=\"nn\">...utils.events.custom_types</span> <span class=\"kn\">import</span> <span class=\"n\">Array</span>\n<span class=\"kn\">from</span> <span class=\"nn\">...utils.geometry</span> <span class=\"kn\">import</span> <span class=\"n\">clamp_point_to_bounding_box</span>\n<span class=\"kn\">from</span> <span class=\"nn\">...utils.status_messages</span> <span class=\"kn\">import</span> <span class=\"n\">generate_layer_status</span>\n<span class=\"kn\">from</span> <span class=\"nn\">...utils.translations</span> <span class=\"kn\">import</span> <span class=\"n\">trans</span>\n<span class=\"kn\">from</span> <span class=\"nn\">..base</span> <span class=\"kn\">import</span> <span class=\"n\">no_op</span>\n<span class=\"kn\">from</span> <span class=\"nn\">..image._image_utils</span> <span class=\"kn\">import</span> <span class=\"n\">guess_multiscale</span>\n<span class=\"kn\">from</span> <span class=\"nn\">..image.image</span> <span class=\"kn\">import</span> <span class=\"n\">_ImageBase</span>\n<span class=\"kn\">from</span> <span class=\"nn\">..utils.color_transformations</span> <span class=\"kn\">import</span> <span class=\"n\">transform_color</span>\n<span class=\"kn\">from</span> <span class=\"nn\">..utils.layer_utils</span> <span class=\"kn\">import</span> <span class=\"n\">validate_properties</span>\n<span class=\"kn\">from</span> <span class=\"nn\">._labels_constants</span> <span class=\"kn\">import</span> <span class=\"n\">LabelColorMode</span><span class=\"p\">,</span> <span class=\"n\">Mode</span>\n<span class=\"kn\">from</span> <span class=\"nn\">._labels_mouse_bindings</span> <span class=\"kn\">import</span> <span class=\"n\">draw</span><span class=\"p\">,</span> <span class=\"n\">pick</span>\n<span class=\"kn\">from</span> <span class=\"nn\">._labels_utils</span> <span class=\"kn\">import</span> <span class=\"n\">indices_in_shape</span><span class=\"p\">,</span> <span class=\"n\">sphere_indices</span>\n\n<span class=\"n\">_REV_SHAPE_HELP</span> <span class=\"o\">=</span> <span class=\"p\">{</span>\n    <span class=\"n\">trans</span><span class=\"o\">.</span><span class=\"n\">_</span><span class=\"p\">(</span><span class=\"s1\">'enter paint or fill mode to edit labels'</span><span class=\"p\">):</span> <span class=\"p\">{</span><span class=\"n\">Mode</span><span class=\"o\">.</span><span class=\"n\">PAN_ZOOM</span><span class=\"p\">},</span>\n    <span class=\"n\">trans</span><span class=\"o\">.</span><span class=\"n\">_</span><span class=\"p\">(</span><span class=\"s1\">'hold &lt;space&gt; to pan/zoom, click to pick a label'</span><span class=\"p\">):</span> <span class=\"p\">{</span>\n        <span class=\"n\">Mode</span><span class=\"o\">.</span><span class=\"n\">PICK</span><span class=\"p\">,</span>\n        <span class=\"n\">Mode</span><span class=\"o\">.</span><span class=\"n\">FILL</span><span class=\"p\">,</span>\n    <span class=\"p\">},</span>\n    <span class=\"n\">trans</span><span class=\"o\">.</span><span class=\"n\">_</span><span class=\"p\">(</span>\n        <span class=\"s1\">'hold &lt;space&gt; to pan/zoom, hold &lt;shift&gt; to toggle preserve_labels, hold &lt;control&gt; to fill, hold &lt;alt&gt; to erase, drag to paint a label'</span>\n    <span class=\"p\">):</span> <span class=\"p\">{</span><span class=\"n\">Mode</span><span class=\"o\">.</span><span class=\"n\">PAINT</span><span class=\"p\">},</span>\n    <span class=\"n\">trans</span><span class=\"o\">.</span><span class=\"n\">_</span><span class=\"p\">(</span><span class=\"s1\">'hold &lt;space&gt; to pan/zoom, drag to erase a label'</span><span class=\"p\">):</span> <span class=\"p\">{</span><span class=\"n\">Mode</span><span class=\"o\">.</span><span class=\"n\">ERASE</span><span class=\"p\">},</span>\n<span class=\"p\">}</span>\n\n<span class=\"c1\"># This avoid duplicating the trans._ help messages above</span>\n<span class=\"c1\"># as some modes have the same help.</span>\n<span class=\"c1\"># while most tooling will recognise identical messages,</span>\n<span class=\"c1\"># this can lead to human error.</span>\n<span class=\"n\">_FWD_SHAPE_HELP</span> <span class=\"o\">=</span> <span class=\"p\">{}</span>\n<span class=\"k\">for</span> <span class=\"n\">t</span><span class=\"p\">,</span> <span class=\"n\">modes</span> <span class=\"ow\">in</span> <span class=\"n\">_REV_SHAPE_HELP</span><span class=\"o\">.</span><span class=\"n\">items</span><span class=\"p\">():</span>\n    <span class=\"k\">for</span> <span class=\"n\">m</span> <span class=\"ow\">in</span> <span class=\"n\">modes</span><span class=\"p\">:</span>\n        <span class=\"n\">_FWD_SHAPE_HELP</span><span class=\"p\">[</span><span class=\"n\">m</span><span class=\"p\">]</span> <span class=\"o\">=</span> <span class=\"n\">t</span>\n\n\n<span class=\"k\">class</span> <span class=\"nc\">Labels</span><span class=\"p\">(</span><span class=\"n\">_ImageBase</span><span class=\"p\">):</span>\n    <span class=\"sd\">\"\"\"Labels (or segmentation) layer.</span>\n\n<span class=\"sd\">    An image-like layer where every pixel contains an integer ID</span>\n<span class=\"sd\">    corresponding to the region it belongs to.</span>\n\n<span class=\"sd\">    Parameters</span>\n<span class=\"sd\">    ----------</span>\n<span class=\"sd\">    data : array or list of array</span>\n<span class=\"sd\">        Labels data as an array or multiscale. Must be integer type or bools.</span>\n<span class=\"sd\">        Please note multiscale rendering is only supported in 2D. In 3D, only</span>\n<span class=\"sd\">        the lowest resolution scale is displayed.</span>\n<span class=\"sd\">    num_colors : int</span>\n<span class=\"sd\">        Number of unique colors to use in colormap.</span>\n<span class=\"sd\">    properties : dict {str: array (N,)} or DataFrame</span>\n<span class=\"sd\">        Properties for each label. Each property should be an array of length</span>\n<span class=\"sd\">        N, where N is the number of labels, and the first property corresponds</span>\n<span class=\"sd\">        to background.</span>\n<span class=\"sd\">    color : dict of int to str or array</span>\n<span class=\"sd\">        Custom label to color mapping. Values must be valid color names or RGBA</span>\n<span class=\"sd\">        arrays.</span>\n<span class=\"sd\">    seed : float</span>\n<span class=\"sd\">        Seed for colormap random generator.</span>\n<span class=\"sd\">    name : str</span>\n<span class=\"sd\">        Name of the layer.</span>\n<span class=\"sd\">    metadata : dict</span>\n<span class=\"sd\">        Layer metadata.</span>\n<span class=\"sd\">    scale : tuple of float</span>\n<span class=\"sd\">        Scale factors for the layer.</span>\n<span class=\"sd\">    translate : tuple of float</span>\n<span class=\"sd\">        Translation values for the layer.</span>\n<span class=\"sd\">    rotate : float, 3-tuple of float, or n-D array.</span>\n<span class=\"sd\">        If a float convert into a 2D rotation matrix using that value as an</span>\n<span class=\"sd\">        angle. If 3-tuple convert into a 3D rotation matrix, using a yaw,</span>\n<span class=\"sd\">        pitch, roll convention. Otherwise assume an nD rotation. Angles are</span>\n<span class=\"sd\">        assumed to be in degrees. They can be converted from radians with</span>\n<span class=\"sd\">        np.degrees if needed.</span>\n<span class=\"sd\">    shear : 1-D array or n-D array</span>\n<span class=\"sd\">        Either a vector of upper triangular values, or an nD shear matrix with</span>\n<span class=\"sd\">        ones along the main diagonal.</span>\n<span class=\"sd\">    affine : n-D array or napari.utils.transforms.Affine</span>\n<span class=\"sd\">        (N+1, N+1) affine transformation matrix in homogeneous coordinates.</span>\n<span class=\"sd\">        The first (N, N) entries correspond to a linear transform and</span>\n<span class=\"sd\">        the final column is a length N translation vector and a 1 or a napari</span>\n<span class=\"sd\">        `Affine` transform object. Applied as an extra transform on top of the</span>\n<span class=\"sd\">        provided scale, rotate, and shear values.</span>\n<span class=\"sd\">    opacity : float</span>\n<span class=\"sd\">        Opacity of the layer visual, between 0.0 and 1.0.</span>\n<span class=\"sd\">    blending : str</span>\n<span class=\"sd\">        One of a list of preset blending modes that determines how RGB and</span>\n<span class=\"sd\">        alpha values of the layer visual get mixed. Allowed values are</span>\n<span class=\"sd\">        {'opaque', 'translucent', and 'additive'}.</span>\n<span class=\"sd\">    rendering : str</span>\n<span class=\"sd\">        3D Rendering mode used by vispy. Must be one {'translucent', 'iso_categorical'}.</span>\n<span class=\"sd\">        'translucent' renders without lighting. 'iso_categorical' uses isosurface</span>\n<span class=\"sd\">        rendering to calculate lighting effects on labeled surfaces.</span>\n<span class=\"sd\">        The default value is 'iso_categorical'.</span>\n<span class=\"sd\">    visible : bool</span>\n<span class=\"sd\">        Whether the layer visual is currently being displayed.</span>\n<span class=\"sd\">    multiscale : bool</span>\n<span class=\"sd\">        Whether the data is a multiscale image or not. Multiscale data is</span>\n<span class=\"sd\">        represented by a list of array like image data. If not specified by</span>\n<span class=\"sd\">        the user and if the data is a list of arrays that decrease in shape</span>\n<span class=\"sd\">        then it will be taken to be multiscale. The first image in the list</span>\n<span class=\"sd\">        should be the largest. Please note multiscale rendering is only</span>\n<span class=\"sd\">        supported in 2D. In 3D, only the lowest resolution scale is</span>\n<span class=\"sd\">        displayed.</span>\n<span class=\"sd\">    cache : bool</span>\n<span class=\"sd\">        Whether slices of out-of-core datasets should be cached upon retrieval.</span>\n<span class=\"sd\">        Currently, this only applies to dask arrays.</span>\n<span class=\"sd\">    experimental_slicing_plane : dict or SlicingPlane</span>\n<span class=\"sd\">        Properties defining plane rendering in 3D. Properties are defined in</span>\n<span class=\"sd\">        data coordinates. Valid dictionary keys are</span>\n<span class=\"sd\">        {'position', 'normal', 'thickness', and 'enabled'}.</span>\n<span class=\"sd\">    experimental_clipping_planes : list of dicts, list of ClippingPlane, or ClippingPlaneList</span>\n<span class=\"sd\">        Each dict defines a clipping plane in 3D in data coordinates.</span>\n<span class=\"sd\">        Valid dictionary keys are {'position', 'normal', and 'enabled'}.</span>\n<span class=\"sd\">        Values on the negative side of the normal are discarded if the plane is enabled.</span>\n\n<span class=\"sd\">    Attributes</span>\n<span class=\"sd\">    ----------</span>\n<span class=\"sd\">    data : array or list of array</span>\n<span class=\"sd\">        Integer label data as an array or multiscale. Can be N dimensional.</span>\n<span class=\"sd\">        Every pixel contains an integer ID corresponding to the region it</span>\n<span class=\"sd\">        belongs to. The label 0 is rendered as transparent. Please note</span>\n<span class=\"sd\">        multiscale rendering is only supported in 2D. In 3D, only</span>\n<span class=\"sd\">        the lowest resolution scale is displayed.</span>\n<span class=\"sd\">    multiscale : bool</span>\n<span class=\"sd\">        Whether the data is a multiscale image or not. Multiscale data is</span>\n<span class=\"sd\">        represented by a list of array like image data. The first image in the</span>\n<span class=\"sd\">        list should be the largest. Please note multiscale rendering is only</span>\n<span class=\"sd\">        supported in 2D. In 3D, only the lowest resolution scale is</span>\n<span class=\"sd\">        displayed.</span>\n<span class=\"sd\">    metadata : dict</span>\n<span class=\"sd\">        Labels metadata.</span>\n<span class=\"sd\">    num_colors : int</span>\n<span class=\"sd\">        Number of unique colors to use in colormap.</span>\n<span class=\"sd\">    properties : dict {str: array (N,)}, DataFrame</span>\n<span class=\"sd\">        Properties for each label. Each property should be an array of length</span>\n<span class=\"sd\">        N, where N is the number of labels, and the first property corresponds</span>\n<span class=\"sd\">        to background.</span>\n<span class=\"sd\">    color : dict of int to str or array</span>\n<span class=\"sd\">        Custom label to color mapping. Values must be valid color names or RGBA</span>\n<span class=\"sd\">        arrays.</span>\n<span class=\"sd\">    seed : float</span>\n<span class=\"sd\">        Seed for colormap random generator.</span>\n<span class=\"sd\">    opacity : float</span>\n<span class=\"sd\">        Opacity of the labels, must be between 0 and 1.</span>\n<span class=\"sd\">    contiguous : bool</span>\n<span class=\"sd\">        If `True`, the fill bucket changes only connected pixels of same label.</span>\n<span class=\"sd\">    n_edit_dimensions : int</span>\n<span class=\"sd\">        The number of dimensions across which labels will be edited.</span>\n<span class=\"sd\">    contour : int</span>\n<span class=\"sd\">        If greater than 0, displays contours of labels instead of shaded regions</span>\n<span class=\"sd\">        with a thickness equal to its value.</span>\n<span class=\"sd\">    brush_size : float</span>\n<span class=\"sd\">        Size of the paint brush in data coordinates.</span>\n<span class=\"sd\">    selected_label : int</span>\n<span class=\"sd\">        Index of selected label. Can be greater than the current maximum label.</span>\n<span class=\"sd\">    mode : str</span>\n<span class=\"sd\">        Interactive mode. The normal, default mode is PAN_ZOOM, which</span>\n<span class=\"sd\">        allows for normal interactivity with the canvas.</span>\n\n<span class=\"sd\">        In PICK mode the cursor functions like a color picker, setting the</span>\n<span class=\"sd\">        clicked on label to be the current label. If the background is picked it</span>\n<span class=\"sd\">        will select the background label `0`.</span>\n\n<span class=\"sd\">        In PAINT mode the cursor functions like a paint brush changing any</span>\n<span class=\"sd\">        pixels it brushes over to the current label. If the background label</span>\n<span class=\"sd\">        `0` is selected than any pixels will be changed to background and this</span>\n<span class=\"sd\">        tool functions like an eraser. The size and shape of the cursor can be</span>\n<span class=\"sd\">        adjusted in the properties widget.</span>\n\n<span class=\"sd\">        In FILL mode the cursor functions like a fill bucket replacing pixels</span>\n<span class=\"sd\">        of the label clicked on with the current label. It can either replace</span>\n<span class=\"sd\">        all pixels of that label or just those that are contiguous with the</span>\n<span class=\"sd\">        clicked on pixel. If the background label `0` is selected than any</span>\n<span class=\"sd\">        pixels will be changed to background and this tool functions like an</span>\n<span class=\"sd\">        eraser.</span>\n\n<span class=\"sd\">        In ERASE mode the cursor functions similarly to PAINT mode, but to</span>\n<span class=\"sd\">        paint with background label, which effectively removes the label.</span>\n<span class=\"sd\">    experimental_slicing_plane : SlicingPlane</span>\n<span class=\"sd\">        Properties defining plane rendering in 3D.</span>\n<span class=\"sd\">    experimental_clipping_planes : ClippingPlaneList</span>\n<span class=\"sd\">        Clipping planes defined in data coordinates, used to clip the volume.</span>\n\n<span class=\"sd\">    Notes</span>\n<span class=\"sd\">    -----</span>\n<span class=\"sd\">    _data_raw : array (N, M)</span>\n<span class=\"sd\">        2D labels data for the currently viewed slice.</span>\n<span class=\"sd\">    _selected_color : 4-tuple or None</span>\n<span class=\"sd\">        RGBA tuple of the color of the selected label, or None if the</span>\n<span class=\"sd\">        background label `0` is selected.</span>\n<span class=\"sd\">    \"\"\"</span>\n\n    <span class=\"n\">_history_limit</span> <span class=\"o\">=</span> <span class=\"mi\">100</span>\n\n    <span class=\"k\">def</span> <span class=\"fm\">__init__</span><span class=\"p\">(</span>\n        <span class=\"bp\">self</span><span class=\"p\">,</span>\n        <span class=\"n\">data</span><span class=\"p\">,</span>\n        <span class=\"o\">*</span><span class=\"p\">,</span>\n        <span class=\"n\">num_colors</span><span class=\"o\">=</span><span class=\"mi\">50</span><span class=\"p\">,</span>\n        <span class=\"n\">properties</span><span class=\"o\">=</span><span class=\"kc\">None</span><span class=\"p\">,</span>\n        <span class=\"n\">color</span><span class=\"o\">=</span><span class=\"kc\">None</span><span class=\"p\">,</span>\n        <span class=\"n\">seed</span><span class=\"o\">=</span><span class=\"mf\">0.5</span><span class=\"p\">,</span>\n        <span class=\"n\">name</span><span class=\"o\">=</span><span class=\"kc\">None</span><span class=\"p\">,</span>\n        <span class=\"n\">metadata</span><span class=\"o\">=</span><span class=\"kc\">None</span><span class=\"p\">,</span>\n        <span class=\"n\">scale</span><span class=\"o\">=</span><span class=\"kc\">None</span><span class=\"p\">,</span>\n        <span class=\"n\">translate</span><span class=\"o\">=</span><span class=\"kc\">None</span><span class=\"p\">,</span>\n        <span class=\"n\">rotate</span><span class=\"o\">=</span><span class=\"kc\">None</span><span class=\"p\">,</span>\n        <span class=\"n\">shear</span><span class=\"o\">=</span><span class=\"kc\">None</span><span class=\"p\">,</span>\n        <span class=\"n\">affine</span><span class=\"o\">=</span><span class=\"kc\">None</span><span class=\"p\">,</span>\n        <span class=\"n\">opacity</span><span class=\"o\">=</span><span class=\"mf\">0.7</span><span class=\"p\">,</span>\n        <span class=\"n\">blending</span><span class=\"o\">=</span><span class=\"s1\">'translucent'</span><span class=\"p\">,</span>\n        <span class=\"n\">rendering</span><span class=\"o\">=</span><span class=\"s1\">'iso_categorical'</span><span class=\"p\">,</span>\n        <span class=\"n\">visible</span><span class=\"o\">=</span><span class=\"kc\">True</span><span class=\"p\">,</span>\n        <span class=\"n\">multiscale</span><span class=\"o\">=</span><span class=\"kc\">None</span><span class=\"p\">,</span>\n        <span class=\"n\">cache</span><span class=\"o\">=</span><span class=\"kc\">True</span><span class=\"p\">,</span>\n        <span class=\"n\">experimental_slicing_plane</span><span class=\"o\">=</span><span class=\"kc\">None</span><span class=\"p\">,</span>\n        <span class=\"n\">experimental_clipping_planes</span><span class=\"o\">=</span><span class=\"kc\">None</span><span class=\"p\">,</span>\n    <span class=\"p\">):</span>\n\n        <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_seed</span> <span class=\"o\">=</span> <span class=\"n\">seed</span>\n        <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_background_label</span> <span class=\"o\">=</span> <span class=\"mi\">0</span>\n        <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_num_colors</span> <span class=\"o\">=</span> <span class=\"n\">num_colors</span>\n        <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_random_colormap</span> <span class=\"o\">=</span> <span class=\"n\">label_colormap</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">num_colors</span><span class=\"p\">)</span>\n        <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_all_vals</span> <span class=\"o\">=</span> <span class=\"n\">low_discrepancy_image</span><span class=\"p\">(</span>\n            <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">arange</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">num_colors</span><span class=\"p\">),</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_seed</span>\n        <span class=\"p\">)</span>\n        <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_all_vals</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span> <span class=\"o\">=</span> <span class=\"mi\">0</span>\n        <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_color_mode</span> <span class=\"o\">=</span> <span class=\"n\">LabelColorMode</span><span class=\"o\">.</span><span class=\"n\">AUTO</span>\n        <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_show_selected_label</span> <span class=\"o\">=</span> <span class=\"kc\">False</span>\n        <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_contour</span> <span class=\"o\">=</span> <span class=\"mi\">0</span>\n\n        <span class=\"n\">data</span> <span class=\"o\">=</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_ensure_int_labels</span><span class=\"p\">(</span><span class=\"n\">data</span><span class=\"p\">)</span>\n        <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_color_lookup_func</span> <span class=\"o\">=</span> <span class=\"kc\">None</span>\n\n        <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_properties</span><span class=\"p\">,</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_label_index</span> <span class=\"o\">=</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_prepare_properties</span><span class=\"p\">(</span>\n            <span class=\"n\">properties</span>\n        <span class=\"p\">)</span>\n\n        <span class=\"nb\">super</span><span class=\"p\">()</span><span class=\"o\">.</span><span class=\"fm\">__init__</span><span class=\"p\">(</span>\n            <span class=\"n\">data</span><span class=\"p\">,</span>\n            <span class=\"n\">rgb</span><span class=\"o\">=</span><span class=\"kc\">False</span><span class=\"p\">,</span>\n            <span class=\"n\">colormap</span><span class=\"o\">=</span><span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_random_colormap</span><span class=\"p\">,</span>\n            <span class=\"n\">contrast_limits</span><span class=\"o\">=</span><span class=\"p\">[</span><span class=\"mf\">0.0</span><span class=\"p\">,</span> <span class=\"mf\">1.0</span><span class=\"p\">],</span>\n            <span class=\"n\">interpolation</span><span class=\"o\">=</span><span class=\"s1\">'nearest'</span><span class=\"p\">,</span>\n            <span class=\"n\">rendering</span><span class=\"o\">=</span><span class=\"n\">rendering</span><span class=\"p\">,</span>\n            <span class=\"n\">iso_threshold</span><span class=\"o\">=</span><span class=\"mi\">0</span><span class=\"p\">,</span>\n            <span class=\"n\">name</span><span class=\"o\">=</span><span class=\"n\">name</span><span class=\"p\">,</span>\n            <span class=\"n\">metadata</span><span class=\"o\">=</span><span class=\"n\">metadata</span><span class=\"p\">,</span>\n            <span class=\"n\">scale</span><span class=\"o\">=</span><span class=\"n\">scale</span><span class=\"p\">,</span>\n            <span class=\"n\">translate</span><span class=\"o\">=</span><span class=\"n\">translate</span><span class=\"p\">,</span>\n            <span class=\"n\">rotate</span><span class=\"o\">=</span><span class=\"n\">rotate</span><span class=\"p\">,</span>\n            <span class=\"n\">shear</span><span class=\"o\">=</span><span class=\"n\">shear</span><span class=\"p\">,</span>\n            <span class=\"n\">affine</span><span class=\"o\">=</span><span class=\"n\">affine</span><span class=\"p\">,</span>\n            <span class=\"n\">opacity</span><span class=\"o\">=</span><span class=\"n\">opacity</span><span class=\"p\">,</span>\n            <span class=\"n\">blending</span><span class=\"o\">=</span><span class=\"n\">blending</span><span class=\"p\">,</span>\n            <span class=\"n\">visible</span><span class=\"o\">=</span><span class=\"n\">visible</span><span class=\"p\">,</span>\n            <span class=\"n\">multiscale</span><span class=\"o\">=</span><span class=\"n\">multiscale</span><span class=\"p\">,</span>\n            <span class=\"n\">cache</span><span class=\"o\">=</span><span class=\"n\">cache</span><span class=\"p\">,</span>\n            <span class=\"n\">experimental_slicing_plane</span><span class=\"o\">=</span><span class=\"n\">experimental_slicing_plane</span><span class=\"p\">,</span>\n            <span class=\"n\">experimental_clipping_planes</span><span class=\"o\">=</span><span class=\"n\">experimental_clipping_planes</span><span class=\"p\">,</span>\n        <span class=\"p\">)</span>\n\n        <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">events</span><span class=\"o\">.</span><span class=\"n\">add</span><span class=\"p\">(</span>\n            <span class=\"n\">mode</span><span class=\"o\">=</span><span class=\"n\">Event</span><span class=\"p\">,</span>\n            <span class=\"n\">preserve_labels</span><span class=\"o\">=</span><span class=\"n\">Event</span><span class=\"p\">,</span>\n            <span class=\"n\">properties</span><span class=\"o\">=</span><span class=\"n\">Event</span><span class=\"p\">,</span>\n            <span class=\"n\">n_edit_dimensions</span><span class=\"o\">=</span><span class=\"n\">Event</span><span class=\"p\">,</span>\n            <span class=\"n\">contiguous</span><span class=\"o\">=</span><span class=\"n\">Event</span><span class=\"p\">,</span>\n            <span class=\"n\">brush_size</span><span class=\"o\">=</span><span class=\"n\">Event</span><span class=\"p\">,</span>\n            <span class=\"n\">selected_label</span><span class=\"o\">=</span><span class=\"n\">Event</span><span class=\"p\">,</span>\n            <span class=\"n\">color_mode</span><span class=\"o\">=</span><span class=\"n\">Event</span><span class=\"p\">,</span>\n            <span class=\"n\">brush_shape</span><span class=\"o\">=</span><span class=\"n\">Event</span><span class=\"p\">,</span>\n            <span class=\"n\">contour</span><span class=\"o\">=</span><span class=\"n\">Event</span><span class=\"p\">,</span>\n        <span class=\"p\">)</span>\n\n        <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_n_edit_dimensions</span> <span class=\"o\">=</span> <span class=\"mi\">2</span>\n        <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_contiguous</span> <span class=\"o\">=</span> <span class=\"kc\">True</span>\n        <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_brush_size</span> <span class=\"o\">=</span> <span class=\"mi\">10</span>\n\n        <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_selected_label</span> <span class=\"o\">=</span> <span class=\"mi\">1</span>\n        <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_selected_color</span> <span class=\"o\">=</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">get_color</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_selected_label</span><span class=\"p\">)</span>\n        <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">color</span> <span class=\"o\">=</span> <span class=\"n\">color</span>\n\n        <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_mode</span> <span class=\"o\">=</span> <span class=\"n\">Mode</span><span class=\"o\">.</span><span class=\"n\">PAN_ZOOM</span>\n        <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_status</span> <span class=\"o\">=</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">mode</span>\n        <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_preserve_labels</span> <span class=\"o\">=</span> <span class=\"kc\">False</span>\n        <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_help</span> <span class=\"o\">=</span> <span class=\"n\">trans</span><span class=\"o\">.</span><span class=\"n\">_</span><span class=\"p\">(</span><span class=\"s1\">'enter paint or fill mode to edit labels'</span><span class=\"p\">)</span>\n\n        <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_block_saving</span> <span class=\"o\">=</span> <span class=\"kc\">False</span>\n        <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_reset_history</span><span class=\"p\">()</span>\n\n        <span class=\"c1\"># Trigger generation of view slice and thumbnail</span>\n        <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_update_dims</span><span class=\"p\">()</span>\n        <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_set_editable</span><span class=\"p\">()</span>\n\n    <span class=\"nd\">@property</span>\n    <span class=\"k\">def</span> <span class=\"nf\">contiguous</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">):</span>\n        <span class=\"sd\">\"\"\"bool: fill bucket changes only connected pixels of same label.\"\"\"</span>\n        <span class=\"k\">return</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_contiguous</span>\n\n    <span class=\"nd\">@contiguous</span><span class=\"o\">.</span><span class=\"n\">setter</span>\n    <span class=\"k\">def</span> <span class=\"nf\">contiguous</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">,</span> <span class=\"n\">contiguous</span><span class=\"p\">):</span>\n        <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_contiguous</span> <span class=\"o\">=</span> <span class=\"n\">contiguous</span>\n        <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">events</span><span class=\"o\">.</span><span class=\"n\">contiguous</span><span class=\"p\">()</span>\n\n    <span class=\"nd\">@property</span>\n    <span class=\"k\">def</span> <span class=\"nf\">n_edit_dimensions</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">):</span>\n        <span class=\"k\">return</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_n_edit_dimensions</span>\n\n    <span class=\"nd\">@n_edit_dimensions</span><span class=\"o\">.</span><span class=\"n\">setter</span>\n    <span class=\"k\">def</span> <span class=\"nf\">n_edit_dimensions</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">,</span> <span class=\"n\">n_edit_dimensions</span><span class=\"p\">):</span>\n        <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_n_edit_dimensions</span> <span class=\"o\">=</span> <span class=\"n\">n_edit_dimensions</span>\n        <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">events</span><span class=\"o\">.</span><span class=\"n\">n_edit_dimensions</span><span class=\"p\">()</span>\n\n    <span class=\"nd\">@property</span>\n    <span class=\"k\">def</span> <span class=\"nf\">contour</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">):</span>\n        <span class=\"sd\">\"\"\"int: displays contours of labels instead of shaded regions.\"\"\"</span>\n        <span class=\"k\">return</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_contour</span>\n\n    <span class=\"nd\">@contour</span><span class=\"o\">.</span><span class=\"n\">setter</span>\n    <span class=\"k\">def</span> <span class=\"nf\">contour</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">,</span> <span class=\"n\">contour</span><span class=\"p\">):</span>\n        <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_contour</span> <span class=\"o\">=</span> <span class=\"n\">contour</span>\n        <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">events</span><span class=\"o\">.</span><span class=\"n\">contour</span><span class=\"p\">()</span>\n        <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">refresh</span><span class=\"p\">()</span>\n\n    <span class=\"nd\">@property</span>\n    <span class=\"k\">def</span> <span class=\"nf\">brush_size</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">):</span>\n        <span class=\"sd\">\"\"\"float: Size of the paint in world coordinates.\"\"\"</span>\n        <span class=\"k\">return</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_brush_size</span>\n\n    <span class=\"nd\">@brush_size</span><span class=\"o\">.</span><span class=\"n\">setter</span>\n    <span class=\"k\">def</span> <span class=\"nf\">brush_size</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">,</span> <span class=\"n\">brush_size</span><span class=\"p\">):</span>\n        <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_brush_size</span> <span class=\"o\">=</span> <span class=\"nb\">int</span><span class=\"p\">(</span><span class=\"n\">brush_size</span><span class=\"p\">)</span>\n        <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">cursor_size</span> <span class=\"o\">=</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_calculate_cursor_size</span><span class=\"p\">()</span>\n        <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">events</span><span class=\"o\">.</span><span class=\"n\">brush_size</span><span class=\"p\">()</span>\n\n    <span class=\"k\">def</span> <span class=\"nf\">_calculate_cursor_size</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">):</span>\n        <span class=\"c1\"># Convert from brush size in data coordinates to</span>\n        <span class=\"c1\"># cursor size in world coordinates</span>\n        <span class=\"n\">scale</span> <span class=\"o\">=</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_data_to_world</span><span class=\"o\">.</span><span class=\"n\">scale</span>\n        <span class=\"n\">min_scale</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">min</span><span class=\"p\">([</span><span class=\"nb\">abs</span><span class=\"p\">(</span><span class=\"n\">scale</span><span class=\"p\">[</span><span class=\"n\">d</span><span class=\"p\">])</span> <span class=\"k\">for</span> <span class=\"n\">d</span> <span class=\"ow\">in</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_dims_displayed</span><span class=\"p\">])</span>\n        <span class=\"k\">return</span> <span class=\"nb\">abs</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">brush_size</span> <span class=\"o\">*</span> <span class=\"n\">min_scale</span><span class=\"p\">)</span>\n\n    <span class=\"nd\">@property</span>\n    <span class=\"k\">def</span> <span class=\"nf\">seed</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">):</span>\n        <span class=\"sd\">\"\"\"float: Seed for colormap random generator.\"\"\"</span>\n        <span class=\"k\">return</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_seed</span>\n\n    <span class=\"nd\">@seed</span><span class=\"o\">.</span><span class=\"n\">setter</span>\n    <span class=\"k\">def</span> <span class=\"nf\">seed</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">,</span> <span class=\"n\">seed</span><span class=\"p\">):</span>\n        <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_seed</span> <span class=\"o\">=</span> <span class=\"n\">seed</span>\n        <span class=\"c1\"># invalidate _all_vals to trigger re-generation</span>\n        <span class=\"c1\"># in _raw_to_displayed</span>\n        <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_all_vals</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">array</span><span class=\"p\">([])</span>\n        <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_selected_color</span> <span class=\"o\">=</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">get_color</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">selected_label</span><span class=\"p\">)</span>\n        <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">refresh</span><span class=\"p\">()</span>\n        <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">events</span><span class=\"o\">.</span><span class=\"n\">selected_label</span><span class=\"p\">()</span>\n\n    <span class=\"nd\">@property</span>\n    <span class=\"k\">def</span> <span class=\"nf\">num_colors</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">):</span>\n        <span class=\"sd\">\"\"\"int: Number of unique colors to use in colormap.\"\"\"</span>\n        <span class=\"k\">return</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_num_colors</span>\n\n    <span class=\"nd\">@num_colors</span><span class=\"o\">.</span><span class=\"n\">setter</span>\n    <span class=\"k\">def</span> <span class=\"nf\">num_colors</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">,</span> <span class=\"n\">num_colors</span><span class=\"p\">):</span>\n        <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_num_colors</span> <span class=\"o\">=</span> <span class=\"n\">num_colors</span>\n        <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">colormap</span> <span class=\"o\">=</span> <span class=\"n\">label_colormap</span><span class=\"p\">(</span><span class=\"n\">num_colors</span><span class=\"p\">)</span>\n        <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">refresh</span><span class=\"p\">()</span>\n        <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_selected_color</span> <span class=\"o\">=</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">get_color</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">selected_label</span><span class=\"p\">)</span>\n        <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">events</span><span class=\"o\">.</span><span class=\"n\">selected_label</span><span class=\"p\">()</span>\n\n    <span class=\"nd\">@property</span>\n    <span class=\"k\">def</span> <span class=\"nf\">data</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">):</span>\n        <span class=\"sd\">\"\"\"array: Image data.\"\"\"</span>\n        <span class=\"k\">return</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_data</span>\n\n    <span class=\"nd\">@data</span><span class=\"o\">.</span><span class=\"n\">setter</span>\n    <span class=\"k\">def</span> <span class=\"nf\">data</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">,</span> <span class=\"n\">data</span><span class=\"p\">):</span>\n        <span class=\"n\">data</span> <span class=\"o\">=</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_ensure_int_labels</span><span class=\"p\">(</span><span class=\"n\">data</span><span class=\"p\">)</span>\n        <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_data</span> <span class=\"o\">=</span> <span class=\"n\">data</span>\n        <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_update_dims</span><span class=\"p\">()</span>\n        <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">events</span><span class=\"o\">.</span><span class=\"n\">data</span><span class=\"p\">(</span><span class=\"n\">value</span><span class=\"o\">=</span><span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">data</span><span class=\"p\">)</span>\n        <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_set_editable</span><span class=\"p\">()</span>\n\n    <span class=\"nd\">@property</span>\n    <span class=\"k\">def</span> <span class=\"nf\">properties</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">)</span> <span class=\"o\">-&gt;</span> <span class=\"n\">Dict</span><span class=\"p\">[</span><span class=\"nb\">str</span><span class=\"p\">,</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">ndarray</span><span class=\"p\">]:</span>\n        <span class=\"sd\">\"\"\"dict {str: array (N,)}, DataFrame: Properties for each label.\"\"\"</span>\n        <span class=\"k\">return</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_properties</span>\n\n    <span class=\"nd\">@properties</span><span class=\"o\">.</span><span class=\"n\">setter</span>\n    <span class=\"k\">def</span> <span class=\"nf\">properties</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">,</span> <span class=\"n\">properties</span><span class=\"p\">:</span> <span class=\"n\">Dict</span><span class=\"p\">[</span><span class=\"nb\">str</span><span class=\"p\">,</span> <span class=\"n\">Array</span><span class=\"p\">]):</span>\n        <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_properties</span><span class=\"p\">,</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_label_index</span> <span class=\"o\">=</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_prepare_properties</span><span class=\"p\">(</span>\n            <span class=\"n\">properties</span>\n        <span class=\"p\">)</span>\n        <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">events</span><span class=\"o\">.</span><span class=\"n\">properties</span><span class=\"p\">()</span>\n\n    <span class=\"nd\">@classmethod</span>\n    <span class=\"k\">def</span> <span class=\"nf\">_prepare_properties</span><span class=\"p\">(</span>\n        <span class=\"bp\">cls</span><span class=\"p\">,</span> <span class=\"n\">properties</span><span class=\"p\">:</span> <span class=\"n\">Optional</span><span class=\"p\">[</span><span class=\"n\">Dict</span><span class=\"p\">[</span><span class=\"nb\">str</span><span class=\"p\">,</span> <span class=\"n\">Array</span><span class=\"p\">]]</span>\n    <span class=\"p\">)</span> <span class=\"o\">-&gt;</span> <span class=\"n\">Tuple</span><span class=\"p\">[</span><span class=\"n\">Dict</span><span class=\"p\">[</span><span class=\"nb\">str</span><span class=\"p\">,</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">ndarray</span><span class=\"p\">],</span> <span class=\"n\">Dict</span><span class=\"p\">[</span><span class=\"nb\">int</span><span class=\"p\">,</span> <span class=\"nb\">int</span><span class=\"p\">]]:</span>\n        <span class=\"n\">properties</span> <span class=\"o\">=</span> <span class=\"n\">validate_properties</span><span class=\"p\">(</span><span class=\"n\">properties</span><span class=\"p\">)</span>\n        <span class=\"n\">label_index</span> <span class=\"o\">=</span> <span class=\"p\">{}</span>\n        <span class=\"k\">if</span> <span class=\"s1\">'index'</span> <span class=\"ow\">in</span> <span class=\"n\">properties</span><span class=\"p\">:</span>\n            <span class=\"n\">label_index</span> <span class=\"o\">=</span> <span class=\"p\">{</span><span class=\"n\">i</span><span class=\"p\">:</span> <span class=\"n\">k</span> <span class=\"k\">for</span> <span class=\"n\">k</span><span class=\"p\">,</span> <span class=\"n\">i</span> <span class=\"ow\">in</span> <span class=\"nb\">enumerate</span><span class=\"p\">(</span><span class=\"n\">properties</span><span class=\"p\">[</span><span class=\"s1\">'index'</span><span class=\"p\">])}</span>\n        <span class=\"k\">elif</span> <span class=\"nb\">len</span><span class=\"p\">(</span><span class=\"n\">properties</span><span class=\"p\">)</span> <span class=\"o\">&gt;</span> <span class=\"mi\">0</span><span class=\"p\">:</span>\n            <span class=\"n\">max_len</span> <span class=\"o\">=</span> <span class=\"nb\">max</span><span class=\"p\">(</span><span class=\"nb\">len</span><span class=\"p\">(</span><span class=\"n\">x</span><span class=\"p\">)</span> <span class=\"k\">for</span> <span class=\"n\">x</span> <span class=\"ow\">in</span> <span class=\"n\">properties</span><span class=\"o\">.</span><span class=\"n\">values</span><span class=\"p\">())</span>\n            <span class=\"n\">label_index</span> <span class=\"o\">=</span> <span class=\"p\">{</span><span class=\"n\">i</span><span class=\"p\">:</span> <span class=\"n\">i</span> <span class=\"k\">for</span> <span class=\"n\">i</span> <span class=\"ow\">in</span> <span class=\"nb\">range</span><span class=\"p\">(</span><span class=\"n\">max_len</span><span class=\"p\">)}</span>\n        <span class=\"k\">return</span> <span class=\"n\">properties</span><span class=\"p\">,</span> <span class=\"n\">label_index</span>\n\n    <span class=\"nd\">@property</span>\n    <span class=\"k\">def</span> <span class=\"nf\">color</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">):</span>\n        <span class=\"sd\">\"\"\"dict: custom color dict for label coloring\"\"\"</span>\n        <span class=\"k\">return</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_color</span>\n\n    <span class=\"nd\">@color</span><span class=\"o\">.</span><span class=\"n\">setter</span>\n    <span class=\"k\">def</span> <span class=\"nf\">color</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">,</span> <span class=\"n\">color</span><span class=\"p\">):</span>\n        <span class=\"k\">if</span> <span class=\"ow\">not</span> <span class=\"n\">color</span><span class=\"p\">:</span>\n            <span class=\"n\">color</span> <span class=\"o\">=</span> <span class=\"p\">{}</span>\n\n        <span class=\"k\">if</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_background_label</span> <span class=\"ow\">not</span> <span class=\"ow\">in</span> <span class=\"n\">color</span><span class=\"p\">:</span>\n            <span class=\"n\">color</span><span class=\"p\">[</span><span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_background_label</span><span class=\"p\">]</span> <span class=\"o\">=</span> <span class=\"s1\">'transparent'</span>\n        <span class=\"k\">if</span> <span class=\"kc\">None</span> <span class=\"ow\">not</span> <span class=\"ow\">in</span> <span class=\"n\">color</span><span class=\"p\">:</span>\n            <span class=\"n\">color</span><span class=\"p\">[</span><span class=\"kc\">None</span><span class=\"p\">]</span> <span class=\"o\">=</span> <span class=\"s1\">'black'</span>\n\n        <span class=\"n\">colors</span> <span class=\"o\">=</span> <span class=\"p\">{</span>\n            <span class=\"n\">label</span><span class=\"p\">:</span> <span class=\"n\">transform_color</span><span class=\"p\">(</span><span class=\"n\">color_str</span><span class=\"p\">)[</span><span class=\"mi\">0</span><span class=\"p\">]</span>\n            <span class=\"k\">for</span> <span class=\"n\">label</span><span class=\"p\">,</span> <span class=\"n\">color_str</span> <span class=\"ow\">in</span> <span class=\"n\">color</span><span class=\"o\">.</span><span class=\"n\">items</span><span class=\"p\">()</span>\n        <span class=\"p\">}</span>\n        <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_color</span> <span class=\"o\">=</span> <span class=\"n\">colors</span>\n\n        <span class=\"c1\"># `colors` may contain just the default None and background label</span>\n        <span class=\"c1\"># colors, in which case we need to be in AUTO color mode. Otherwise,</span>\n        <span class=\"c1\"># `colors` contains colors for all labels, and we should be in DIRECT</span>\n        <span class=\"c1\"># mode.</span>\n\n        <span class=\"c1\"># For more information</span>\n        <span class=\"c1\"># - https://github.com/napari/napari/issues/2479</span>\n        <span class=\"c1\"># - https://github.com/napari/napari/issues/2953</span>\n        <span class=\"k\">if</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_is_default_colors</span><span class=\"p\">(</span><span class=\"n\">colors</span><span class=\"p\">):</span>\n            <span class=\"n\">color_mode</span> <span class=\"o\">=</span> <span class=\"n\">LabelColorMode</span><span class=\"o\">.</span><span class=\"n\">AUTO</span>\n        <span class=\"k\">else</span><span class=\"p\">:</span>\n            <span class=\"n\">color_mode</span> <span class=\"o\">=</span> <span class=\"n\">LabelColorMode</span><span class=\"o\">.</span><span class=\"n\">DIRECT</span>\n\n        <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">color_mode</span> <span class=\"o\">=</span> <span class=\"n\">color_mode</span>\n\n    <span class=\"k\">def</span> <span class=\"nf\">_is_default_colors</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">,</span> <span class=\"n\">color</span><span class=\"p\">):</span>\n        <span class=\"sd\">\"\"\"Returns True if color contains only default colors, otherwise False.</span>\n\n<span class=\"sd\">        Default colors are black for `None` and transparent for</span>\n<span class=\"sd\">        `self._background_label`.</span>\n\n<span class=\"sd\">        Parameters</span>\n<span class=\"sd\">        ----------</span>\n<span class=\"sd\">        color : Dict</span>\n<span class=\"sd\">            Dictionary of label value to color array</span>\n\n<span class=\"sd\">        Returns</span>\n<span class=\"sd\">        -------</span>\n<span class=\"sd\">        bool</span>\n<span class=\"sd\">            True if color contains only default colors, otherwise False.</span>\n<span class=\"sd\">        \"\"\"</span>\n        <span class=\"k\">if</span> <span class=\"nb\">len</span><span class=\"p\">(</span><span class=\"n\">color</span><span class=\"p\">)</span> <span class=\"o\">!=</span> <span class=\"mi\">2</span><span class=\"p\">:</span>\n            <span class=\"k\">return</span> <span class=\"kc\">False</span>\n\n        <span class=\"k\">if</span> <span class=\"ow\">not</span> <span class=\"nb\">hasattr</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">,</span> <span class=\"s1\">'_color'</span><span class=\"p\">):</span>\n            <span class=\"k\">return</span> <span class=\"kc\">False</span>\n\n        <span class=\"n\">default_keys</span> <span class=\"o\">=</span> <span class=\"p\">[</span><span class=\"kc\">None</span><span class=\"p\">,</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_background_label</span><span class=\"p\">]</span>\n        <span class=\"k\">if</span> <span class=\"nb\">set</span><span class=\"p\">(</span><span class=\"n\">default_keys</span><span class=\"p\">)</span> <span class=\"o\">!=</span> <span class=\"nb\">set</span><span class=\"p\">(</span><span class=\"n\">color</span><span class=\"o\">.</span><span class=\"n\">keys</span><span class=\"p\">()):</span>\n            <span class=\"k\">return</span> <span class=\"kc\">False</span>\n\n        <span class=\"k\">for</span> <span class=\"n\">key</span> <span class=\"ow\">in</span> <span class=\"n\">default_keys</span><span class=\"p\">:</span>\n            <span class=\"k\">if</span> <span class=\"ow\">not</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">allclose</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_color</span><span class=\"p\">[</span><span class=\"n\">key</span><span class=\"p\">],</span> <span class=\"n\">color</span><span class=\"p\">[</span><span class=\"n\">key</span><span class=\"p\">]):</span>\n                <span class=\"k\">return</span> <span class=\"kc\">False</span>\n\n        <span class=\"k\">return</span> <span class=\"kc\">True</span>\n\n    <span class=\"k\">def</span> <span class=\"nf\">_ensure_int_labels</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">,</span> <span class=\"n\">data</span><span class=\"p\">):</span>\n        <span class=\"sd\">\"\"\"Ensure data is integer by converting from bool if required, raising an error otherwise.\"\"\"</span>\n        <span class=\"n\">looks_multiscale</span><span class=\"p\">,</span> <span class=\"n\">data</span> <span class=\"o\">=</span> <span class=\"n\">guess_multiscale</span><span class=\"p\">(</span><span class=\"n\">data</span><span class=\"p\">)</span>\n        <span class=\"k\">if</span> <span class=\"ow\">not</span> <span class=\"n\">looks_multiscale</span><span class=\"p\">:</span>\n            <span class=\"n\">data</span> <span class=\"o\">=</span> <span class=\"p\">[</span><span class=\"n\">data</span><span class=\"p\">]</span>\n        <span class=\"n\">int_data</span> <span class=\"o\">=</span> <span class=\"p\">[]</span>\n        <span class=\"k\">for</span> <span class=\"n\">data_level</span> <span class=\"ow\">in</span> <span class=\"n\">data</span><span class=\"p\">:</span>\n            <span class=\"c1\"># normalize_dtype turns e.g. tensorstore or torch dtypes into</span>\n            <span class=\"c1\"># numpy dtypes</span>\n            <span class=\"k\">if</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">issubdtype</span><span class=\"p\">(</span><span class=\"n\">normalize_dtype</span><span class=\"p\">(</span><span class=\"n\">data_level</span><span class=\"o\">.</span><span class=\"n\">dtype</span><span class=\"p\">),</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">floating</span><span class=\"p\">):</span>\n                <span class=\"k\">raise</span> <span class=\"ne\">TypeError</span><span class=\"p\">(</span>\n                    <span class=\"n\">trans</span><span class=\"o\">.</span><span class=\"n\">_</span><span class=\"p\">(</span>\n                        <span class=\"s2\">\"Only integer types are supported for Labels layers, but data contains </span><span class=\"si\">{data_level_type}</span><span class=\"s2\">.\"</span><span class=\"p\">,</span>\n                        <span class=\"n\">data_level_type</span><span class=\"o\">=</span><span class=\"n\">data_level</span><span class=\"o\">.</span><span class=\"n\">dtype</span><span class=\"p\">,</span>\n                    <span class=\"p\">)</span>\n                <span class=\"p\">)</span>\n            <span class=\"k\">if</span> <span class=\"n\">data_level</span><span class=\"o\">.</span><span class=\"n\">dtype</span> <span class=\"o\">==</span> <span class=\"nb\">bool</span><span class=\"p\">:</span>\n                <span class=\"n\">int_data</span><span class=\"o\">.</span><span class=\"n\">append</span><span class=\"p\">(</span><span class=\"n\">data_level</span><span class=\"o\">.</span><span class=\"n\">astype</span><span class=\"p\">(</span><span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">int8</span><span class=\"p\">))</span>\n            <span class=\"k\">else</span><span class=\"p\">:</span>\n                <span class=\"n\">int_data</span><span class=\"o\">.</span><span class=\"n\">append</span><span class=\"p\">(</span><span class=\"n\">data_level</span><span class=\"p\">)</span>\n        <span class=\"n\">data</span> <span class=\"o\">=</span> <span class=\"n\">int_data</span>\n        <span class=\"k\">if</span> <span class=\"ow\">not</span> <span class=\"n\">looks_multiscale</span><span class=\"p\">:</span>\n            <span class=\"n\">data</span> <span class=\"o\">=</span> <span class=\"n\">data</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span>\n        <span class=\"k\">return</span> <span class=\"n\">data</span>\n\n    <span class=\"k\">def</span> <span class=\"nf\">_get_state</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">):</span>\n        <span class=\"sd\">\"\"\"Get dictionary of layer state.</span>\n\n<span class=\"sd\">        Returns</span>\n<span class=\"sd\">        -------</span>\n<span class=\"sd\">        state : dict</span>\n<span class=\"sd\">            Dictionary of layer state.</span>\n<span class=\"sd\">        \"\"\"</span>\n        <span class=\"n\">state</span> <span class=\"o\">=</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_get_base_state</span><span class=\"p\">()</span>\n        <span class=\"n\">state</span><span class=\"o\">.</span><span class=\"n\">update</span><span class=\"p\">(</span>\n            <span class=\"p\">{</span>\n                <span class=\"s1\">'multiscale'</span><span class=\"p\">:</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">multiscale</span><span class=\"p\">,</span>\n                <span class=\"s1\">'num_colors'</span><span class=\"p\">:</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">num_colors</span><span class=\"p\">,</span>\n                <span class=\"s1\">'properties'</span><span class=\"p\">:</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_properties</span><span class=\"p\">,</span>\n                <span class=\"s1\">'rendering'</span><span class=\"p\">:</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">rendering</span><span class=\"p\">,</span>\n                <span class=\"s1\">'experimental_slicing_plane'</span><span class=\"p\">:</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">experimental_slicing_plane</span><span class=\"o\">.</span><span class=\"n\">dict</span><span class=\"p\">(),</span>\n                <span class=\"s1\">'experimental_clipping_planes'</span><span class=\"p\">:</span> <span class=\"p\">[</span>\n                    <span class=\"n\">plane</span><span class=\"o\">.</span><span class=\"n\">dict</span><span class=\"p\">()</span> <span class=\"k\">for</span> <span class=\"n\">plane</span> <span class=\"ow\">in</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">experimental_clipping_planes</span>\n                <span class=\"p\">],</span>\n                <span class=\"s1\">'seed'</span><span class=\"p\">:</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">seed</span><span class=\"p\">,</span>\n                <span class=\"s1\">'data'</span><span class=\"p\">:</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">data</span><span class=\"p\">,</span>\n                <span class=\"s1\">'color'</span><span class=\"p\">:</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">color</span><span class=\"p\">,</span>\n            <span class=\"p\">}</span>\n        <span class=\"p\">)</span>\n        <span class=\"k\">return</span> <span class=\"n\">state</span>\n\n    <span class=\"nd\">@property</span>\n    <span class=\"k\">def</span> <span class=\"nf\">selected_label</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">):</span>\n        <span class=\"sd\">\"\"\"int: Index of selected label.\"\"\"</span>\n        <span class=\"k\">return</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_selected_label</span>\n\n    <span class=\"nd\">@selected_label</span><span class=\"o\">.</span><span class=\"n\">setter</span>\n    <span class=\"k\">def</span> <span class=\"nf\">selected_label</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">,</span> <span class=\"n\">selected_label</span><span class=\"p\">):</span>\n        <span class=\"k\">if</span> <span class=\"n\">selected_label</span> <span class=\"o\">&lt;</span> <span class=\"mi\">0</span><span class=\"p\">:</span>\n            <span class=\"k\">raise</span> <span class=\"ne\">ValueError</span><span class=\"p\">(</span><span class=\"n\">trans</span><span class=\"o\">.</span><span class=\"n\">_</span><span class=\"p\">(</span><span class=\"s1\">'cannot reduce selected label below 0'</span><span class=\"p\">))</span>\n        <span class=\"k\">if</span> <span class=\"n\">selected_label</span> <span class=\"o\">==</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">selected_label</span><span class=\"p\">:</span>\n            <span class=\"k\">return</span>\n\n        <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_selected_label</span> <span class=\"o\">=</span> <span class=\"n\">selected_label</span>\n        <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_selected_color</span> <span class=\"o\">=</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">get_color</span><span class=\"p\">(</span><span class=\"n\">selected_label</span><span class=\"p\">)</span>\n        <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">events</span><span class=\"o\">.</span><span class=\"n\">selected_label</span><span class=\"p\">()</span>\n\n        <span class=\"c1\"># note: self.color_mode returns a string and this comparison fails,</span>\n        <span class=\"c1\"># so use self._color_mode</span>\n        <span class=\"k\">if</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">show_selected_label</span><span class=\"p\">:</span>\n            <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">refresh</span><span class=\"p\">()</span>\n\n    <span class=\"nd\">@property</span>\n    <span class=\"k\">def</span> <span class=\"nf\">color_mode</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">):</span>\n        <span class=\"sd\">\"\"\"Color mode to change how color is represented.</span>\n\n<span class=\"sd\">        AUTO (default) allows color to be set via a hash function with a seed.</span>\n\n<span class=\"sd\">        DIRECT allows color of each label to be set directly by a color dict.</span>\n<span class=\"sd\">        \"\"\"</span>\n        <span class=\"k\">return</span> <span class=\"nb\">str</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_color_mode</span><span class=\"p\">)</span>\n\n    <span class=\"nd\">@color_mode</span><span class=\"o\">.</span><span class=\"n\">setter</span>\n    <span class=\"k\">def</span> <span class=\"nf\">color_mode</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">,</span> <span class=\"n\">color_mode</span><span class=\"p\">:</span> <span class=\"n\">Union</span><span class=\"p\">[</span><span class=\"nb\">str</span><span class=\"p\">,</span> <span class=\"n\">LabelColorMode</span><span class=\"p\">]):</span>\n        <span class=\"n\">color_mode</span> <span class=\"o\">=</span> <span class=\"n\">LabelColorMode</span><span class=\"p\">(</span><span class=\"n\">color_mode</span><span class=\"p\">)</span>\n        <span class=\"k\">if</span> <span class=\"n\">color_mode</span> <span class=\"o\">==</span> <span class=\"n\">LabelColorMode</span><span class=\"o\">.</span><span class=\"n\">DIRECT</span><span class=\"p\">:</span>\n            <span class=\"p\">(</span>\n                <span class=\"n\">custom_colormap</span><span class=\"p\">,</span>\n                <span class=\"n\">label_color_index</span><span class=\"p\">,</span>\n            <span class=\"p\">)</span> <span class=\"o\">=</span> <span class=\"n\">color_dict_to_colormap</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">color</span><span class=\"p\">)</span>\n            <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">colormap</span> <span class=\"o\">=</span> <span class=\"n\">custom_colormap</span>\n            <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_label_color_index</span> <span class=\"o\">=</span> <span class=\"n\">label_color_index</span>\n        <span class=\"k\">elif</span> <span class=\"n\">color_mode</span> <span class=\"o\">==</span> <span class=\"n\">LabelColorMode</span><span class=\"o\">.</span><span class=\"n\">AUTO</span><span class=\"p\">:</span>\n            <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_label_color_index</span> <span class=\"o\">=</span> <span class=\"p\">{}</span>\n            <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">colormap</span> <span class=\"o\">=</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_random_colormap</span>\n\n        <span class=\"k\">else</span><span class=\"p\">:</span>\n            <span class=\"k\">raise</span> <span class=\"ne\">ValueError</span><span class=\"p\">(</span><span class=\"n\">trans</span><span class=\"o\">.</span><span class=\"n\">_</span><span class=\"p\">(</span><span class=\"s2\">\"Unsupported Color Mode\"</span><span class=\"p\">))</span>\n\n        <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_color_mode</span> <span class=\"o\">=</span> <span class=\"n\">color_mode</span>\n        <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_selected_color</span> <span class=\"o\">=</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">get_color</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">selected_label</span><span class=\"p\">)</span>\n        <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">events</span><span class=\"o\">.</span><span class=\"n\">color_mode</span><span class=\"p\">()</span>\n        <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">events</span><span class=\"o\">.</span><span class=\"n\">colormap</span><span class=\"p\">()</span>\n        <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">events</span><span class=\"o\">.</span><span class=\"n\">selected_label</span><span class=\"p\">()</span>\n        <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">refresh</span><span class=\"p\">()</span>\n\n    <span class=\"nd\">@property</span>\n    <span class=\"k\">def</span> <span class=\"nf\">show_selected_label</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">):</span>\n        <span class=\"sd\">\"\"\"Whether to filter displayed labels to only the selected label or not\"\"\"</span>\n        <span class=\"k\">return</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_show_selected_label</span>\n\n    <span class=\"nd\">@show_selected_label</span><span class=\"o\">.</span><span class=\"n\">setter</span>\n    <span class=\"k\">def</span> <span class=\"nf\">show_selected_label</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">,</span> <span class=\"nb\">filter</span><span class=\"p\">):</span>\n        <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_show_selected_label</span> <span class=\"o\">=</span> <span class=\"nb\">filter</span>\n        <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">refresh</span><span class=\"p\">()</span>\n\n    <span class=\"nd\">@property</span>\n    <span class=\"k\">def</span> <span class=\"nf\">mode</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">):</span>\n        <span class=\"sd\">\"\"\"MODE: Interactive mode. The normal, default mode is PAN_ZOOM, which</span>\n<span class=\"sd\">        allows for normal interactivity with the canvas.</span>\n\n<span class=\"sd\">        In PICK mode the cursor functions like a color picker, setting the</span>\n<span class=\"sd\">        clicked on label to be the current label. If the background is picked it</span>\n<span class=\"sd\">        will select the background label `0`.</span>\n\n<span class=\"sd\">        In PAINT mode the cursor functions like a paint brush changing any</span>\n<span class=\"sd\">        pixels it brushes over to the current label. If the background label</span>\n<span class=\"sd\">        `0` is selected than any pixels will be changed to background and this</span>\n<span class=\"sd\">        tool functions like an eraser. The size and shape of the cursor can be</span>\n<span class=\"sd\">        adjusted in the properties widget.</span>\n\n<span class=\"sd\">        In FILL mode the cursor functions like a fill bucket replacing pixels</span>\n<span class=\"sd\">        of the label clicked on with the current label. It can either replace</span>\n<span class=\"sd\">        all pixels of that label or just those that are contiguous with the</span>\n<span class=\"sd\">        clicked on pixel. If the background label `0` is selected than any</span>\n<span class=\"sd\">        pixels will be changed to background and this tool functions like an</span>\n<span class=\"sd\">        eraser.</span>\n\n<span class=\"sd\">        In ERASE mode the cursor functions similarly to PAINT mode, but to</span>\n<span class=\"sd\">        paint with background label, which effectively removes the label.</span>\n<span class=\"sd\">        \"\"\"</span>\n        <span class=\"k\">return</span> <span class=\"nb\">str</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_mode</span><span class=\"p\">)</span>\n\n    <span class=\"n\">_drag_modes</span> <span class=\"o\">=</span> <span class=\"p\">{</span>\n        <span class=\"n\">Mode</span><span class=\"o\">.</span><span class=\"n\">PAN_ZOOM</span><span class=\"p\">:</span> <span class=\"n\">no_op</span><span class=\"p\">,</span>\n        <span class=\"n\">Mode</span><span class=\"o\">.</span><span class=\"n\">PICK</span><span class=\"p\">:</span> <span class=\"n\">pick</span><span class=\"p\">,</span>\n        <span class=\"n\">Mode</span><span class=\"o\">.</span><span class=\"n\">PAINT</span><span class=\"p\">:</span> <span class=\"n\">draw</span><span class=\"p\">,</span>\n        <span class=\"n\">Mode</span><span class=\"o\">.</span><span class=\"n\">FILL</span><span class=\"p\">:</span> <span class=\"n\">draw</span><span class=\"p\">,</span>\n        <span class=\"n\">Mode</span><span class=\"o\">.</span><span class=\"n\">ERASE</span><span class=\"p\">:</span> <span class=\"n\">draw</span><span class=\"p\">,</span>\n    <span class=\"p\">}</span>\n\n    <span class=\"n\">_move_modes</span> <span class=\"o\">=</span> <span class=\"p\">{</span>\n        <span class=\"n\">Mode</span><span class=\"o\">.</span><span class=\"n\">PAN_ZOOM</span><span class=\"p\">:</span> <span class=\"n\">no_op</span><span class=\"p\">,</span>\n        <span class=\"n\">Mode</span><span class=\"o\">.</span><span class=\"n\">PICK</span><span class=\"p\">:</span> <span class=\"n\">no_op</span><span class=\"p\">,</span>\n        <span class=\"n\">Mode</span><span class=\"o\">.</span><span class=\"n\">PAINT</span><span class=\"p\">:</span> <span class=\"n\">no_op</span><span class=\"p\">,</span>\n        <span class=\"n\">Mode</span><span class=\"o\">.</span><span class=\"n\">FILL</span><span class=\"p\">:</span> <span class=\"n\">no_op</span><span class=\"p\">,</span>\n        <span class=\"n\">Mode</span><span class=\"o\">.</span><span class=\"n\">ERASE</span><span class=\"p\">:</span> <span class=\"n\">no_op</span><span class=\"p\">,</span>\n    <span class=\"p\">}</span>\n    <span class=\"n\">_cursor_modes</span> <span class=\"o\">=</span> <span class=\"p\">{</span>\n        <span class=\"n\">Mode</span><span class=\"o\">.</span><span class=\"n\">PAN_ZOOM</span><span class=\"p\">:</span> <span class=\"s1\">'standard'</span><span class=\"p\">,</span>\n        <span class=\"n\">Mode</span><span class=\"o\">.</span><span class=\"n\">PICK</span><span class=\"p\">:</span> <span class=\"s1\">'cross'</span><span class=\"p\">,</span>\n        <span class=\"n\">Mode</span><span class=\"o\">.</span><span class=\"n\">PAINT</span><span class=\"p\">:</span> <span class=\"s1\">'circle'</span><span class=\"p\">,</span>\n        <span class=\"n\">Mode</span><span class=\"o\">.</span><span class=\"n\">FILL</span><span class=\"p\">:</span> <span class=\"s1\">'cross'</span><span class=\"p\">,</span>\n        <span class=\"n\">Mode</span><span class=\"o\">.</span><span class=\"n\">ERASE</span><span class=\"p\">:</span> <span class=\"s1\">'circle'</span><span class=\"p\">,</span>\n    <span class=\"p\">}</span>\n\n    <span class=\"nd\">@mode</span><span class=\"o\">.</span><span class=\"n\">setter</span>\n    <span class=\"k\">def</span> <span class=\"nf\">mode</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">,</span> <span class=\"n\">mode</span><span class=\"p\">:</span> <span class=\"n\">Union</span><span class=\"p\">[</span><span class=\"nb\">str</span><span class=\"p\">,</span> <span class=\"n\">Mode</span><span class=\"p\">]):</span>\n        <span class=\"n\">mode</span><span class=\"p\">,</span> <span class=\"n\">changed</span> <span class=\"o\">=</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_mode_setter_helper</span><span class=\"p\">(</span><span class=\"n\">mode</span><span class=\"p\">,</span> <span class=\"n\">Mode</span><span class=\"p\">)</span>\n        <span class=\"k\">if</span> <span class=\"ow\">not</span> <span class=\"n\">changed</span><span class=\"p\">:</span>\n            <span class=\"k\">return</span>\n\n        <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">help</span> <span class=\"o\">=</span> <span class=\"n\">_FWD_SHAPE_HELP</span><span class=\"p\">[</span><span class=\"n\">mode</span><span class=\"p\">]</span>\n\n        <span class=\"k\">if</span> <span class=\"n\">mode</span> <span class=\"ow\">in</span> <span class=\"p\">(</span><span class=\"n\">Mode</span><span class=\"o\">.</span><span class=\"n\">PAINT</span><span class=\"p\">,</span> <span class=\"n\">Mode</span><span class=\"o\">.</span><span class=\"n\">ERASE</span><span class=\"p\">):</span>\n            <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">cursor_size</span> <span class=\"o\">=</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_calculate_cursor_size</span><span class=\"p\">()</span>\n\n        <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">events</span><span class=\"o\">.</span><span class=\"n\">mode</span><span class=\"p\">(</span><span class=\"n\">mode</span><span class=\"o\">=</span><span class=\"n\">mode</span><span class=\"p\">)</span>\n        <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">refresh</span><span class=\"p\">()</span>\n\n    <span class=\"nd\">@property</span>\n    <span class=\"k\">def</span> <span class=\"nf\">preserve_labels</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">):</span>\n        <span class=\"sd\">\"\"\"Defines if painting should preserve existing labels.</span>\n\n<span class=\"sd\">        Default to false to allow paint on existing labels. When</span>\n<span class=\"sd\">        set to true, existing labels will be preserved during painting.</span>\n<span class=\"sd\">        \"\"\"</span>\n        <span class=\"k\">return</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_preserve_labels</span>\n\n    <span class=\"nd\">@preserve_labels</span><span class=\"o\">.</span><span class=\"n\">setter</span>\n    <span class=\"k\">def</span> <span class=\"nf\">preserve_labels</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">,</span> <span class=\"n\">preserve_labels</span><span class=\"p\">:</span> <span class=\"nb\">bool</span><span class=\"p\">):</span>\n        <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_preserve_labels</span> <span class=\"o\">=</span> <span class=\"n\">preserve_labels</span>\n        <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">events</span><span class=\"o\">.</span><span class=\"n\">preserve_labels</span><span class=\"p\">(</span><span class=\"n\">preserve_labels</span><span class=\"o\">=</span><span class=\"n\">preserve_labels</span><span class=\"p\">)</span>\n\n    <span class=\"k\">def</span> <span class=\"nf\">_set_editable</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">,</span> <span class=\"n\">editable</span><span class=\"o\">=</span><span class=\"kc\">None</span><span class=\"p\">):</span>\n        <span class=\"sd\">\"\"\"Set editable mode based on layer properties.\"\"\"</span>\n        <span class=\"k\">if</span> <span class=\"n\">editable</span> <span class=\"ow\">is</span> <span class=\"kc\">None</span><span class=\"p\">:</span>\n            <span class=\"k\">if</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">multiscale</span><span class=\"p\">:</span>\n                <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">editable</span> <span class=\"o\">=</span> <span class=\"kc\">False</span>\n            <span class=\"k\">else</span><span class=\"p\">:</span>\n                <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">editable</span> <span class=\"o\">=</span> <span class=\"kc\">True</span>\n\n        <span class=\"k\">if</span> <span class=\"ow\">not</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">editable</span><span class=\"p\">:</span>\n            <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">mode</span> <span class=\"o\">=</span> <span class=\"n\">Mode</span><span class=\"o\">.</span><span class=\"n\">PAN_ZOOM</span>\n            <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_reset_history</span><span class=\"p\">()</span>\n\n    <span class=\"k\">def</span> <span class=\"nf\">_lookup_with_low_discrepancy_image</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">,</span> <span class=\"n\">im</span><span class=\"p\">,</span> <span class=\"n\">selected_label</span><span class=\"o\">=</span><span class=\"kc\">None</span><span class=\"p\">):</span>\n        <span class=\"sd\">\"\"\"Returns display version of im using low_discrepancy_image.</span>\n\n<span class=\"sd\">        Passes the image through low_discrepancy_image, only coloring</span>\n<span class=\"sd\">        selected_label if it's not None.</span>\n\n<span class=\"sd\">        Parameters</span>\n<span class=\"sd\">        ----------</span>\n<span class=\"sd\">        im : array or int</span>\n<span class=\"sd\">            Raw integer input image.</span>\n<span class=\"sd\">        selected_label : int, optional</span>\n<span class=\"sd\">            Value of selected label to color, by default None</span>\n<span class=\"sd\">        \"\"\"</span>\n        <span class=\"k\">if</span> <span class=\"n\">selected_label</span><span class=\"p\">:</span>\n            <span class=\"n\">image</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">where</span><span class=\"p\">(</span>\n                <span class=\"n\">im</span> <span class=\"o\">==</span> <span class=\"n\">selected_label</span><span class=\"p\">,</span>\n                <span class=\"n\">low_discrepancy_image</span><span class=\"p\">(</span><span class=\"n\">selected_label</span><span class=\"p\">,</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_seed</span><span class=\"p\">),</span>\n                <span class=\"mi\">0</span><span class=\"p\">,</span>\n            <span class=\"p\">)</span>\n        <span class=\"k\">else</span><span class=\"p\">:</span>\n            <span class=\"n\">image</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">where</span><span class=\"p\">(</span><span class=\"n\">im</span> <span class=\"o\">&gt;</span> <span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"n\">low_discrepancy_image</span><span class=\"p\">(</span><span class=\"n\">im</span><span class=\"p\">,</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_seed</span><span class=\"p\">),</span> <span class=\"mi\">0</span><span class=\"p\">)</span>\n        <span class=\"k\">return</span> <span class=\"n\">image</span>\n\n    <span class=\"k\">def</span> <span class=\"nf\">_lookup_with_index</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">,</span> <span class=\"n\">im</span><span class=\"p\">,</span> <span class=\"n\">selected_label</span><span class=\"o\">=</span><span class=\"kc\">None</span><span class=\"p\">):</span>\n        <span class=\"sd\">\"\"\"Returns display version of im using color lookup array by index</span>\n\n<span class=\"sd\">        Parameters</span>\n<span class=\"sd\">        ----------</span>\n<span class=\"sd\">        im : array or int</span>\n<span class=\"sd\">            Raw integer input image.</span>\n<span class=\"sd\">        selected_label : int, optional</span>\n<span class=\"sd\">            Value of selected label to color, by default None</span>\n<span class=\"sd\">        \"\"\"</span>\n        <span class=\"k\">if</span> <span class=\"n\">selected_label</span><span class=\"p\">:</span>\n            <span class=\"k\">if</span> <span class=\"n\">selected_label</span> <span class=\"o\">&gt;</span> <span class=\"nb\">len</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_all_vals</span><span class=\"p\">):</span>\n                <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_color_lookup_func</span> <span class=\"o\">=</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_get_color_lookup_func</span><span class=\"p\">(</span>\n                    <span class=\"n\">im</span><span class=\"p\">,</span> <span class=\"nb\">max</span><span class=\"p\">(</span><span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">max</span><span class=\"p\">(</span><span class=\"n\">im</span><span class=\"p\">),</span> <span class=\"n\">selected_label</span><span class=\"p\">)</span>\n                <span class=\"p\">)</span>\n            <span class=\"k\">if</span> <span class=\"p\">(</span>\n                <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_color_lookup_func</span>\n                <span class=\"o\">==</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_lookup_with_low_discrepancy_image</span>\n            <span class=\"p\">):</span>\n                <span class=\"n\">image</span> <span class=\"o\">=</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_color_lookup_func</span><span class=\"p\">(</span><span class=\"n\">im</span><span class=\"p\">,</span> <span class=\"n\">selected_label</span><span class=\"p\">)</span>\n            <span class=\"k\">else</span><span class=\"p\">:</span>\n                <span class=\"n\">colors</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">zeros_like</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_all_vals</span><span class=\"p\">)</span>\n                <span class=\"n\">colors</span><span class=\"p\">[</span><span class=\"n\">selected_label</span><span class=\"p\">]</span> <span class=\"o\">=</span> <span class=\"n\">low_discrepancy_image</span><span class=\"p\">(</span>\n                    <span class=\"n\">selected_label</span><span class=\"p\">,</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_seed</span>\n                <span class=\"p\">)</span>\n                <span class=\"n\">image</span> <span class=\"o\">=</span> <span class=\"n\">colors</span><span class=\"p\">[</span><span class=\"n\">im</span><span class=\"p\">]</span>\n        <span class=\"k\">else</span><span class=\"p\">:</span>\n            <span class=\"k\">try</span><span class=\"p\">:</span>\n                <span class=\"n\">image</span> <span class=\"o\">=</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_all_vals</span><span class=\"p\">[</span><span class=\"n\">im</span><span class=\"p\">]</span>\n            <span class=\"k\">except</span> <span class=\"ne\">IndexError</span><span class=\"p\">:</span>\n                <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_color_lookup_func</span> <span class=\"o\">=</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_get_color_lookup_func</span><span class=\"p\">(</span>\n                    <span class=\"n\">im</span><span class=\"p\">,</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">max</span><span class=\"p\">(</span><span class=\"n\">im</span><span class=\"p\">)</span>\n                <span class=\"p\">)</span>\n                <span class=\"k\">if</span> <span class=\"p\">(</span>\n                    <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_color_lookup_func</span>\n                    <span class=\"o\">==</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_lookup_with_low_discrepancy_image</span>\n                <span class=\"p\">):</span>\n                    <span class=\"c1\"># revert to \"classic\" mode converting all pixels since we</span>\n                    <span class=\"c1\"># encountered a large value in the raw labels image</span>\n                    <span class=\"n\">image</span> <span class=\"o\">=</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_color_lookup_func</span><span class=\"p\">(</span><span class=\"n\">im</span><span class=\"p\">,</span> <span class=\"n\">selected_label</span><span class=\"p\">)</span>\n                <span class=\"k\">else</span><span class=\"p\">:</span>\n                    <span class=\"n\">image</span> <span class=\"o\">=</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_all_vals</span><span class=\"p\">[</span><span class=\"n\">im</span><span class=\"p\">]</span>\n        <span class=\"k\">return</span> <span class=\"n\">image</span>\n\n    <span class=\"k\">def</span> <span class=\"nf\">_get_color_lookup_func</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">,</span> <span class=\"n\">data</span><span class=\"p\">,</span> <span class=\"n\">max_label_val</span><span class=\"p\">):</span>\n        <span class=\"sd\">\"\"\"Returns function used for mapping label values to colors</span>\n\n<span class=\"sd\">        If array of [0..max(data)] would be larger than data,</span>\n<span class=\"sd\">        returns lookup_with_low_discrepancy_image, otherwise returns</span>\n<span class=\"sd\">        lookup_with_index</span>\n\n<span class=\"sd\">        Parameters</span>\n<span class=\"sd\">        ----------</span>\n<span class=\"sd\">        data : array</span>\n<span class=\"sd\">            labels data</span>\n<span class=\"sd\">        max_label_val : int</span>\n<span class=\"sd\">            maximum label value in data</span>\n\n<span class=\"sd\">        Returns</span>\n<span class=\"sd\">        -------</span>\n<span class=\"sd\">        lookup_func : function</span>\n<span class=\"sd\">            function to use for mapping label values to colors</span>\n<span class=\"sd\">        \"\"\"</span>\n\n        <span class=\"c1\"># low_discrepancy_image is slow for large images, but large labels can</span>\n        <span class=\"c1\"># blow up memory usage of an index array of colors. If the index array</span>\n        <span class=\"c1\"># would be larger than the image, we go back to computing the low</span>\n        <span class=\"c1\"># discrepancy image on the whole input image. (Up to a minimum value of</span>\n        <span class=\"c1\"># 1kB.)</span>\n        <span class=\"n\">nbytes_low_discrepancy</span> <span class=\"o\">=</span> <span class=\"n\">low_discrepancy_image</span><span class=\"p\">(</span><span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">array</span><span class=\"p\">([</span><span class=\"mi\">0</span><span class=\"p\">]))</span><span class=\"o\">.</span><span class=\"n\">nbytes</span>\n        <span class=\"n\">max_nbytes</span> <span class=\"o\">=</span> <span class=\"nb\">max</span><span class=\"p\">(</span><span class=\"n\">data</span><span class=\"o\">.</span><span class=\"n\">nbytes</span><span class=\"p\">,</span> <span class=\"mi\">1024</span><span class=\"p\">)</span>\n        <span class=\"k\">if</span> <span class=\"n\">max_label_val</span> <span class=\"o\">*</span> <span class=\"n\">nbytes_low_discrepancy</span> <span class=\"o\">&gt;</span> <span class=\"n\">max_nbytes</span><span class=\"p\">:</span>\n            <span class=\"k\">return</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_lookup_with_low_discrepancy_image</span>\n        <span class=\"k\">else</span><span class=\"p\">:</span>\n            <span class=\"k\">if</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_all_vals</span><span class=\"o\">.</span><span class=\"n\">size</span> <span class=\"o\">&lt;</span> <span class=\"n\">max_label_val</span> <span class=\"o\">+</span> <span class=\"mi\">1</span><span class=\"p\">:</span>\n                <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_all_vals</span> <span class=\"o\">=</span> <span class=\"n\">low_discrepancy_image</span><span class=\"p\">(</span>\n                    <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">arange</span><span class=\"p\">(</span><span class=\"n\">max_label_val</span> <span class=\"o\">+</span> <span class=\"mi\">1</span><span class=\"p\">),</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_seed</span>\n                <span class=\"p\">)</span>\n                <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_all_vals</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span> <span class=\"o\">=</span> <span class=\"mi\">0</span>\n            <span class=\"k\">return</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_lookup_with_index</span>\n\n    <span class=\"k\">def</span> <span class=\"nf\">_raw_to_displayed</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">,</span> <span class=\"n\">raw</span><span class=\"p\">):</span>\n        <span class=\"sd\">\"\"\"Determine displayed image from a saved raw image and a saved seed.</span>\n\n<span class=\"sd\">        This function ensures that the 0 label gets mapped to the 0 displayed</span>\n<span class=\"sd\">        pixel.</span>\n\n<span class=\"sd\">        Parameters</span>\n<span class=\"sd\">        ----------</span>\n<span class=\"sd\">        raw : array or int</span>\n<span class=\"sd\">            Raw integer input image.</span>\n\n<span class=\"sd\">        Returns</span>\n<span class=\"sd\">        -------</span>\n<span class=\"sd\">        image : array</span>\n<span class=\"sd\">            Image mapped between 0 and 1 to be displayed.</span>\n<span class=\"sd\">        \"\"\"</span>\n        <span class=\"k\">if</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_color_lookup_func</span> <span class=\"ow\">is</span> <span class=\"kc\">None</span><span class=\"p\">:</span>\n            <span class=\"n\">max_val</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">max</span><span class=\"p\">(</span><span class=\"n\">raw</span><span class=\"p\">)</span>\n            <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_color_lookup_func</span> <span class=\"o\">=</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_get_color_lookup_func</span><span class=\"p\">(</span><span class=\"n\">raw</span><span class=\"p\">,</span> <span class=\"n\">max_val</span><span class=\"p\">)</span>\n        <span class=\"k\">if</span> <span class=\"p\">(</span>\n            <span class=\"ow\">not</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">show_selected_label</span>\n            <span class=\"ow\">and</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_color_mode</span> <span class=\"o\">==</span> <span class=\"n\">LabelColorMode</span><span class=\"o\">.</span><span class=\"n\">DIRECT</span>\n        <span class=\"p\">):</span>\n            <span class=\"n\">u</span><span class=\"p\">,</span> <span class=\"n\">inv</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">unique</span><span class=\"p\">(</span><span class=\"n\">raw</span><span class=\"p\">,</span> <span class=\"n\">return_inverse</span><span class=\"o\">=</span><span class=\"kc\">True</span><span class=\"p\">)</span>\n            <span class=\"n\">image</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">array</span><span class=\"p\">(</span>\n                <span class=\"p\">[</span>\n                    <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_label_color_index</span><span class=\"p\">[</span><span class=\"n\">x</span><span class=\"p\">]</span>\n                    <span class=\"k\">if</span> <span class=\"n\">x</span> <span class=\"ow\">in</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_label_color_index</span>\n                    <span class=\"k\">else</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_label_color_index</span><span class=\"p\">[</span><span class=\"kc\">None</span><span class=\"p\">]</span>\n                    <span class=\"k\">for</span> <span class=\"n\">x</span> <span class=\"ow\">in</span> <span class=\"n\">u</span>\n                <span class=\"p\">]</span>\n            <span class=\"p\">)[</span><span class=\"n\">inv</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">reshape</span><span class=\"p\">(</span><span class=\"n\">raw</span><span class=\"o\">.</span><span class=\"n\">shape</span><span class=\"p\">)</span>\n        <span class=\"k\">elif</span> <span class=\"p\">(</span>\n            <span class=\"ow\">not</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">show_selected_label</span>\n            <span class=\"ow\">and</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_color_mode</span> <span class=\"o\">==</span> <span class=\"n\">LabelColorMode</span><span class=\"o\">.</span><span class=\"n\">AUTO</span>\n        <span class=\"p\">):</span>\n            <span class=\"n\">image</span> <span class=\"o\">=</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_color_lookup_func</span><span class=\"p\">(</span><span class=\"n\">raw</span><span class=\"p\">)</span>\n        <span class=\"k\">elif</span> <span class=\"p\">(</span>\n            <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">show_selected_label</span>\n            <span class=\"ow\">and</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_color_mode</span> <span class=\"o\">==</span> <span class=\"n\">LabelColorMode</span><span class=\"o\">.</span><span class=\"n\">AUTO</span>\n        <span class=\"p\">):</span>\n            <span class=\"n\">image</span> <span class=\"o\">=</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_color_lookup_func</span><span class=\"p\">(</span><span class=\"n\">raw</span><span class=\"p\">,</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_selected_label</span><span class=\"p\">)</span>\n        <span class=\"k\">elif</span> <span class=\"p\">(</span>\n            <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">show_selected_label</span>\n            <span class=\"ow\">and</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_color_mode</span> <span class=\"o\">==</span> <span class=\"n\">LabelColorMode</span><span class=\"o\">.</span><span class=\"n\">DIRECT</span>\n        <span class=\"p\">):</span>\n            <span class=\"n\">selected</span> <span class=\"o\">=</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_selected_label</span>\n            <span class=\"k\">if</span> <span class=\"n\">selected</span> <span class=\"ow\">not</span> <span class=\"ow\">in</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_label_color_index</span><span class=\"p\">:</span>\n                <span class=\"n\">selected</span> <span class=\"o\">=</span> <span class=\"kc\">None</span>\n            <span class=\"n\">index</span> <span class=\"o\">=</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_label_color_index</span>\n            <span class=\"n\">image</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">where</span><span class=\"p\">(</span>\n                <span class=\"n\">raw</span> <span class=\"o\">==</span> <span class=\"n\">selected</span><span class=\"p\">,</span>\n                <span class=\"n\">index</span><span class=\"p\">[</span><span class=\"n\">selected</span><span class=\"p\">],</span>\n                <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">where</span><span class=\"p\">(</span>\n                    <span class=\"n\">raw</span> <span class=\"o\">!=</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_background_label</span><span class=\"p\">,</span>\n                    <span class=\"n\">index</span><span class=\"p\">[</span><span class=\"kc\">None</span><span class=\"p\">],</span>\n                    <span class=\"n\">index</span><span class=\"p\">[</span><span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_background_label</span><span class=\"p\">],</span>\n                <span class=\"p\">),</span>\n            <span class=\"p\">)</span>\n        <span class=\"k\">else</span><span class=\"p\">:</span>\n            <span class=\"k\">raise</span> <span class=\"ne\">ValueError</span><span class=\"p\">(</span><span class=\"s2\">\"Unsupported Color Mode\"</span><span class=\"p\">)</span>\n\n        <span class=\"k\">if</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">contour</span> <span class=\"o\">&gt;</span> <span class=\"mi\">0</span> <span class=\"ow\">and</span> <span class=\"n\">raw</span><span class=\"o\">.</span><span class=\"n\">ndim</span> <span class=\"o\">==</span> <span class=\"mi\">2</span><span class=\"p\">:</span>\n            <span class=\"n\">image</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">zeros_like</span><span class=\"p\">(</span><span class=\"n\">raw</span><span class=\"p\">)</span>\n            <span class=\"n\">struct_elem</span> <span class=\"o\">=</span> <span class=\"n\">ndi</span><span class=\"o\">.</span><span class=\"n\">generate_binary_structure</span><span class=\"p\">(</span><span class=\"n\">raw</span><span class=\"o\">.</span><span class=\"n\">ndim</span><span class=\"p\">,</span> <span class=\"mi\">1</span><span class=\"p\">)</span>\n            <span class=\"n\">thickness</span> <span class=\"o\">=</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">contour</span>\n            <span class=\"n\">thick_struct_elem</span> <span class=\"o\">=</span> <span class=\"n\">ndi</span><span class=\"o\">.</span><span class=\"n\">iterate_structure</span><span class=\"p\">(</span>\n                <span class=\"n\">struct_elem</span><span class=\"p\">,</span> <span class=\"n\">thickness</span>\n            <span class=\"p\">)</span><span class=\"o\">.</span><span class=\"n\">astype</span><span class=\"p\">(</span><span class=\"nb\">bool</span><span class=\"p\">)</span>\n            <span class=\"n\">boundaries</span> <span class=\"o\">=</span> <span class=\"n\">ndi</span><span class=\"o\">.</span><span class=\"n\">grey_dilation</span><span class=\"p\">(</span>\n                <span class=\"n\">raw</span><span class=\"p\">,</span> <span class=\"n\">footprint</span><span class=\"o\">=</span><span class=\"n\">struct_elem</span>\n            <span class=\"p\">)</span> <span class=\"o\">!=</span> <span class=\"n\">ndi</span><span class=\"o\">.</span><span class=\"n\">grey_erosion</span><span class=\"p\">(</span><span class=\"n\">raw</span><span class=\"p\">,</span> <span class=\"n\">footprint</span><span class=\"o\">=</span><span class=\"n\">thick_struct_elem</span><span class=\"p\">)</span>\n            <span class=\"n\">image</span><span class=\"p\">[</span><span class=\"n\">boundaries</span><span class=\"p\">]</span> <span class=\"o\">=</span> <span class=\"n\">raw</span><span class=\"p\">[</span><span class=\"n\">boundaries</span><span class=\"p\">]</span>\n            <span class=\"n\">image</span> <span class=\"o\">=</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_all_vals</span><span class=\"p\">[</span><span class=\"n\">image</span><span class=\"p\">]</span>\n        <span class=\"k\">elif</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">contour</span> <span class=\"o\">&gt;</span> <span class=\"mi\">0</span> <span class=\"ow\">and</span> <span class=\"n\">raw</span><span class=\"o\">.</span><span class=\"n\">ndim</span> <span class=\"o\">&gt;</span> <span class=\"mi\">2</span><span class=\"p\">:</span>\n            <span class=\"n\">warnings</span><span class=\"o\">.</span><span class=\"n\">warn</span><span class=\"p\">(</span>\n                <span class=\"n\">trans</span><span class=\"o\">.</span><span class=\"n\">_</span><span class=\"p\">(</span>\n                    <span class=\"s2\">\"Contours are not displayed during 3D rendering\"</span><span class=\"p\">,</span>\n                    <span class=\"n\">deferred</span><span class=\"o\">=</span><span class=\"kc\">True</span><span class=\"p\">,</span>\n                <span class=\"p\">)</span>\n            <span class=\"p\">)</span>\n\n        <span class=\"k\">return</span> <span class=\"n\">image</span>\n\n    <span class=\"k\">def</span> <span class=\"nf\">new_colormap</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">):</span>\n        <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">seed</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">random</span><span class=\"o\">.</span><span class=\"n\">rand</span><span class=\"p\">()</span>\n\n<div class=\"viewcode-block\" id=\"Labels.get_color\"><a class=\"viewcode-back\" href=\"../../../../api/stable/napari.layers.Labels.html#napari.layers.Labels.get_color\">[docs]</a>    <span class=\"k\">def</span> <span class=\"nf\">get_color</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">,</span> <span class=\"n\">label</span><span class=\"p\">):</span>\n        <span class=\"sd\">\"\"\"Return the color corresponding to a specific label.\"\"\"</span>\n        <span class=\"k\">if</span> <span class=\"n\">label</span> <span class=\"o\">==</span> <span class=\"mi\">0</span><span class=\"p\">:</span>\n            <span class=\"n\">col</span> <span class=\"o\">=</span> <span class=\"kc\">None</span>\n        <span class=\"k\">elif</span> <span class=\"n\">label</span> <span class=\"ow\">is</span> <span class=\"kc\">None</span><span class=\"p\">:</span>\n            <span class=\"n\">col</span> <span class=\"o\">=</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">colormap</span><span class=\"o\">.</span><span class=\"n\">map</span><span class=\"p\">([</span><span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">])[</span><span class=\"mi\">0</span><span class=\"p\">]</span>\n        <span class=\"k\">else</span><span class=\"p\">:</span>\n            <span class=\"n\">val</span> <span class=\"o\">=</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_raw_to_displayed</span><span class=\"p\">(</span><span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">array</span><span class=\"p\">([</span><span class=\"n\">label</span><span class=\"p\">]))</span>\n            <span class=\"n\">col</span> <span class=\"o\">=</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">colormap</span><span class=\"o\">.</span><span class=\"n\">map</span><span class=\"p\">(</span><span class=\"n\">val</span><span class=\"p\">)[</span><span class=\"mi\">0</span><span class=\"p\">]</span>\n        <span class=\"k\">return</span> <span class=\"n\">col</span></div>\n\n    <span class=\"k\">def</span> <span class=\"nf\">_get_value_ray</span><span class=\"p\">(</span>\n        <span class=\"bp\">self</span><span class=\"p\">,</span>\n        <span class=\"n\">start_point</span><span class=\"p\">:</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">ndarray</span><span class=\"p\">,</span>\n        <span class=\"n\">end_point</span><span class=\"p\">:</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">ndarray</span><span class=\"p\">,</span>\n        <span class=\"n\">dims_displayed</span><span class=\"p\">:</span> <span class=\"n\">List</span><span class=\"p\">[</span><span class=\"nb\">int</span><span class=\"p\">],</span>\n    <span class=\"p\">)</span> <span class=\"o\">-&gt;</span> <span class=\"n\">Optional</span><span class=\"p\">[</span><span class=\"nb\">int</span><span class=\"p\">]:</span>\n        <span class=\"sd\">\"\"\"Get the first non-background value encountered along a ray.</span>\n\n<span class=\"sd\">        Parameters</span>\n<span class=\"sd\">        ----------</span>\n<span class=\"sd\">        start_point : np.ndarray</span>\n<span class=\"sd\">            (n,) array containing the start point of the ray in data coordinates.</span>\n<span class=\"sd\">        end_point : np.ndarray</span>\n<span class=\"sd\">            (n,) array containing the end point of the ray in data coordinates.</span>\n<span class=\"sd\">        dims_displayed : List[int]</span>\n<span class=\"sd\">            The indices of the dimensions currently displayed in the viewer.</span>\n\n<span class=\"sd\">        Returns</span>\n<span class=\"sd\">        -------</span>\n<span class=\"sd\">        value : Optional[int]</span>\n<span class=\"sd\">            The first non-zero value encountered along the ray. If none</span>\n<span class=\"sd\">            was encountered or the viewer is in 2D mode, None is returned.</span>\n<span class=\"sd\">        \"\"\"</span>\n        <span class=\"k\">if</span> <span class=\"n\">start_point</span> <span class=\"ow\">is</span> <span class=\"kc\">None</span> <span class=\"ow\">or</span> <span class=\"n\">end_point</span> <span class=\"ow\">is</span> <span class=\"kc\">None</span><span class=\"p\">:</span>\n            <span class=\"k\">return</span> <span class=\"kc\">None</span>\n        <span class=\"k\">if</span> <span class=\"nb\">len</span><span class=\"p\">(</span><span class=\"n\">dims_displayed</span><span class=\"p\">)</span> <span class=\"o\">==</span> <span class=\"mi\">3</span><span class=\"p\">:</span>\n            <span class=\"c1\"># only use get_value_ray on 3D for now</span>\n            <span class=\"c1\"># we use dims_displayed because the image slice</span>\n            <span class=\"c1\"># has its dimensions  in th same order as the vispy</span>\n            <span class=\"c1\"># Volume</span>\n            <span class=\"n\">start_point</span> <span class=\"o\">=</span> <span class=\"n\">start_point</span><span class=\"p\">[</span><span class=\"n\">dims_displayed</span><span class=\"p\">]</span>\n            <span class=\"n\">end_point</span> <span class=\"o\">=</span> <span class=\"n\">end_point</span><span class=\"p\">[</span><span class=\"n\">dims_displayed</span><span class=\"p\">]</span>\n            <span class=\"n\">sample_ray</span> <span class=\"o\">=</span> <span class=\"n\">end_point</span> <span class=\"o\">-</span> <span class=\"n\">start_point</span>\n            <span class=\"n\">length_sample_vector</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">linalg</span><span class=\"o\">.</span><span class=\"n\">norm</span><span class=\"p\">(</span><span class=\"n\">sample_ray</span><span class=\"p\">)</span>\n            <span class=\"n\">n_points</span> <span class=\"o\">=</span> <span class=\"nb\">int</span><span class=\"p\">(</span><span class=\"mi\">2</span> <span class=\"o\">*</span> <span class=\"n\">length_sample_vector</span><span class=\"p\">)</span>\n            <span class=\"n\">sample_points</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">linspace</span><span class=\"p\">(</span>\n                <span class=\"n\">start_point</span><span class=\"p\">,</span> <span class=\"n\">end_point</span><span class=\"p\">,</span> <span class=\"n\">n_points</span><span class=\"p\">,</span> <span class=\"n\">endpoint</span><span class=\"o\">=</span><span class=\"kc\">True</span>\n            <span class=\"p\">)</span>\n            <span class=\"n\">im_slice</span> <span class=\"o\">=</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_slice</span><span class=\"o\">.</span><span class=\"n\">image</span><span class=\"o\">.</span><span class=\"n\">raw</span>\n            <span class=\"n\">clamped</span> <span class=\"o\">=</span> <span class=\"n\">clamp_point_to_bounding_box</span><span class=\"p\">(</span>\n                <span class=\"n\">sample_points</span><span class=\"p\">,</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_display_bounding_box</span><span class=\"p\">(</span><span class=\"n\">dims_displayed</span><span class=\"p\">)</span>\n            <span class=\"p\">)</span><span class=\"o\">.</span><span class=\"n\">astype</span><span class=\"p\">(</span><span class=\"nb\">int</span><span class=\"p\">)</span>\n            <span class=\"n\">values</span> <span class=\"o\">=</span> <span class=\"n\">im_slice</span><span class=\"p\">[</span><span class=\"nb\">tuple</span><span class=\"p\">(</span><span class=\"n\">clamped</span><span class=\"o\">.</span><span class=\"n\">T</span><span class=\"p\">)]</span>\n            <span class=\"n\">nonzero_indices</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">flatnonzero</span><span class=\"p\">(</span><span class=\"n\">values</span><span class=\"p\">)</span>\n            <span class=\"k\">if</span> <span class=\"nb\">len</span><span class=\"p\">(</span><span class=\"n\">nonzero_indices</span> <span class=\"o\">&gt;</span> <span class=\"mi\">0</span><span class=\"p\">):</span>\n                <span class=\"c1\"># if a nonzer0 value was found, return the first one</span>\n                <span class=\"k\">return</span> <span class=\"n\">values</span><span class=\"p\">[</span><span class=\"n\">nonzero_indices</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]]</span>\n\n        <span class=\"k\">return</span> <span class=\"kc\">None</span>\n\n    <span class=\"k\">def</span> <span class=\"nf\">_get_value_3d</span><span class=\"p\">(</span>\n        <span class=\"bp\">self</span><span class=\"p\">,</span>\n        <span class=\"n\">start_point</span><span class=\"p\">:</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">ndarray</span><span class=\"p\">,</span>\n        <span class=\"n\">end_point</span><span class=\"p\">:</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">ndarray</span><span class=\"p\">,</span>\n        <span class=\"n\">dims_displayed</span><span class=\"p\">:</span> <span class=\"n\">List</span><span class=\"p\">[</span><span class=\"nb\">int</span><span class=\"p\">],</span>\n    <span class=\"p\">)</span> <span class=\"o\">-&gt;</span> <span class=\"n\">Optional</span><span class=\"p\">[</span><span class=\"nb\">int</span><span class=\"p\">]:</span>\n        <span class=\"sd\">\"\"\"Get the first non-background value encountered along a ray.</span>\n\n<span class=\"sd\">        Parameters</span>\n<span class=\"sd\">        ----------</span>\n<span class=\"sd\">        start_point : np.ndarray</span>\n<span class=\"sd\">            (n,) array containing the start point of the ray in data coordinates.</span>\n<span class=\"sd\">        end_point : np.ndarray</span>\n<span class=\"sd\">            (n,) array containing the end point of the ray in data coordinates.</span>\n<span class=\"sd\">        dims_displayed : List[int]</span>\n<span class=\"sd\">            The indices of the dimensions currently displayed in the viewer.</span>\n\n<span class=\"sd\">        Returns</span>\n<span class=\"sd\">        -------</span>\n<span class=\"sd\">        value : int</span>\n<span class=\"sd\">            The first non-zero value encountered along the ray. If a</span>\n<span class=\"sd\">            non-zero value is not encountered, returns 0 (the background value).</span>\n<span class=\"sd\">        \"\"\"</span>\n        <span class=\"k\">return</span> <span class=\"p\">(</span>\n            <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_get_value_ray</span><span class=\"p\">(</span>\n                <span class=\"n\">start_point</span><span class=\"o\">=</span><span class=\"n\">start_point</span><span class=\"p\">,</span>\n                <span class=\"n\">end_point</span><span class=\"o\">=</span><span class=\"n\">end_point</span><span class=\"p\">,</span>\n                <span class=\"n\">dims_displayed</span><span class=\"o\">=</span><span class=\"n\">dims_displayed</span><span class=\"p\">,</span>\n            <span class=\"p\">)</span>\n            <span class=\"ow\">or</span> <span class=\"mi\">0</span>\n        <span class=\"p\">)</span>\n\n    <span class=\"k\">def</span> <span class=\"nf\">_reset_history</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">,</span> <span class=\"n\">event</span><span class=\"o\">=</span><span class=\"kc\">None</span><span class=\"p\">):</span>\n        <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_undo_history</span> <span class=\"o\">=</span> <span class=\"n\">deque</span><span class=\"p\">(</span><span class=\"n\">maxlen</span><span class=\"o\">=</span><span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_history_limit</span><span class=\"p\">)</span>\n        <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_redo_history</span> <span class=\"o\">=</span> <span class=\"n\">deque</span><span class=\"p\">(</span><span class=\"n\">maxlen</span><span class=\"o\">=</span><span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_history_limit</span><span class=\"p\">)</span>\n\n    <span class=\"k\">def</span> <span class=\"nf\">_save_history</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">,</span> <span class=\"n\">value</span><span class=\"p\">):</span>\n        <span class=\"sd\">\"\"\"Save a history \"atom\" to the undo history.</span>\n\n<span class=\"sd\">        A history \"atom\" is a single change operation to the array. A history</span>\n<span class=\"sd\">        *item* is a collection of atoms that were applied together to make a</span>\n<span class=\"sd\">        single change. For example, when dragging and painting, at each mouse</span>\n<span class=\"sd\">        callback we create a history \"atom\", but we save all those atoms in</span>\n<span class=\"sd\">        a single history item, since we would want to undo one drag in one</span>\n<span class=\"sd\">        undo operation.</span>\n\n<span class=\"sd\">        Parameters</span>\n<span class=\"sd\">        ----------</span>\n<span class=\"sd\">        value : 3-tuple of arrays</span>\n<span class=\"sd\">            The value is a 3-tuple containing:</span>\n\n<span class=\"sd\">            - a numpy multi-index, pointing to the array elements that were</span>\n<span class=\"sd\">              changed</span>\n<span class=\"sd\">            - the values corresponding to those elements before the change</span>\n<span class=\"sd\">            - the value(s) after the change</span>\n<span class=\"sd\">        \"\"\"</span>\n        <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_redo_history</span> <span class=\"o\">=</span> <span class=\"n\">deque</span><span class=\"p\">()</span>\n        <span class=\"k\">if</span> <span class=\"ow\">not</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_block_saving</span><span class=\"p\">:</span>\n            <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_undo_history</span><span class=\"o\">.</span><span class=\"n\">append</span><span class=\"p\">([</span><span class=\"n\">value</span><span class=\"p\">])</span>\n        <span class=\"k\">else</span><span class=\"p\">:</span>\n            <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_undo_history</span><span class=\"p\">[</span><span class=\"o\">-</span><span class=\"mi\">1</span><span class=\"p\">]</span><span class=\"o\">.</span><span class=\"n\">append</span><span class=\"p\">(</span><span class=\"n\">value</span><span class=\"p\">)</span>\n\n    <span class=\"k\">def</span> <span class=\"nf\">_load_history</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">,</span> <span class=\"n\">before</span><span class=\"p\">,</span> <span class=\"n\">after</span><span class=\"p\">,</span> <span class=\"n\">undoing</span><span class=\"o\">=</span><span class=\"kc\">True</span><span class=\"p\">):</span>\n        <span class=\"sd\">\"\"\"Load a history item and apply it to the array.</span>\n\n<span class=\"sd\">        Parameters</span>\n<span class=\"sd\">        ----------</span>\n<span class=\"sd\">        before : list of history items</span>\n<span class=\"sd\">            The list of elements from which we want to load.</span>\n<span class=\"sd\">        after : list of history items</span>\n<span class=\"sd\">            The list of element to which to append the loaded element. In the</span>\n<span class=\"sd\">            case of an undo operation, this is the redo queue, and vice versa.</span>\n<span class=\"sd\">        undoing : bool</span>\n<span class=\"sd\">            Whether we are undoing (default) or redoing. In the case of</span>\n<span class=\"sd\">            redoing, we apply the \"after change\" element of a history element</span>\n<span class=\"sd\">            (the third element of the history \"atom\").</span>\n\n<span class=\"sd\">        See Also</span>\n<span class=\"sd\">        --------</span>\n<span class=\"sd\">        Labels._save_history</span>\n<span class=\"sd\">        \"\"\"</span>\n        <span class=\"k\">if</span> <span class=\"nb\">len</span><span class=\"p\">(</span><span class=\"n\">before</span><span class=\"p\">)</span> <span class=\"o\">==</span> <span class=\"mi\">0</span><span class=\"p\">:</span>\n            <span class=\"k\">return</span>\n\n        <span class=\"n\">history_item</span> <span class=\"o\">=</span> <span class=\"n\">before</span><span class=\"o\">.</span><span class=\"n\">pop</span><span class=\"p\">()</span>\n        <span class=\"n\">after</span><span class=\"o\">.</span><span class=\"n\">append</span><span class=\"p\">(</span><span class=\"nb\">list</span><span class=\"p\">(</span><span class=\"nb\">reversed</span><span class=\"p\">(</span><span class=\"n\">history_item</span><span class=\"p\">)))</span>\n        <span class=\"k\">for</span> <span class=\"n\">prev_indices</span><span class=\"p\">,</span> <span class=\"n\">prev_values</span><span class=\"p\">,</span> <span class=\"n\">next_values</span> <span class=\"ow\">in</span> <span class=\"nb\">reversed</span><span class=\"p\">(</span><span class=\"n\">history_item</span><span class=\"p\">):</span>\n            <span class=\"n\">values</span> <span class=\"o\">=</span> <span class=\"n\">prev_values</span> <span class=\"k\">if</span> <span class=\"n\">undoing</span> <span class=\"k\">else</span> <span class=\"n\">next_values</span>\n            <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">data</span><span class=\"p\">[</span><span class=\"n\">prev_indices</span><span class=\"p\">]</span> <span class=\"o\">=</span> <span class=\"n\">values</span>\n\n        <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">refresh</span><span class=\"p\">()</span>\n\n    <span class=\"k\">def</span> <span class=\"nf\">undo</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">):</span>\n        <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_load_history</span><span class=\"p\">(</span>\n            <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_undo_history</span><span class=\"p\">,</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_redo_history</span><span class=\"p\">,</span> <span class=\"n\">undoing</span><span class=\"o\">=</span><span class=\"kc\">True</span>\n        <span class=\"p\">)</span>\n\n    <span class=\"k\">def</span> <span class=\"nf\">redo</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">):</span>\n        <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_load_history</span><span class=\"p\">(</span>\n            <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_redo_history</span><span class=\"p\">,</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_undo_history</span><span class=\"p\">,</span> <span class=\"n\">undoing</span><span class=\"o\">=</span><span class=\"kc\">False</span>\n        <span class=\"p\">)</span>\n\n<div class=\"viewcode-block\" id=\"Labels.fill\"><a class=\"viewcode-back\" href=\"../../../../api/stable/napari.layers.Labels.html#napari.layers.Labels.fill\">[docs]</a>    <span class=\"k\">def</span> <span class=\"nf\">fill</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">,</span> <span class=\"n\">coord</span><span class=\"p\">,</span> <span class=\"n\">new_label</span><span class=\"p\">,</span> <span class=\"n\">refresh</span><span class=\"o\">=</span><span class=\"kc\">True</span><span class=\"p\">):</span>\n        <span class=\"sd\">\"\"\"Replace an existing label with a new label, either just at the</span>\n<span class=\"sd\">        connected component if the `contiguous` flag is `True` or everywhere</span>\n<span class=\"sd\">        if it is `False`, working in the number of dimensions specified by</span>\n<span class=\"sd\">        the `n_edit_dimensions` flag.</span>\n\n<span class=\"sd\">        Parameters</span>\n<span class=\"sd\">        ----------</span>\n<span class=\"sd\">        coord : sequence of float</span>\n<span class=\"sd\">            Position of mouse cursor in image coordinates.</span>\n<span class=\"sd\">        new_label : int</span>\n<span class=\"sd\">            Value of the new label to be filled in.</span>\n<span class=\"sd\">        refresh : bool</span>\n<span class=\"sd\">            Whether to refresh view slice or not. Set to False to batch paint</span>\n<span class=\"sd\">            calls.</span>\n<span class=\"sd\">        \"\"\"</span>\n        <span class=\"n\">int_coord</span> <span class=\"o\">=</span> <span class=\"nb\">tuple</span><span class=\"p\">(</span><span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">round</span><span class=\"p\">(</span><span class=\"n\">coord</span><span class=\"p\">)</span><span class=\"o\">.</span><span class=\"n\">astype</span><span class=\"p\">(</span><span class=\"nb\">int</span><span class=\"p\">))</span>\n        <span class=\"c1\"># If requested fill location is outside data shape then return</span>\n        <span class=\"k\">if</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">any</span><span class=\"p\">(</span><span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">less</span><span class=\"p\">(</span><span class=\"n\">int_coord</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">))</span> <span class=\"ow\">or</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">any</span><span class=\"p\">(</span>\n            <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">greater_equal</span><span class=\"p\">(</span><span class=\"n\">int_coord</span><span class=\"p\">,</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">data</span><span class=\"o\">.</span><span class=\"n\">shape</span><span class=\"p\">)</span>\n        <span class=\"p\">):</span>\n            <span class=\"k\">return</span>\n\n        <span class=\"c1\"># If requested new label doesn't change old label then return</span>\n        <span class=\"n\">old_label</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">asarray</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">data</span><span class=\"p\">[</span><span class=\"n\">int_coord</span><span class=\"p\">])</span><span class=\"o\">.</span><span class=\"n\">item</span><span class=\"p\">()</span>\n        <span class=\"k\">if</span> <span class=\"n\">old_label</span> <span class=\"o\">==</span> <span class=\"n\">new_label</span> <span class=\"ow\">or</span> <span class=\"p\">(</span>\n            <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">preserve_labels</span> <span class=\"ow\">and</span> <span class=\"n\">old_label</span> <span class=\"o\">!=</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_background_label</span>\n        <span class=\"p\">):</span>\n            <span class=\"k\">return</span>\n\n        <span class=\"n\">dims_to_fill</span> <span class=\"o\">=</span> <span class=\"nb\">sorted</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_dims_order</span><span class=\"p\">[</span><span class=\"o\">-</span><span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">n_edit_dimensions</span> <span class=\"p\">:])</span>\n        <span class=\"n\">data_slice_list</span> <span class=\"o\">=</span> <span class=\"nb\">list</span><span class=\"p\">(</span><span class=\"n\">int_coord</span><span class=\"p\">)</span>\n        <span class=\"k\">for</span> <span class=\"n\">dim</span> <span class=\"ow\">in</span> <span class=\"n\">dims_to_fill</span><span class=\"p\">:</span>\n            <span class=\"n\">data_slice_list</span><span class=\"p\">[</span><span class=\"n\">dim</span><span class=\"p\">]</span> <span class=\"o\">=</span> <span class=\"nb\">slice</span><span class=\"p\">(</span><span class=\"kc\">None</span><span class=\"p\">)</span>\n        <span class=\"n\">data_slice</span> <span class=\"o\">=</span> <span class=\"nb\">tuple</span><span class=\"p\">(</span><span class=\"n\">data_slice_list</span><span class=\"p\">)</span>\n        <span class=\"n\">labels</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">asarray</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">data</span><span class=\"p\">[</span><span class=\"n\">data_slice</span><span class=\"p\">])</span>\n        <span class=\"n\">slice_coord</span> <span class=\"o\">=</span> <span class=\"nb\">tuple</span><span class=\"p\">(</span><span class=\"n\">int_coord</span><span class=\"p\">[</span><span class=\"n\">d</span><span class=\"p\">]</span> <span class=\"k\">for</span> <span class=\"n\">d</span> <span class=\"ow\">in</span> <span class=\"n\">dims_to_fill</span><span class=\"p\">)</span>\n\n        <span class=\"n\">matches</span> <span class=\"o\">=</span> <span class=\"n\">labels</span> <span class=\"o\">==</span> <span class=\"n\">old_label</span>\n        <span class=\"k\">if</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">contiguous</span><span class=\"p\">:</span>\n            <span class=\"c1\"># if contiguous replace only selected connected component</span>\n            <span class=\"n\">labeled_matches</span><span class=\"p\">,</span> <span class=\"n\">num_features</span> <span class=\"o\">=</span> <span class=\"n\">ndi</span><span class=\"o\">.</span><span class=\"n\">label</span><span class=\"p\">(</span><span class=\"n\">matches</span><span class=\"p\">)</span>\n            <span class=\"k\">if</span> <span class=\"n\">num_features</span> <span class=\"o\">!=</span> <span class=\"mi\">1</span><span class=\"p\">:</span>\n                <span class=\"n\">match_label</span> <span class=\"o\">=</span> <span class=\"n\">labeled_matches</span><span class=\"p\">[</span><span class=\"n\">slice_coord</span><span class=\"p\">]</span>\n                <span class=\"n\">matches</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">logical_and</span><span class=\"p\">(</span>\n                    <span class=\"n\">matches</span><span class=\"p\">,</span> <span class=\"n\">labeled_matches</span> <span class=\"o\">==</span> <span class=\"n\">match_label</span>\n                <span class=\"p\">)</span>\n\n        <span class=\"n\">match_indices_local</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">nonzero</span><span class=\"p\">(</span><span class=\"n\">matches</span><span class=\"p\">)</span>\n        <span class=\"k\">if</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">ndim</span> <span class=\"ow\">not</span> <span class=\"ow\">in</span> <span class=\"p\">{</span><span class=\"mi\">2</span><span class=\"p\">,</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">n_edit_dimensions</span><span class=\"p\">}:</span>\n            <span class=\"n\">n_idx</span> <span class=\"o\">=</span> <span class=\"nb\">len</span><span class=\"p\">(</span><span class=\"n\">match_indices_local</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">])</span>\n            <span class=\"n\">match_indices</span> <span class=\"o\">=</span> <span class=\"p\">[]</span>\n            <span class=\"n\">j</span> <span class=\"o\">=</span> <span class=\"mi\">0</span>\n            <span class=\"k\">for</span> <span class=\"n\">d</span> <span class=\"ow\">in</span> <span class=\"n\">data_slice</span><span class=\"p\">:</span>\n                <span class=\"k\">if</span> <span class=\"nb\">isinstance</span><span class=\"p\">(</span><span class=\"n\">d</span><span class=\"p\">,</span> <span class=\"nb\">slice</span><span class=\"p\">):</span>\n                    <span class=\"n\">match_indices</span><span class=\"o\">.</span><span class=\"n\">append</span><span class=\"p\">(</span><span class=\"n\">match_indices_local</span><span class=\"p\">[</span><span class=\"n\">j</span><span class=\"p\">])</span>\n                    <span class=\"n\">j</span> <span class=\"o\">+=</span> <span class=\"mi\">1</span>\n                <span class=\"k\">else</span><span class=\"p\">:</span>\n                    <span class=\"n\">match_indices</span><span class=\"o\">.</span><span class=\"n\">append</span><span class=\"p\">(</span><span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">full</span><span class=\"p\">(</span><span class=\"n\">n_idx</span><span class=\"p\">,</span> <span class=\"n\">d</span><span class=\"p\">,</span> <span class=\"n\">dtype</span><span class=\"o\">=</span><span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">intp</span><span class=\"p\">))</span>\n            <span class=\"n\">match_indices</span> <span class=\"o\">=</span> <span class=\"nb\">tuple</span><span class=\"p\">(</span><span class=\"n\">match_indices</span><span class=\"p\">)</span>\n        <span class=\"k\">else</span><span class=\"p\">:</span>\n            <span class=\"n\">match_indices</span> <span class=\"o\">=</span> <span class=\"n\">match_indices_local</span>\n\n        <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_save_history</span><span class=\"p\">(</span>\n            <span class=\"p\">(</span>\n                <span class=\"n\">match_indices</span><span class=\"p\">,</span>\n                <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">array</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">data</span><span class=\"p\">[</span><span class=\"n\">match_indices</span><span class=\"p\">],</span> <span class=\"n\">copy</span><span class=\"o\">=</span><span class=\"kc\">True</span><span class=\"p\">),</span>\n                <span class=\"n\">new_label</span><span class=\"p\">,</span>\n            <span class=\"p\">)</span>\n        <span class=\"p\">)</span>\n\n        <span class=\"c1\"># Replace target pixels with new_label</span>\n        <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">data</span><span class=\"p\">[</span><span class=\"n\">match_indices</span><span class=\"p\">]</span> <span class=\"o\">=</span> <span class=\"n\">new_label</span>\n\n        <span class=\"k\">if</span> <span class=\"n\">refresh</span> <span class=\"ow\">is</span> <span class=\"kc\">True</span><span class=\"p\">:</span>\n            <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">refresh</span><span class=\"p\">()</span></div>\n\n<div class=\"viewcode-block\" id=\"Labels.paint\"><a class=\"viewcode-back\" href=\"../../../../api/stable/napari.layers.Labels.html#napari.layers.Labels.paint\">[docs]</a>    <span class=\"k\">def</span> <span class=\"nf\">paint</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">,</span> <span class=\"n\">coord</span><span class=\"p\">,</span> <span class=\"n\">new_label</span><span class=\"p\">,</span> <span class=\"n\">refresh</span><span class=\"o\">=</span><span class=\"kc\">True</span><span class=\"p\">):</span>\n        <span class=\"sd\">\"\"\"Paint over existing labels with a new label, using the selected</span>\n<span class=\"sd\">        brush shape and size, either only on the visible slice or in all</span>\n<span class=\"sd\">        n dimensions.</span>\n\n<span class=\"sd\">        Parameters</span>\n<span class=\"sd\">        ----------</span>\n<span class=\"sd\">        coord : sequence of int</span>\n<span class=\"sd\">            Position of mouse cursor in image coordinates.</span>\n<span class=\"sd\">        new_label : int</span>\n<span class=\"sd\">            Value of the new label to be filled in.</span>\n<span class=\"sd\">        refresh : bool</span>\n<span class=\"sd\">            Whether to refresh view slice or not. Set to False to batch paint</span>\n<span class=\"sd\">            calls.</span>\n<span class=\"sd\">        \"\"\"</span>\n        <span class=\"n\">shape</span> <span class=\"o\">=</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">data</span><span class=\"o\">.</span><span class=\"n\">shape</span>\n        <span class=\"n\">dims_to_paint</span> <span class=\"o\">=</span> <span class=\"nb\">sorted</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_dims_order</span><span class=\"p\">[</span><span class=\"o\">-</span><span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">n_edit_dimensions</span> <span class=\"p\">:])</span>\n        <span class=\"n\">dims_not_painted</span> <span class=\"o\">=</span> <span class=\"nb\">sorted</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_dims_order</span><span class=\"p\">[:</span> <span class=\"o\">-</span><span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">n_edit_dimensions</span><span class=\"p\">])</span>\n        <span class=\"n\">paint_scale</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">array</span><span class=\"p\">(</span>\n            <span class=\"p\">[</span><span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">scale</span><span class=\"p\">[</span><span class=\"n\">i</span><span class=\"p\">]</span> <span class=\"k\">for</span> <span class=\"n\">i</span> <span class=\"ow\">in</span> <span class=\"n\">dims_to_paint</span><span class=\"p\">],</span> <span class=\"n\">dtype</span><span class=\"o\">=</span><span class=\"nb\">float</span>\n        <span class=\"p\">)</span>\n\n        <span class=\"n\">slice_coord</span> <span class=\"o\">=</span> <span class=\"p\">[</span><span class=\"nb\">int</span><span class=\"p\">(</span><span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">round</span><span class=\"p\">(</span><span class=\"n\">c</span><span class=\"p\">))</span> <span class=\"k\">for</span> <span class=\"n\">c</span> <span class=\"ow\">in</span> <span class=\"n\">coord</span><span class=\"p\">]</span>\n        <span class=\"k\">if</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">n_edit_dimensions</span> <span class=\"o\">&lt;</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">ndim</span><span class=\"p\">:</span>\n            <span class=\"n\">coord_paint</span> <span class=\"o\">=</span> <span class=\"p\">[</span><span class=\"n\">coord</span><span class=\"p\">[</span><span class=\"n\">i</span><span class=\"p\">]</span> <span class=\"k\">for</span> <span class=\"n\">i</span> <span class=\"ow\">in</span> <span class=\"n\">dims_to_paint</span><span class=\"p\">]</span>\n            <span class=\"n\">shape</span> <span class=\"o\">=</span> <span class=\"p\">[</span><span class=\"n\">shape</span><span class=\"p\">[</span><span class=\"n\">i</span><span class=\"p\">]</span> <span class=\"k\">for</span> <span class=\"n\">i</span> <span class=\"ow\">in</span> <span class=\"n\">dims_to_paint</span><span class=\"p\">]</span>\n        <span class=\"k\">else</span><span class=\"p\">:</span>\n            <span class=\"n\">coord_paint</span> <span class=\"o\">=</span> <span class=\"n\">coord</span>\n\n        <span class=\"c1\"># Ensure circle doesn't have spurious point</span>\n        <span class=\"c1\"># on edge by keeping radius as ##.5</span>\n        <span class=\"n\">radius</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">floor</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">brush_size</span> <span class=\"o\">/</span> <span class=\"mi\">2</span><span class=\"p\">)</span> <span class=\"o\">+</span> <span class=\"mf\">0.5</span>\n        <span class=\"n\">mask_indices</span> <span class=\"o\">=</span> <span class=\"n\">sphere_indices</span><span class=\"p\">(</span><span class=\"n\">radius</span><span class=\"p\">,</span> <span class=\"nb\">tuple</span><span class=\"p\">(</span><span class=\"n\">paint_scale</span><span class=\"p\">))</span>\n\n        <span class=\"n\">mask_indices</span> <span class=\"o\">=</span> <span class=\"n\">mask_indices</span> <span class=\"o\">+</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">round</span><span class=\"p\">(</span><span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">array</span><span class=\"p\">(</span><span class=\"n\">coord_paint</span><span class=\"p\">))</span><span class=\"o\">.</span><span class=\"n\">astype</span><span class=\"p\">(</span>\n            <span class=\"nb\">int</span>\n        <span class=\"p\">)</span>\n\n        <span class=\"c1\"># discard candidate coordinates that are out of bounds</span>\n        <span class=\"n\">mask_indices</span> <span class=\"o\">=</span> <span class=\"n\">indices_in_shape</span><span class=\"p\">(</span><span class=\"n\">mask_indices</span><span class=\"p\">,</span> <span class=\"n\">shape</span><span class=\"p\">)</span>\n\n        <span class=\"c1\"># Transfer valid coordinates to slice_coord,</span>\n        <span class=\"c1\"># or expand coordinate if 3rd dim in 2D image</span>\n        <span class=\"n\">slice_coord_temp</span> <span class=\"o\">=</span> <span class=\"p\">[</span><span class=\"n\">m</span> <span class=\"k\">for</span> <span class=\"n\">m</span> <span class=\"ow\">in</span> <span class=\"n\">mask_indices</span><span class=\"o\">.</span><span class=\"n\">T</span><span class=\"p\">]</span>\n        <span class=\"k\">if</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">n_edit_dimensions</span> <span class=\"o\">&lt;</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">ndim</span><span class=\"p\">:</span>\n            <span class=\"k\">for</span> <span class=\"n\">j</span><span class=\"p\">,</span> <span class=\"n\">i</span> <span class=\"ow\">in</span> <span class=\"nb\">enumerate</span><span class=\"p\">(</span><span class=\"n\">dims_to_paint</span><span class=\"p\">):</span>\n                <span class=\"n\">slice_coord</span><span class=\"p\">[</span><span class=\"n\">i</span><span class=\"p\">]</span> <span class=\"o\">=</span> <span class=\"n\">slice_coord_temp</span><span class=\"p\">[</span><span class=\"n\">j</span><span class=\"p\">]</span>\n            <span class=\"k\">for</span> <span class=\"n\">i</span> <span class=\"ow\">in</span> <span class=\"n\">dims_not_painted</span><span class=\"p\">:</span>\n                <span class=\"n\">slice_coord</span><span class=\"p\">[</span><span class=\"n\">i</span><span class=\"p\">]</span> <span class=\"o\">=</span> <span class=\"n\">slice_coord</span><span class=\"p\">[</span><span class=\"n\">i</span><span class=\"p\">]</span> <span class=\"o\">*</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">ones</span><span class=\"p\">(</span>\n                    <span class=\"n\">mask_indices</span><span class=\"o\">.</span><span class=\"n\">shape</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">],</span> <span class=\"n\">dtype</span><span class=\"o\">=</span><span class=\"nb\">int</span>\n                <span class=\"p\">)</span>\n        <span class=\"k\">else</span><span class=\"p\">:</span>\n            <span class=\"n\">slice_coord</span> <span class=\"o\">=</span> <span class=\"n\">slice_coord_temp</span>\n\n        <span class=\"n\">slice_coord</span> <span class=\"o\">=</span> <span class=\"nb\">tuple</span><span class=\"p\">(</span><span class=\"n\">slice_coord</span><span class=\"p\">)</span>\n\n        <span class=\"c1\"># Fix indexing for xarray if necessary</span>\n        <span class=\"c1\"># See http://xarray.pydata.org/en/stable/indexing.html#vectorized-indexing</span>\n        <span class=\"c1\"># for difference from indexing numpy</span>\n        <span class=\"k\">try</span><span class=\"p\">:</span>\n            <span class=\"kn\">import</span> <span class=\"nn\">xarray</span> <span class=\"k\">as</span> <span class=\"nn\">xr</span>\n\n            <span class=\"k\">if</span> <span class=\"nb\">isinstance</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">data</span><span class=\"p\">,</span> <span class=\"n\">xr</span><span class=\"o\">.</span><span class=\"n\">DataArray</span><span class=\"p\">):</span>\n                <span class=\"n\">slice_coord</span> <span class=\"o\">=</span> <span class=\"nb\">tuple</span><span class=\"p\">(</span><span class=\"n\">xr</span><span class=\"o\">.</span><span class=\"n\">DataArray</span><span class=\"p\">(</span><span class=\"n\">i</span><span class=\"p\">)</span> <span class=\"k\">for</span> <span class=\"n\">i</span> <span class=\"ow\">in</span> <span class=\"n\">slice_coord</span><span class=\"p\">)</span>\n        <span class=\"k\">except</span> <span class=\"ne\">ImportError</span><span class=\"p\">:</span>\n            <span class=\"k\">pass</span>\n\n        <span class=\"c1\"># slice coord is a tuple of coordinate arrays per dimension</span>\n        <span class=\"c1\"># subset it if we want to only paint into background/only erase</span>\n        <span class=\"c1\"># current label</span>\n        <span class=\"k\">if</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">preserve_labels</span><span class=\"p\">:</span>\n            <span class=\"k\">if</span> <span class=\"n\">new_label</span> <span class=\"o\">==</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_background_label</span><span class=\"p\">:</span>\n                <span class=\"n\">keep_coords</span> <span class=\"o\">=</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">data</span><span class=\"p\">[</span><span class=\"n\">slice_coord</span><span class=\"p\">]</span> <span class=\"o\">==</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">selected_label</span>\n            <span class=\"k\">else</span><span class=\"p\">:</span>\n                <span class=\"n\">keep_coords</span> <span class=\"o\">=</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">data</span><span class=\"p\">[</span><span class=\"n\">slice_coord</span><span class=\"p\">]</span> <span class=\"o\">==</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_background_label</span>\n            <span class=\"n\">slice_coord</span> <span class=\"o\">=</span> <span class=\"nb\">tuple</span><span class=\"p\">(</span><span class=\"n\">sc</span><span class=\"p\">[</span><span class=\"n\">keep_coords</span><span class=\"p\">]</span> <span class=\"k\">for</span> <span class=\"n\">sc</span> <span class=\"ow\">in</span> <span class=\"n\">slice_coord</span><span class=\"p\">)</span>\n\n        <span class=\"c1\"># save the existing values to the history</span>\n        <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_save_history</span><span class=\"p\">(</span>\n            <span class=\"p\">(</span>\n                <span class=\"n\">slice_coord</span><span class=\"p\">,</span>\n                <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">array</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">data</span><span class=\"p\">[</span><span class=\"n\">slice_coord</span><span class=\"p\">],</span> <span class=\"n\">copy</span><span class=\"o\">=</span><span class=\"kc\">True</span><span class=\"p\">),</span>\n                <span class=\"n\">new_label</span><span class=\"p\">,</span>\n            <span class=\"p\">)</span>\n        <span class=\"p\">)</span>\n\n        <span class=\"c1\"># update the labels image</span>\n        <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">data</span><span class=\"p\">[</span><span class=\"n\">slice_coord</span><span class=\"p\">]</span> <span class=\"o\">=</span> <span class=\"n\">new_label</span>\n\n        <span class=\"k\">if</span> <span class=\"n\">refresh</span> <span class=\"ow\">is</span> <span class=\"kc\">True</span><span class=\"p\">:</span>\n            <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">refresh</span><span class=\"p\">()</span></div>\n\n<div class=\"viewcode-block\" id=\"Labels.get_status\"><a class=\"viewcode-back\" href=\"../../../../api/stable/napari.layers.Labels.html#napari.layers.Labels.get_status\">[docs]</a>    <span class=\"k\">def</span> <span class=\"nf\">get_status</span><span class=\"p\">(</span>\n        <span class=\"bp\">self</span><span class=\"p\">,</span>\n        <span class=\"n\">position</span><span class=\"p\">,</span>\n        <span class=\"o\">*</span><span class=\"p\">,</span>\n        <span class=\"n\">view_direction</span><span class=\"p\">:</span> <span class=\"n\">Optional</span><span class=\"p\">[</span><span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">ndarray</span><span class=\"p\">]</span> <span class=\"o\">=</span> <span class=\"kc\">None</span><span class=\"p\">,</span>\n        <span class=\"n\">dims_displayed</span><span class=\"p\">:</span> <span class=\"n\">Optional</span><span class=\"p\">[</span><span class=\"n\">List</span><span class=\"p\">[</span><span class=\"nb\">int</span><span class=\"p\">]]</span> <span class=\"o\">=</span> <span class=\"kc\">None</span><span class=\"p\">,</span>\n        <span class=\"n\">world</span><span class=\"p\">:</span> <span class=\"nb\">bool</span> <span class=\"o\">=</span> <span class=\"kc\">False</span><span class=\"p\">,</span>\n    <span class=\"p\">)</span> <span class=\"o\">-&gt;</span> <span class=\"nb\">str</span><span class=\"p\">:</span>\n        <span class=\"sd\">\"\"\"Status message of the data at a coordinate position.</span>\n\n<span class=\"sd\">        Parameters</span>\n<span class=\"sd\">        ----------</span>\n<span class=\"sd\">        position : tuple</span>\n<span class=\"sd\">            Position in either data or world coordinates.</span>\n<span class=\"sd\">        view_direction : Optional[np.ndarray]</span>\n<span class=\"sd\">            A unit vector giving the direction of the ray in nD world coordinates.</span>\n<span class=\"sd\">            The default value is None.</span>\n<span class=\"sd\">        dims_displayed : Optional[List[int]]</span>\n<span class=\"sd\">            A list of the dimensions currently being displayed in the viewer.</span>\n<span class=\"sd\">            The default value is None.</span>\n<span class=\"sd\">        world : bool</span>\n<span class=\"sd\">            If True the position is taken to be in world coordinates</span>\n<span class=\"sd\">            and converted into data coordinates. False by default.</span>\n\n<span class=\"sd\">        Returns</span>\n<span class=\"sd\">        -------</span>\n<span class=\"sd\">        msg : string</span>\n<span class=\"sd\">            String containing a message that can be used as a status update.</span>\n<span class=\"sd\">        \"\"\"</span>\n        <span class=\"n\">value</span> <span class=\"o\">=</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">get_value</span><span class=\"p\">(</span>\n            <span class=\"n\">position</span><span class=\"p\">,</span>\n            <span class=\"n\">view_direction</span><span class=\"o\">=</span><span class=\"n\">view_direction</span><span class=\"p\">,</span>\n            <span class=\"n\">dims_displayed</span><span class=\"o\">=</span><span class=\"n\">dims_displayed</span><span class=\"p\">,</span>\n            <span class=\"n\">world</span><span class=\"o\">=</span><span class=\"n\">world</span><span class=\"p\">,</span>\n        <span class=\"p\">)</span>\n        <span class=\"n\">msg</span> <span class=\"o\">=</span> <span class=\"n\">generate_layer_status</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">name</span><span class=\"p\">,</span> <span class=\"n\">position</span><span class=\"p\">,</span> <span class=\"n\">value</span><span class=\"p\">)</span>\n\n        <span class=\"c1\"># if this labels layer has properties</span>\n        <span class=\"n\">properties</span> <span class=\"o\">=</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_get_properties</span><span class=\"p\">(</span><span class=\"n\">position</span><span class=\"p\">,</span> <span class=\"n\">world</span><span class=\"p\">)</span>\n        <span class=\"k\">if</span> <span class=\"n\">properties</span><span class=\"p\">:</span>\n            <span class=\"n\">msg</span> <span class=\"o\">+=</span> <span class=\"s2\">\"; \"</span> <span class=\"o\">+</span> <span class=\"s2\">\", \"</span><span class=\"o\">.</span><span class=\"n\">join</span><span class=\"p\">(</span><span class=\"n\">properties</span><span class=\"p\">)</span>\n\n        <span class=\"k\">return</span> <span class=\"n\">msg</span></div>\n\n    <span class=\"k\">def</span> <span class=\"nf\">_get_tooltip_text</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">,</span> <span class=\"n\">position</span><span class=\"p\">,</span> <span class=\"o\">*</span><span class=\"p\">,</span> <span class=\"n\">world</span><span class=\"o\">=</span><span class=\"kc\">False</span><span class=\"p\">):</span>\n        <span class=\"sd\">\"\"\"</span>\n<span class=\"sd\">        tooltip message of the data at a coordinate position.</span>\n\n<span class=\"sd\">        Parameters</span>\n<span class=\"sd\">        ----------</span>\n<span class=\"sd\">        position : tuple</span>\n<span class=\"sd\">            Position in either data or world coordinates.</span>\n<span class=\"sd\">        world : bool</span>\n<span class=\"sd\">            If True the position is taken to be in world coordinates</span>\n<span class=\"sd\">            and converted into data coordinates. False by default.</span>\n\n<span class=\"sd\">        Returns</span>\n<span class=\"sd\">        -------</span>\n<span class=\"sd\">        msg : string</span>\n<span class=\"sd\">            String containing a message that can be used as a tooltip.</span>\n<span class=\"sd\">        \"\"\"</span>\n        <span class=\"k\">return</span> <span class=\"s2\">\"</span><span class=\"se\">\\n</span><span class=\"s2\">\"</span><span class=\"o\">.</span><span class=\"n\">join</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_get_properties</span><span class=\"p\">(</span><span class=\"n\">position</span><span class=\"p\">,</span> <span class=\"n\">world</span><span class=\"p\">))</span>\n\n    <span class=\"k\">def</span> <span class=\"nf\">_get_properties</span><span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"p\">,</span> <span class=\"n\">position</span><span class=\"p\">,</span> <span class=\"n\">world</span><span class=\"p\">)</span> <span class=\"o\">-&gt;</span> <span class=\"nb\">list</span><span class=\"p\">:</span>\n        <span class=\"k\">if</span> <span class=\"ow\">not</span> <span class=\"p\">(</span><span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_label_index</span> <span class=\"ow\">and</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_properties</span><span class=\"p\">):</span>\n            <span class=\"k\">return</span> <span class=\"p\">[]</span>\n\n        <span class=\"n\">value</span> <span class=\"o\">=</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">get_value</span><span class=\"p\">(</span><span class=\"n\">position</span><span class=\"p\">,</span> <span class=\"n\">world</span><span class=\"o\">=</span><span class=\"n\">world</span><span class=\"p\">)</span>\n        <span class=\"c1\"># if the cursor is not outside the image or on the background</span>\n        <span class=\"k\">if</span> <span class=\"n\">value</span> <span class=\"ow\">is</span> <span class=\"kc\">None</span><span class=\"p\">:</span>\n            <span class=\"k\">return</span> <span class=\"p\">[]</span>\n\n        <span class=\"n\">label_value</span> <span class=\"o\">=</span> <span class=\"n\">value</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">]</span> <span class=\"k\">if</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">multiscale</span> <span class=\"k\">else</span> <span class=\"n\">value</span>\n        <span class=\"k\">if</span> <span class=\"n\">label_value</span> <span class=\"ow\">not</span> <span class=\"ow\">in</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_label_index</span><span class=\"p\">:</span>\n            <span class=\"k\">return</span> <span class=\"p\">[</span><span class=\"n\">trans</span><span class=\"o\">.</span><span class=\"n\">_</span><span class=\"p\">(</span><span class=\"s1\">'[No Properties]'</span><span class=\"p\">)]</span>\n\n        <span class=\"n\">idx</span> <span class=\"o\">=</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_label_index</span><span class=\"p\">[</span><span class=\"n\">label_value</span><span class=\"p\">]</span>\n        <span class=\"k\">return</span> <span class=\"p\">[</span>\n            <span class=\"sa\">f</span><span class=\"s1\">'</span><span class=\"si\">{</span><span class=\"n\">k</span><span class=\"si\">}</span><span class=\"s1\">: </span><span class=\"si\">{</span><span class=\"n\">v</span><span class=\"p\">[</span><span class=\"n\">idx</span><span class=\"p\">]</span><span class=\"si\">}</span><span class=\"s1\">'</span>\n            <span class=\"k\">for</span> <span class=\"n\">k</span><span class=\"p\">,</span> <span class=\"n\">v</span> <span class=\"ow\">in</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">_properties</span><span class=\"o\">.</span><span class=\"n\">items</span><span class=\"p\">()</span>\n            <span class=\"k\">if</span> <span class=\"n\">k</span> <span class=\"o\">!=</span> <span class=\"s1\">'index'</span>\n            <span class=\"ow\">and</span> <span class=\"nb\">len</span><span class=\"p\">(</span><span class=\"n\">v</span><span class=\"p\">)</span> <span class=\"o\">&gt;</span> <span class=\"n\">idx</span>\n            <span class=\"ow\">and</span> <span class=\"n\">v</span><span class=\"p\">[</span><span class=\"n\">idx</span><span class=\"p\">]</span> <span class=\"ow\">is</span> <span class=\"ow\">not</span> <span class=\"kc\">None</span>\n            <span class=\"ow\">and</span> <span class=\"ow\">not</span> <span class=\"p\">(</span><span class=\"nb\">isinstance</span><span class=\"p\">(</span><span class=\"n\">v</span><span class=\"p\">[</span><span class=\"n\">idx</span><span class=\"p\">],</span> <span class=\"nb\">float</span><span class=\"p\">)</span> <span class=\"ow\">and</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">isnan</span><span class=\"p\">(</span><span class=\"n\">v</span><span class=\"p\">[</span><span class=\"n\">idx</span><span class=\"p\">]))</span>\n        <span class=\"p\">]</span>\n\n\n<span class=\"k\">if</span> <span class=\"n\">config</span><span class=\"o\">.</span><span class=\"n\">async_octree</span><span class=\"p\">:</span>\n    <span class=\"kn\">from</span> <span class=\"nn\">..image.experimental.octree_image</span> <span class=\"kn\">import</span> <span class=\"n\">_OctreeImageBase</span>\n\n<div class=\"viewcode-block\" id=\"Labels\"><a class=\"viewcode-back\" href=\"../../../../api/stable/napari.layers.Labels.html#napari.layers.Labels\">[docs]</a>    <span class=\"k\">class</span> <span class=\"nc\">Labels</span><span class=\"p\">(</span><span class=\"n\">Labels</span><span class=\"p\">,</span> <span class=\"n\">_OctreeImageBase</span><span class=\"p\">):</span>\n        <span class=\"k\">pass</span></div>\n</pre></div>\n      ","pageHeaders":[],"ipynbSource":"","mdSource":""}},"__N_SSG":true}