{"pageProps":{"state":{"globalHeaders":{"https://napari-hub.org":{"level":1,"children":[],"href":"https://napari-hub.org","text":"napari hub"},"https://github.com/napari/napari":{"level":1,"children":[],"href":"https://github.com/napari/napari","text":"napari source code"},"/roadmaps/index.html":{"level":1,"children":["/roadmaps/0_4.html","/roadmaps/0_3_retrospective.html","/roadmaps/0_3.html"],"href":"/roadmaps/index.html","text":"Roadmaps"},"/roadmaps/0_3.html":{"level":2,"children":[],"href":"/roadmaps/0_3.html","text":"Roadmap 0.3"},"/roadmaps/0_3_retrospective.html":{"level":2,"children":[],"href":"/roadmaps/0_3_retrospective.html","text":"Roadmap 0.3 Retrospective"},"/roadmaps/0_4.html":{"level":2,"children":[],"href":"/roadmaps/0_4.html","text":"Roadmap 0.4"},"/release/index.html":{"level":1,"children":["/release/release_0_4_12.html","/release/release_0_4_11.html","/release/release_0_4_10.html","/release/release_0_4_9.html","/release/release_0_4_8.html","/release/release_0_4_7.html","/release/release_0_4_6.html","/release/release_0_4_5.html","/release/release_0_4_4.html","/release/release_0_4_3.html","/release/release_0_4_2.html","/release/release_0_4_1.html","/release/release_0_4_0.html","/release/release_0_3_8.html","/release/release_0_3_7.html","/release/release_0_3_6.html","/release/release_0_3_5.html","/release/release_0_3_4.html","/release/release_0_3_3.html","/release/release_0_3_2.html","/release/release_0_3_1.html","/release/release_0_3_0.html","/release/release_0_2_12.html","/release/release_0_2_11.html","/release/release_0_2_10.html","/release/release_0_2_9.html","/release/release_0_2_8.html","/release/release_0_2_7.html","/release/release_0_2_6.html","/release/release_0_2_5.html","/release/release_0_2_4.html","/release/release_0_2_3.html","/release/release_0_2_1.html","/release/release_0_2_0.html","/release/release_0_1_5.html","/release/release_0_1_3.html","/release/release_0_1_0.html","/release/release_0_4_13.html"],"href":"/release/index.html","text":"Release notes"},"/release/release_0_4_13.html":{"level":2,"children":[],"href":"/release/release_0_4_13.html","text":"napari 0.4.13"},"/release/release_0_1_0.html":{"level":2,"children":[],"href":"/release/release_0_1_0.html","text":"napari 0.1.0"},"/release/release_0_1_3.html":{"level":2,"children":[],"href":"/release/release_0_1_3.html","text":"napari 0.1.3"},"/release/release_0_1_5.html":{"level":2,"children":[],"href":"/release/release_0_1_5.html","text":"napari 0.1.5"},"/release/release_0_2_0.html":{"level":2,"children":[],"href":"/release/release_0_2_0.html","text":"napari 0.2.0"},"/release/release_0_2_1.html":{"level":2,"children":[],"href":"/release/release_0_2_1.html","text":"napari 0.2.1"},"/release/release_0_2_3.html":{"level":2,"children":[],"href":"/release/release_0_2_3.html","text":"napari 0.2.3"},"/release/release_0_2_4.html":{"level":2,"children":[],"href":"/release/release_0_2_4.html","text":"napari 0.2.4"},"/release/release_0_2_5.html":{"level":2,"children":[],"href":"/release/release_0_2_5.html","text":"napari 0.2.5"},"/release/release_0_2_6.html":{"level":2,"children":[],"href":"/release/release_0_2_6.html","text":"napari 0.2.6"},"/release/release_0_2_7.html":{"level":2,"children":[],"href":"/release/release_0_2_7.html","text":"napari 0.2.7"},"/release/release_0_2_8.html":{"level":2,"children":[],"href":"/release/release_0_2_8.html","text":"napari 0.2.8"},"/release/release_0_2_9.html":{"level":2,"children":[],"href":"/release/release_0_2_9.html","text":"napari 0.2.9"},"/release/release_0_2_10.html":{"level":2,"children":[],"href":"/release/release_0_2_10.html","text":"napari 0.2.10"},"/release/release_0_2_11.html":{"level":2,"children":[],"href":"/release/release_0_2_11.html","text":"napari 0.2.11"},"/release/release_0_2_12.html":{"level":2,"children":[],"href":"/release/release_0_2_12.html","text":"napari 0.2.12"},"/release/release_0_3_0.html":{"level":2,"children":[],"href":"/release/release_0_3_0.html","text":"napari 0.3.0"},"/release/release_0_3_1.html":{"level":2,"children":[],"href":"/release/release_0_3_1.html","text":"napari 0.3.1"},"/release/release_0_3_2.html":{"level":2,"children":[],"href":"/release/release_0_3_2.html","text":"napari 0.3.2"},"/release/release_0_3_3.html":{"level":2,"children":[],"href":"/release/release_0_3_3.html","text":"napari 0.3.3"},"/release/release_0_3_4.html":{"level":2,"children":[],"href":"/release/release_0_3_4.html","text":"napari 0.3.4"},"/release/release_0_3_5.html":{"level":2,"children":[],"href":"/release/release_0_3_5.html","text":"napari 0.3.5"},"/release/release_0_3_6.html":{"level":2,"children":[],"href":"/release/release_0_3_6.html","text":"napari 0.3.6"},"/release/release_0_3_7.html":{"level":2,"children":[],"href":"/release/release_0_3_7.html","text":"napari 0.3.7"},"/release/release_0_3_8.html":{"level":2,"children":[],"href":"/release/release_0_3_8.html","text":"napari 0.3.8"},"/release/release_0_4_0.html":{"level":2,"children":[],"href":"/release/release_0_4_0.html","text":"napari 0.4.0"},"/release/release_0_4_1.html":{"level":2,"children":[],"href":"/release/release_0_4_1.html","text":"napari 0.4.1"},"/release/release_0_4_2.html":{"level":2,"children":[],"href":"/release/release_0_4_2.html","text":"napari 0.4.2"},"/release/release_0_4_3.html":{"level":2,"children":[],"href":"/release/release_0_4_3.html","text":"napari 0.4.3"},"/release/release_0_4_4.html":{"level":2,"children":[],"href":"/release/release_0_4_4.html","text":"napari 0.4.4"},"/release/release_0_4_5.html":{"level":2,"children":[],"href":"/release/release_0_4_5.html","text":"napari 0.4.5"},"/release/release_0_4_6.html":{"level":2,"children":[],"href":"/release/release_0_4_6.html","text":"napari 0.4.6"},"/release/release_0_4_7.html":{"level":2,"children":[],"href":"/release/release_0_4_7.html","text":"napari 0.4.7"},"/release/release_0_4_8.html":{"level":2,"children":[],"href":"/release/release_0_4_8.html","text":"napari 0.4.8"},"/release/release_0_4_9.html":{"level":2,"children":[],"href":"/release/release_0_4_9.html","text":"napari 0.4.9"},"/release/release_0_4_10.html":{"level":2,"children":[],"href":"/release/release_0_4_10.html","text":"napari 0.4.10"},"/release/release_0_4_11.html":{"level":2,"children":[],"href":"/release/release_0_4_11.html","text":"napari 0.4.11"},"/release/release_0_4_12.html":{"level":2,"children":[],"href":"/release/release_0_4_12.html","text":"napari 0.4.12"},"/glossary.html":{"level":1,"children":[],"href":"/glossary.html","text":"Glossary"},"/developers/index.html":{"level":1,"children":["/developers/benchmarks.html","/developers/contributing.html","/developers/core_dev_guide.html","/developers/profiling.html","/developers/release.html","/developers/testing.html","/developers/docs.html","/developers/translations.html"],"href":"/developers/index.html","text":"Developer resources"},"/developers/translations.html":{"level":2,"children":[],"href":"/developers/translations.html","text":"Translations"},"/developers/docs.html":{"level":2,"children":[],"href":"/developers/docs.html","text":"Organization of Documentation for napari"},"/developers/testing.html":{"level":2,"children":[],"href":"/developers/testing.html","text":"Testing"},"/developers/release.html":{"level":2,"children":[],"href":"/developers/release.html","text":"Release guide"},"/developers/profiling.html":{"level":2,"children":[],"href":"/developers/profiling.html","text":"Profiling"},"/developers/core_dev_guide.html":{"level":2,"children":[],"href":"/developers/core_dev_guide.html","text":"Core Developer guide"},"/developers/contributing.html":{"level":2,"children":[],"href":"/developers/contributing.html","text":"Contributing guide"},"/developers/benchmarks.html":{"level":2,"children":[],"href":"/developers/benchmarks.html","text":"Benchmarks"},"/api/stable/index.html":{"level":1,"children":["/api/stable/napari.layers.html","/api/stable/napari.view_layers.html","/api/stable/napari.types.html","/api/stable/napari.utils.html","/api/stable/napari.plugins.html","/api/stable/napari.components.html","/api/stable/napari.qt.threading.html","/api/stable/napari.utils.perf.html","/api/stable/napari.html","/api/stable/napari.html"],"href":"/api/stable/index.html","text":"API reference"},"/api/stable/napari.html":{"level":2,"children":["/api/stable/napari.Viewer.html"],"href":"/api/stable/napari.html","text":"napari"},"/api/stable/napari.Viewer.html":{"level":3,"children":[],"href":"/api/stable/napari.Viewer.html","text":"napari.Viewer"},"/api/stable/napari.utils.perf.html":{"level":2,"children":["/api/stable/napari.utils.perf.PerfEvent.html"],"href":"/api/stable/napari.utils.perf.html","text":"napari.utils.perf"},"/api/stable/napari.utils.perf.PerfEvent.html":{"level":3,"children":[],"href":"/api/stable/napari.utils.perf.PerfEvent.html","text":"napari.utils.perf.PerfEvent"},"/api/stable/napari.qt.threading.html":{"level":2,"children":["/api/stable/napari.qt.threading.FunctionWorker.html","/api/stable/napari.qt.threading.GeneratorWorker.html","/api/stable/napari.qt.threading.GeneratorWorkerSignals.html","/api/stable/napari.qt.threading.WorkerBase.html","/api/stable/napari.qt.threading.WorkerBaseSignals.html"],"href":"/api/stable/napari.qt.threading.html","text":"napari.qt.threading"},"/api/stable/napari.qt.threading.WorkerBaseSignals.html":{"level":3,"children":[],"href":"/api/stable/napari.qt.threading.WorkerBaseSignals.html","text":"napari.qt.threading.WorkerBaseSignals"},"/api/stable/napari.qt.threading.WorkerBase.html":{"level":3,"children":[],"href":"/api/stable/napari.qt.threading.WorkerBase.html","text":"napari.qt.threading.WorkerBase"},"/api/stable/napari.qt.threading.GeneratorWorkerSignals.html":{"level":3,"children":[],"href":"/api/stable/napari.qt.threading.GeneratorWorkerSignals.html","text":"napari.qt.threading.GeneratorWorkerSignals"},"/api/stable/napari.qt.threading.GeneratorWorker.html":{"level":3,"children":[],"href":"/api/stable/napari.qt.threading.GeneratorWorker.html","text":"napari.qt.threading.GeneratorWorker"},"/api/stable/napari.qt.threading.FunctionWorker.html":{"level":3,"children":[],"href":"/api/stable/napari.qt.threading.FunctionWorker.html","text":"napari.qt.threading.FunctionWorker"},"/api/stable/napari.components.html":{"level":2,"children":["/api/stable/napari.components.Camera.html","/api/stable/napari.components.Dims.html","/api/stable/napari.components.LayerList.html","/api/stable/napari.components.ViewerModel.html"],"href":"/api/stable/napari.components.html","text":"napari.components"},"/api/stable/napari.components.ViewerModel.html":{"level":3,"children":[],"href":"/api/stable/napari.components.ViewerModel.html","text":"napari.components.ViewerModel"},"/api/stable/napari.components.LayerList.html":{"level":3,"children":[],"href":"/api/stable/napari.components.LayerList.html","text":"napari.components.LayerList"},"/api/stable/napari.components.Dims.html":{"level":3,"children":[],"href":"/api/stable/napari.components.Dims.html","text":"napari.components.Dims"},"/api/stable/napari.components.Camera.html":{"level":3,"children":[],"href":"/api/stable/napari.components.Camera.html","text":"napari.components.Camera"},"/api/stable/napari.plugins.html":{"level":2,"children":["/api/stable/napari.plugins.NapariPluginManager.html"],"href":"/api/stable/napari.plugins.html","text":"napari.plugins"},"/api/stable/napari.plugins.NapariPluginManager.html":{"level":3,"children":[],"href":"/api/stable/napari.plugins.NapariPluginManager.html","text":"napari.plugins.NapariPluginManager"},"/api/stable/napari.utils.html":{"level":2,"children":["/api/stable/napari.utils.Colormap.html","/api/stable/napari.utils.nbscreenshot.html","/api/stable/napari.utils.progress.html"],"href":"/api/stable/napari.utils.html","text":"napari.utils"},"/api/stable/napari.utils.progress.html":{"level":3,"children":[],"href":"/api/stable/napari.utils.progress.html","text":"napari.utils.progress"},"/api/stable/napari.utils.nbscreenshot.html":{"level":3,"children":[],"href":"/api/stable/napari.utils.nbscreenshot.html","text":"napari.utils.nbscreenshot"},"/api/stable/napari.utils.Colormap.html":{"level":3,"children":[],"href":"/api/stable/napari.utils.Colormap.html","text":"napari.utils.Colormap"},"/api/stable/napari.types.html":{"level":2,"children":["/api/stable/napari.types.ArrayBase.html","/api/stable/napari.types.Path.html","/api/stable/napari.types.SampleDict.html","/api/stable/napari.types.TracebackType.html","/api/stable/napari.types.TypedDict.html","/api/stable/napari.types.partial.html"],"href":"/api/stable/napari.types.html","text":"napari.types"},"/api/stable/napari.types.partial.html":{"level":3,"children":[],"href":"/api/stable/napari.types.partial.html","text":"napari.types.partial"},"/api/stable/napari.types.TypedDict.html":{"level":3,"children":[],"href":"/api/stable/napari.types.TypedDict.html","text":"napari.types.TypedDict"},"/api/stable/napari.types.TracebackType.html":{"level":3,"children":[],"href":"/api/stable/napari.types.TracebackType.html","text":"napari.types.TracebackType"},"/api/stable/napari.types.SampleDict.html":{"level":3,"children":[],"href":"/api/stable/napari.types.SampleDict.html","text":"napari.types.SampleDict"},"/api/stable/napari.types.Path.html":{"level":3,"children":[],"href":"/api/stable/napari.types.Path.html","text":"napari.types.Path"},"/api/stable/napari.types.ArrayBase.html":{"level":3,"children":[],"href":"/api/stable/napari.types.ArrayBase.html","text":"napari.types.ArrayBase"},"/api/stable/napari.view_layers.html":{"level":2,"children":["/api/stable/napari.view_layers.Viewer.html"],"href":"/api/stable/napari.view_layers.html","text":"napari.view_layers"},"/api/stable/napari.view_layers.Viewer.html":{"level":3,"children":[],"href":"/api/stable/napari.view_layers.Viewer.html","text":"napari.view_layers.Viewer"},"/api/stable/napari.layers.html":{"level":2,"children":["/api/stable/napari.layers.Image.html","/api/stable/napari.layers.Labels.html","/api/stable/napari.layers.Layer.html","/api/stable/napari.layers.Points.html","/api/stable/napari.layers.Shapes.html","/api/stable/napari.layers.Surface.html","/api/stable/napari.layers.Tracks.html","/api/stable/napari.layers.Vectors.html"],"href":"/api/stable/napari.layers.html","text":"napari.layers"},"/api/stable/napari.layers.Vectors.html":{"level":3,"children":[],"href":"/api/stable/napari.layers.Vectors.html","text":"napari.layers.Vectors"},"/api/stable/napari.layers.Tracks.html":{"level":3,"children":[],"href":"/api/stable/napari.layers.Tracks.html","text":"napari.layers.Tracks"},"/api/stable/napari.layers.Surface.html":{"level":3,"children":[],"href":"/api/stable/napari.layers.Surface.html","text":"napari.layers.Surface"},"/api/stable/napari.layers.Shapes.html":{"level":3,"children":[],"href":"/api/stable/napari.layers.Shapes.html","text":"napari.layers.Shapes"},"/api/stable/napari.layers.Points.html":{"level":3,"children":[],"href":"/api/stable/napari.layers.Points.html","text":"napari.layers.Points"},"/api/stable/napari.layers.Layer.html":{"level":3,"children":[],"href":"/api/stable/napari.layers.Layer.html","text":"napari.layers.Layer"},"/api/stable/napari.layers.Labels.html":{"level":3,"children":[],"href":"/api/stable/napari.layers.Labels.html","text":"napari.layers.Labels"},"/api/stable/napari.layers.Image.html":{"level":3,"children":[],"href":"/api/stable/napari.layers.Image.html","text":"napari.layers.Image"},"/community/index.html":{"level":1,"children":["/community/mission_and_values.html","/community/team.html","/community/code_of_conduct.html","/community/code_of_conduct_reporting.html","/community/governance.html","/community/working_groups.html","/community/meeting_schedule.html"],"href":"/community/index.html","text":"Community"},"/community/meeting_schedule.html":{"level":2,"children":[],"href":"/community/meeting_schedule.html","text":"Meeting schedule"},"/community/working_groups.html":{"level":2,"children":[],"href":"/community/working_groups.html","text":"Working groups"},"/community/governance.html":{"level":2,"children":[],"href":"/community/governance.html","text":"Governance model"},"/community/code_of_conduct_reporting.html":{"level":2,"children":[],"href":"/community/code_of_conduct_reporting.html","text":"Handling Code of Conduct reports"},"/community/code_of_conduct.html":{"level":2,"children":[],"href":"/community/code_of_conduct.html","text":"Code of Conduct"},"/community/team.html":{"level":2,"children":[],"href":"/community/team.html","text":"About the project and team"},"/community/mission_and_values.html":{"level":2,"children":[],"href":"/community/mission_and_values.html","text":"Mission and Values"},"/plugins/stable/index.html":{"level":1,"children":["/plugins/stable/best_practices.html","/plugins/stable/npe2_migration_guide.html","/plugins/stable/guides.html","/plugins/stable/first_plugin.html","/plugins/stable/test_deploy.html","/plugins/stable/npe1.html","/plugins/stable/find_and_install_plugin.html","/plugins/stable/manifest.html","/plugins/stable/contributions.html"],"href":"/plugins/stable/index.html","text":"Plugins"},"/plugins/stable/contributions.html":{"level":2,"children":[],"href":"/plugins/stable/contributions.html","text":"Contributions Reference"},"/plugins/stable/manifest.html":{"level":2,"children":[],"href":"/plugins/stable/manifest.html","text":"Manifest Reference"},"/plugins/stable/find_and_install_plugin.html":{"level":2,"children":[],"href":"/plugins/stable/find_and_install_plugin.html","text":"Finding and installing a napari plugin"},"/plugins/stable/npe1.html":{"level":2,"children":[],"href":"/plugins/stable/npe1.html","text":"1st Gen Plugin Guide (Deprecated)"},"/plugins/stable/test_deploy.html":{"level":2,"children":[],"href":"/plugins/stable/test_deploy.html","text":"Test and Deploy"},"/plugins/stable/first_plugin.html":{"level":2,"children":[],"href":"/plugins/stable/first_plugin.html","text":"Your First Plugin"},"/plugins/stable/guides.html":{"level":2,"children":[],"href":"/plugins/stable/guides.html","text":"Contribution Guides"},"/plugins/stable/npe2_migration_guide.html":{"level":2,"children":[],"href":"/plugins/stable/npe2_migration_guide.html","text":"npe2 migration guide"},"/plugins/stable/best_practices.html":{"level":2,"children":[],"href":"/plugins/stable/best_practices.html","text":"Best practices"},"/guides/stable/index.html":{"level":1,"children":["/guides/stable/magicgui.html","/guides/stable/event_loop.html","/guides/stable/threading.html","/guides/stable/rendering-explanation.html","/guides/stable/rendering.html","/guides/stable/performance.html","/guides/stable/3D_interactivity.html","/guides/stable/events_reference.html","/guides/stable/contexts_expressions.html","/guides/stable/preferences.html"],"href":"/guides/stable/index.html","text":"In-depth explanations"},"/guides/stable/preferences.html":{"level":2,"children":[],"href":"/guides/stable/preferences.html","text":"Preferences"},"/guides/stable/contexts_expressions.html":{"level":2,"children":[],"href":"/guides/stable/contexts_expressions.html","text":"Contexts and Expressions in napari"},"/guides/stable/events_reference.html":{"level":2,"children":[],"href":"/guides/stable/events_reference.html","text":"Events reference"},"/guides/stable/3D_interactivity.html":{"level":2,"children":[],"href":"/guides/stable/3D_interactivity.html","text":"3D interactivity"},"/guides/stable/performance.html":{"level":2,"children":[],"href":"/guides/stable/performance.html","text":"napari performance"},"/guides/stable/rendering.html":{"level":2,"children":[],"href":"/guides/stable/rendering.html","text":"Asynchronous rendering"},"/guides/stable/rendering-explanation.html":{"level":2,"children":[],"href":"/guides/stable/rendering-explanation.html","text":"Rendering in napari"},"/guides/stable/threading.html":{"level":2,"children":[],"href":"/guides/stable/threading.html","text":"Multithreading in napari"},"/guides/stable/event_loop.html":{"level":2,"children":[],"href":"/guides/stable/event_loop.html","text":"An introduction to the event loop in napari"},"/guides/stable/magicgui.html":{"level":2,"children":[],"href":"/guides/stable/magicgui.html","text":"Using magicgui in napari"},"/howtos/index.html":{"level":1,"children":["/howtos/connecting_events.html","/howtos/napari_imageJ.html","/howtos/docker.html","/howtos/perfmon.html"],"href":"/howtos/index.html","text":"How-to guides"},"/howtos/perfmon.html":{"level":2,"children":[],"href":"/howtos/perfmon.html","text":"Performance monitoring"},"/howtos/docker.html":{"level":2,"children":[],"href":"/howtos/docker.html","text":"Napari in Docker"},"/howtos/napari_imageJ.html":{"level":2,"children":[],"href":"/howtos/napari_imageJ.html","text":"napari + ImageJ how-to guide"},"/howtos/connecting_events.html":{"level":2,"children":[],"href":"/howtos/connecting_events.html","text":"Hooking up your own events"},"/tutorials/index.html":{"level":1,"children":["/tutorials/segmentation/index.html","/tutorials/tracking/index.html","/tutorials/applications/annotate_points.html","/tutorials/applications/dask.html","/tutorials/further-resources/napari-workshops.html","/tutorials/tracking/cell_tracking.html","/tutorials/segmentation/annotate_segmentation.html"],"href":"/tutorials/index.html","text":"Tutorials"},"/tutorials/segmentation/annotate_segmentation.html":{"level":2,"children":[],"href":"/tutorials/segmentation/annotate_segmentation.html","text":"Annotating segmentation with text and bounding boxes"},"/tutorials/tracking/cell_tracking.html":{"level":2,"children":[],"href":"/tutorials/tracking/cell_tracking.html","text":"Single cell tracking with napari"},"/tutorials/further-resources/napari-workshops.html":{"level":2,"children":[],"href":"/tutorials/further-resources/napari-workshops.html","text":"napari workshops"},"/tutorials/applications/dask.html":{"level":2,"children":[],"href":"/tutorials/applications/dask.html","text":"Using Dask and napari to process & view large datasets"},"/tutorials/applications/annotate_points.html":{"level":2,"children":[],"href":"/tutorials/applications/annotate_points.html","text":"Annotating videos with napari"},"/tutorials/tracking/index.html":{"level":2,"children":[],"href":"/tutorials/tracking/index.html","text":"Tracking"},"/tutorials/segmentation/index.html":{"level":2,"children":[],"href":"/tutorials/segmentation/index.html","text":"Segmentation"},"/tutorials/start_index.html":{"level":1,"children":["/tutorials/fundamentals/installation.html","/tutorials/fundamentals/getting_started.html","/tutorials/fundamentals/viewer.html","/tutorials/fundamentals/image.html","/tutorials/fundamentals/labels.html","/tutorials/fundamentals/points.html","/tutorials/fundamentals/shapes.html","/tutorials/fundamentals/surface.html","/tutorials/fundamentals/tracks.html","/tutorials/fundamentals/vectors.html"],"href":"/tutorials/start_index.html","text":"Getting Started"},"/tutorials/fundamentals/vectors.html":{"level":2,"children":[],"href":"/tutorials/fundamentals/vectors.html","text":"vectors layer tutorial"},"/tutorials/fundamentals/tracks.html":{"level":2,"children":[],"href":"/tutorials/fundamentals/tracks.html","text":"tracks layer tutorial"},"/tutorials/fundamentals/surface.html":{"level":2,"children":[],"href":"/tutorials/fundamentals/surface.html","text":"surface layer tutorial"},"/tutorials/fundamentals/shapes.html":{"level":2,"children":[],"href":"/tutorials/fundamentals/shapes.html","text":"shapes layer tutorial"},"/tutorials/fundamentals/points.html":{"level":2,"children":[],"href":"/tutorials/fundamentals/points.html","text":"points layer tutorial"},"/tutorials/fundamentals/labels.html":{"level":2,"children":[],"href":"/tutorials/fundamentals/labels.html","text":"labels layer tutorial"},"/tutorials/fundamentals/image.html":{"level":2,"children":[],"href":"/tutorials/fundamentals/image.html","text":"image layer tutorial"},"/tutorials/fundamentals/viewer.html":{"level":2,"children":[],"href":"/tutorials/fundamentals/viewer.html","text":"napari viewer tutorial"},"/tutorials/fundamentals/getting_started.html":{"level":2,"children":[],"href":"/tutorials/fundamentals/getting_started.html","text":"Getting started with napari"},"/tutorials/fundamentals/installation.html":{"level":2,"children":[],"href":"/tutorials/fundamentals/installation.html","text":"How to install napari on your machine"}},"rootGlobalHeaders":["/tutorials/start_index.html","/tutorials/index.html","/howtos/index.html","/guides/stable/index.html","/plugins/stable/index.html","/community/index.html","/api/stable/index.html","/developers/index.html","/glossary.html","/release/index.html","/roadmaps/index.html","https://github.com/napari/napari","https://napari-hub.org"],"pageTitle":"Annotating segmentation with text and bounding boxes","pageFrontMatter":{},"previewImage":"../../_images/annotated_bbox.png","previewDescription":"In this tutorial, we will use napari to view and annotate a segmentation with bounding boxes and text labels. Here we perform a segmentation by setting an intensity threshold with Otsu’s method, bu...","appScripts":[{"src":"/_static/documentation_options.js"},{"src":"/_static/jquery.js"},{"src":"/_static/underscore.js"},{"src":"/_static/doctools.js"},{"src":"/_static/togglebutton.js"},{"src":"/_static/clipboard.min.js"},{"src":"/_static/copybutton.js"},{"children":"var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';"},{"src":"https://unpkg.com/thebe@0.5.1/lib/index.js"},{"children":"\n        const thebe_selector = \".thebe\"\n        const thebe_selector_input = \"pre\"\n        const thebe_selector_output = \".output\"\n    "},{"src":"/_static/sphinx-thebe.js"}],"appStyleSheets":[{"href":"/_static/pygments.css","rel":"stylesheet"},{"href":"/_static/togglebutton.css","rel":"stylesheet","type":"text/css"},{"href":"/_static/copybutton.css","rel":"stylesheet","type":"text/css"},{"href":"/_static/mystnb.css","rel":"stylesheet","type":"text/css"},{"href":"/_static/sphinx-thebe.css","rel":"stylesheet","type":"text/css"},{"href":"/_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css","rel":"stylesheet","type":"text/css"},{"href":"/_static/panels-variables.06eb56fa6e07937060861dad626602ad.css","rel":"stylesheet","type":"text/css"}],"pageBodyHtml":"\n        <div id=\"documentation_options\" data-url_root=\"../../\"></div>\n        <div class=\"section\" id=\"annotating-segmentation-with-text-and-bounding-boxes\">\n\n<p>In this tutorial, we will use napari to view and annotate a segmentation with bounding boxes and text labels. Here we perform a segmentation by setting an intensity threshold with Otsu’s method, but this same approach could also be used to visualize the results of other image processing algorithms such as <a class=\"reference external\" href=\"https://www.tensorflow.org/lite/models/object_detection/overview\" target=\"_blank\" rel=\"noreferrer\">object detection with neural networks</a>.</p>\n<p><img alt=\"image: annotated bounding box\" src=\"../../_images/annotated_bbox.png\"></p>\n<p>The completed code is shown below and also can be found in the napari examples directory (<a class=\"reference external\" href=\"https://github.com/napari/napari/blob/master/examples/annotate_segmentation_with_text.py\" target=\"_blank\" rel=\"noreferrer\"><code class=\"docutils literal notranslate\"><span class=\"pre\">annotate_segmentation_with_text.py</span></code></a>).</p>\n<div class=\"highlight-python notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"sd\">\"\"\"</span>\n<span class=\"sd\">Perform a segmentation and annotate the results with</span>\n<span class=\"sd\">bounding boxes and text</span>\n<span class=\"sd\">\"\"\"</span>\n<span class=\"kn\">import</span> <span class=\"nn\">numpy</span> <span class=\"k\">as</span> <span class=\"nn\">np</span>\n<span class=\"kn\">from</span> <span class=\"nn\">skimage</span> <span class=\"kn\">import</span> <span class=\"n\">data</span>\n<span class=\"kn\">from</span> <span class=\"nn\">skimage.filters</span> <span class=\"kn\">import</span> <span class=\"n\">threshold_otsu</span>\n<span class=\"kn\">from</span> <span class=\"nn\">skimage.segmentation</span> <span class=\"kn\">import</span> <span class=\"n\">clear_border</span>\n<span class=\"kn\">from</span> <span class=\"nn\">skimage.measure</span> <span class=\"kn\">import</span> <span class=\"n\">label</span><span class=\"p\">,</span> <span class=\"n\">regionprops_table</span>\n<span class=\"kn\">from</span> <span class=\"nn\">skimage.morphology</span> <span class=\"kn\">import</span> <span class=\"n\">closing</span><span class=\"p\">,</span> <span class=\"n\">square</span><span class=\"p\">,</span> <span class=\"n\">remove_small_objects</span>\n<span class=\"kn\">import</span> <span class=\"nn\">napari</span>\n\n\n<span class=\"k\">def</span> <span class=\"nf\">segment</span><span class=\"p\">(</span><span class=\"n\">image</span><span class=\"p\">):</span>\n    <span class=\"sd\">\"\"\"Segment an image using an intensity threshold determined via</span>\n<span class=\"sd\">    Otsu's method.</span>\n\n<span class=\"sd\">    Parameters</span>\n<span class=\"sd\">    ----------</span>\n<span class=\"sd\">    image : np.ndarray</span>\n<span class=\"sd\">        The image to be segmented</span>\n\n<span class=\"sd\">    Returns</span>\n<span class=\"sd\">    -------</span>\n<span class=\"sd\">    label_image : np.ndarray</span>\n<span class=\"sd\">        The resulting image where each detected object labeled with a unique integer.</span>\n<span class=\"sd\">    \"\"\"</span>\n    <span class=\"c1\"># apply threshold</span>\n    <span class=\"n\">thresh</span> <span class=\"o\">=</span> <span class=\"n\">threshold_otsu</span><span class=\"p\">(</span><span class=\"n\">image</span><span class=\"p\">)</span>\n    <span class=\"n\">bw</span> <span class=\"o\">=</span> <span class=\"n\">closing</span><span class=\"p\">(</span><span class=\"n\">image</span> <span class=\"o\">&gt;</span> <span class=\"n\">thresh</span><span class=\"p\">,</span> <span class=\"n\">square</span><span class=\"p\">(</span><span class=\"mi\">4</span><span class=\"p\">))</span>\n\n    <span class=\"c1\"># remove artifacts connected to image border</span>\n    <span class=\"n\">cleared</span> <span class=\"o\">=</span> <span class=\"n\">remove_small_objects</span><span class=\"p\">(</span><span class=\"n\">clear_border</span><span class=\"p\">(</span><span class=\"n\">bw</span><span class=\"p\">),</span> <span class=\"mi\">20</span><span class=\"p\">)</span>\n\n    <span class=\"c1\"># label image regions</span>\n    <span class=\"n\">label_image</span> <span class=\"o\">=</span> <span class=\"n\">label</span><span class=\"p\">(</span><span class=\"n\">cleared</span><span class=\"p\">)</span>\n\n    <span class=\"k\">return</span> <span class=\"n\">label_image</span>\n\n\n<span class=\"k\">def</span> <span class=\"nf\">make_bbox</span><span class=\"p\">(</span><span class=\"n\">bbox_extents</span><span class=\"p\">):</span>\n    <span class=\"sd\">\"\"\"Get the coordinates of the corners of a</span>\n<span class=\"sd\">    bounding box from the extents</span>\n\n<span class=\"sd\">    Parameters</span>\n<span class=\"sd\">    ----------</span>\n<span class=\"sd\">    bbox_extents : list (4xN)</span>\n<span class=\"sd\">        List of the extents of the bounding boxes for each of the N regions.</span>\n<span class=\"sd\">        Should be ordered: [min_row, min_column, max_row, max_column]</span>\n\n<span class=\"sd\">    Returns</span>\n<span class=\"sd\">    -------</span>\n<span class=\"sd\">    bbox_rect : np.ndarray</span>\n<span class=\"sd\">        The corners of the bounding box. Can be input directly into a</span>\n<span class=\"sd\">        napari Shapes layer.</span>\n<span class=\"sd\">    \"\"\"</span>\n    <span class=\"n\">minr</span> <span class=\"o\">=</span> <span class=\"n\">bbox_extents</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span>\n    <span class=\"n\">minc</span> <span class=\"o\">=</span> <span class=\"n\">bbox_extents</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">]</span>\n    <span class=\"n\">maxr</span> <span class=\"o\">=</span> <span class=\"n\">bbox_extents</span><span class=\"p\">[</span><span class=\"mi\">2</span><span class=\"p\">]</span>\n    <span class=\"n\">maxc</span> <span class=\"o\">=</span> <span class=\"n\">bbox_extents</span><span class=\"p\">[</span><span class=\"mi\">3</span><span class=\"p\">]</span>\n\n    <span class=\"n\">bbox_rect</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">array</span><span class=\"p\">(</span>\n        <span class=\"p\">[[</span><span class=\"n\">minr</span><span class=\"p\">,</span> <span class=\"n\">minc</span><span class=\"p\">],</span> <span class=\"p\">[</span><span class=\"n\">maxr</span><span class=\"p\">,</span> <span class=\"n\">minc</span><span class=\"p\">],</span> <span class=\"p\">[</span><span class=\"n\">maxr</span><span class=\"p\">,</span> <span class=\"n\">maxc</span><span class=\"p\">],</span> <span class=\"p\">[</span><span class=\"n\">minr</span><span class=\"p\">,</span> <span class=\"n\">maxc</span><span class=\"p\">]]</span>\n    <span class=\"p\">)</span>\n    <span class=\"n\">bbox_rect</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">moveaxis</span><span class=\"p\">(</span><span class=\"n\">bbox_rect</span><span class=\"p\">,</span> <span class=\"mi\">2</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">)</span>\n\n    <span class=\"k\">return</span> <span class=\"n\">bbox_rect</span>\n\n\n<span class=\"k\">def</span> <span class=\"nf\">circularity</span><span class=\"p\">(</span><span class=\"n\">perimeter</span><span class=\"p\">,</span> <span class=\"n\">area</span><span class=\"p\">):</span>\n    <span class=\"sd\">\"\"\"Calculate the circularity of the region</span>\n\n<span class=\"sd\">    Parameters</span>\n<span class=\"sd\">    ----------</span>\n<span class=\"sd\">    perimeter : float</span>\n<span class=\"sd\">        the perimeter of the region</span>\n<span class=\"sd\">    area : float</span>\n<span class=\"sd\">        the area of the region</span>\n\n<span class=\"sd\">    Returns</span>\n<span class=\"sd\">    -------</span>\n<span class=\"sd\">    circularity : float</span>\n<span class=\"sd\">        The circularity of the region as defined by 4*pi*area / perimeter^2</span>\n<span class=\"sd\">    \"\"\"</span>\n    <span class=\"n\">circularity</span> <span class=\"o\">=</span> <span class=\"mi\">4</span> <span class=\"o\">*</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">pi</span> <span class=\"o\">*</span> <span class=\"n\">area</span> <span class=\"o\">/</span> <span class=\"p\">(</span><span class=\"n\">perimeter</span> <span class=\"o\">**</span> <span class=\"mi\">2</span><span class=\"p\">)</span>\n\n    <span class=\"k\">return</span> <span class=\"n\">circularity</span>\n\n\n<span class=\"c1\"># load the image and segment it</span>\n<span class=\"n\">image</span> <span class=\"o\">=</span> <span class=\"n\">data</span><span class=\"o\">.</span><span class=\"n\">coins</span><span class=\"p\">()[</span><span class=\"mi\">50</span><span class=\"p\">:</span><span class=\"o\">-</span><span class=\"mi\">50</span><span class=\"p\">,</span> <span class=\"mi\">50</span><span class=\"p\">:</span><span class=\"o\">-</span><span class=\"mi\">50</span><span class=\"p\">]</span>\n<span class=\"n\">label_image</span> <span class=\"o\">=</span> <span class=\"n\">segment</span><span class=\"p\">(</span><span class=\"n\">image</span><span class=\"p\">)</span>\n\n<span class=\"c1\"># create the properties dictionary</span>\n<span class=\"n\">properties</span> <span class=\"o\">=</span> <span class=\"n\">regionprops_table</span><span class=\"p\">(</span>\n    <span class=\"n\">label_image</span><span class=\"p\">,</span> <span class=\"n\">properties</span><span class=\"o\">=</span><span class=\"p\">(</span><span class=\"s1\">'label'</span><span class=\"p\">,</span> <span class=\"s1\">'bbox'</span><span class=\"p\">,</span> <span class=\"s1\">'perimeter'</span><span class=\"p\">,</span> <span class=\"s1\">'area'</span><span class=\"p\">)</span>\n<span class=\"p\">)</span>\n<span class=\"n\">properties</span><span class=\"p\">[</span><span class=\"s1\">'circularity'</span><span class=\"p\">]</span> <span class=\"o\">=</span> <span class=\"n\">circularity</span><span class=\"p\">(</span>\n    <span class=\"n\">properties</span><span class=\"p\">[</span><span class=\"s1\">'perimeter'</span><span class=\"p\">],</span> <span class=\"n\">properties</span><span class=\"p\">[</span><span class=\"s1\">'area'</span><span class=\"p\">]</span>\n<span class=\"p\">)</span>\n\n<span class=\"c1\"># create the bounding box rectangles</span>\n<span class=\"n\">bbox_rects</span> <span class=\"o\">=</span> <span class=\"n\">make_bbox</span><span class=\"p\">([</span><span class=\"n\">properties</span><span class=\"p\">[</span><span class=\"sa\">f</span><span class=\"s1\">'bbox-</span><span class=\"si\">{</span><span class=\"n\">i</span><span class=\"si\">}</span><span class=\"s1\">'</span><span class=\"p\">]</span> <span class=\"k\">for</span> <span class=\"n\">i</span> <span class=\"ow\">in</span> <span class=\"nb\">range</span><span class=\"p\">(</span><span class=\"mi\">4</span><span class=\"p\">)])</span>\n\n<span class=\"c1\"># specify the display parameters for the text</span>\n<span class=\"n\">text_parameters</span> <span class=\"o\">=</span> <span class=\"p\">{</span>\n    <span class=\"s1\">'text'</span><span class=\"p\">:</span> <span class=\"s1\">'label: </span><span class=\"si\">{label}</span><span class=\"se\">\\n</span><span class=\"s1\">circ: </span><span class=\"si\">{circularity:.2f}</span><span class=\"s1\">'</span><span class=\"p\">,</span>\n    <span class=\"s1\">'size'</span><span class=\"p\">:</span> <span class=\"mi\">12</span><span class=\"p\">,</span>\n    <span class=\"s1\">'color'</span><span class=\"p\">:</span> <span class=\"s1\">'green'</span><span class=\"p\">,</span>\n    <span class=\"s1\">'anchor'</span><span class=\"p\">:</span> <span class=\"s1\">'upper_left'</span><span class=\"p\">,</span>\n    <span class=\"s1\">'translation'</span><span class=\"p\">:</span> <span class=\"p\">[</span><span class=\"o\">-</span><span class=\"mi\">3</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">],</span>\n<span class=\"p\">}</span>\n\n<span class=\"c1\"># initialise viewer with coins image</span>\n<span class=\"n\">viewer</span> <span class=\"o\">=</span> <span class=\"n\">napari</span><span class=\"o\">.</span><span class=\"n\">view_image</span><span class=\"p\">(</span><span class=\"n\">image</span><span class=\"p\">,</span> <span class=\"n\">name</span><span class=\"o\">=</span><span class=\"s1\">'coins'</span><span class=\"p\">,</span> <span class=\"n\">rgb</span><span class=\"o\">=</span><span class=\"kc\">False</span><span class=\"p\">)</span>\n\n<span class=\"c1\"># add the labels</span>\n<span class=\"n\">label_layer</span> <span class=\"o\">=</span> <span class=\"n\">viewer</span><span class=\"o\">.</span><span class=\"n\">add_labels</span><span class=\"p\">(</span><span class=\"n\">label_image</span><span class=\"p\">,</span> <span class=\"n\">name</span><span class=\"o\">=</span><span class=\"s1\">'segmentation'</span><span class=\"p\">)</span>\n\n<span class=\"n\">shapes_layer</span> <span class=\"o\">=</span> <span class=\"n\">viewer</span><span class=\"o\">.</span><span class=\"n\">add_shapes</span><span class=\"p\">(</span>\n    <span class=\"n\">bbox_rects</span><span class=\"p\">,</span>\n    <span class=\"n\">face_color</span><span class=\"o\">=</span><span class=\"s1\">'transparent'</span><span class=\"p\">,</span>\n    <span class=\"n\">edge_color</span><span class=\"o\">=</span><span class=\"s1\">'green'</span><span class=\"p\">,</span>\n    <span class=\"n\">properties</span><span class=\"o\">=</span><span class=\"n\">properties</span><span class=\"p\">,</span>\n    <span class=\"n\">text</span><span class=\"o\">=</span><span class=\"n\">text_parameters</span><span class=\"p\">,</span>\n    <span class=\"n\">name</span><span class=\"o\">=</span><span class=\"s1\">'bounding box'</span><span class=\"p\">,</span>\n<span class=\"p\">)</span>\n<span class=\"n\">napari</span><span class=\"o\">.</span><span class=\"n\">run</span><span class=\"p\">()</span>\n\n</pre></div>\n</div>\n<div class=\"section\" id=\"segmentation\">\n<h2>Segmentation<a class=\"headerlink\" href=\"#segmentation\" title=\"Permalink to this headline\">¶</a></h2>\n<p>We start by defining a function to perform segmentation of an image based on intensity. Based on the <a class=\"reference external\" href=\"https://scikit-image.org/docs/stable/auto_examples/applications/plot_thresholding.html\" target=\"_blank\" rel=\"noreferrer\">skimage segmentation example</a>, we determine the threshold intensity that separates the foreground and background pixels using <a class=\"reference external\" href=\"https://en.wikipedia.org/wiki/Otsu%27s_method\" target=\"_blank\" rel=\"noreferrer\">Otsu’s method</a>. We then perform some cleanup and generate a label image where each discrete region is given a unique integer index.</p>\n<div class=\"highlight-python notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"k\">def</span> <span class=\"nf\">segment</span><span class=\"p\">(</span><span class=\"n\">image</span><span class=\"p\">):</span>\n    <span class=\"sd\">\"\"\"Segment an image using an intensity threshold</span>\n<span class=\"sd\">    determined via Otsu's method.</span>\n\n<span class=\"sd\">    Parameters</span>\n<span class=\"sd\">    ----------</span>\n<span class=\"sd\">    image : np.ndarray</span>\n<span class=\"sd\">        The image to be segmented</span>\n\n<span class=\"sd\">    Returns</span>\n<span class=\"sd\">    -------</span>\n<span class=\"sd\">    label_image : np.ndarray</span>\n<span class=\"sd\">        The resulting image where each detected object</span>\n<span class=\"sd\">        is labeled with a unique integer.</span>\n<span class=\"sd\">    \"\"\"</span>\n    <span class=\"c1\"># apply threshold</span>\n    <span class=\"n\">thresh</span> <span class=\"o\">=</span> <span class=\"n\">threshold_otsu</span><span class=\"p\">(</span><span class=\"n\">image</span><span class=\"p\">)</span>\n    <span class=\"n\">bw</span> <span class=\"o\">=</span> <span class=\"n\">closing</span><span class=\"p\">(</span><span class=\"n\">image</span> <span class=\"o\">&gt;</span> <span class=\"n\">thresh</span><span class=\"p\">,</span> <span class=\"n\">square</span><span class=\"p\">(</span><span class=\"mi\">4</span><span class=\"p\">))</span>\n\n    <span class=\"c1\"># remove artifacts connected to image border</span>\n    <span class=\"n\">cleared</span> <span class=\"o\">=</span> <span class=\"n\">remove_small_objects</span><span class=\"p\">(</span><span class=\"n\">clear_border</span><span class=\"p\">(</span><span class=\"n\">bw</span><span class=\"p\">),</span> <span class=\"mi\">20</span><span class=\"p\">)</span>\n\n    <span class=\"c1\"># label image regions</span>\n    <span class=\"n\">label_image</span> <span class=\"o\">=</span> <span class=\"n\">label</span><span class=\"p\">(</span><span class=\"n\">cleared</span><span class=\"p\">)</span>\n\n    <span class=\"k\">return</span> <span class=\"n\">label_image</span>\n</pre></div>\n</div>\n<p>We can test the segmentation and view it in napari.</p>\n<div class=\"highlight-python notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"c1\"># load the image and segment it</span>\n<span class=\"n\">image</span> <span class=\"o\">=</span> <span class=\"n\">data</span><span class=\"o\">.</span><span class=\"n\">coins</span><span class=\"p\">()[</span><span class=\"mi\">50</span><span class=\"p\">:</span><span class=\"o\">-</span><span class=\"mi\">50</span><span class=\"p\">,</span> <span class=\"mi\">50</span><span class=\"p\">:</span><span class=\"o\">-</span><span class=\"mi\">50</span><span class=\"p\">]</span>\n<span class=\"n\">label_image</span> <span class=\"o\">=</span> <span class=\"n\">segment</span><span class=\"p\">(</span><span class=\"n\">image</span><span class=\"p\">)</span>\n\n<span class=\"c1\"># initialize viewer with coins image</span>\n<span class=\"n\">viewer</span> <span class=\"o\">=</span> <span class=\"n\">napari</span><span class=\"o\">.</span><span class=\"n\">view_image</span><span class=\"p\">(</span><span class=\"n\">image</span><span class=\"p\">,</span> <span class=\"n\">name</span><span class=\"o\">=</span><span class=\"s1\">'coins'</span><span class=\"p\">,</span> <span class=\"n\">rgb</span><span class=\"o\">=</span><span class=\"kc\">False</span><span class=\"p\">)</span>\n\n<span class=\"c1\"># add the labels</span>\n<span class=\"n\">label_layer</span> <span class=\"o\">=</span> <span class=\"n\">viewer</span><span class=\"o\">.</span><span class=\"n\">add_labels</span><span class=\"p\">(</span><span class=\"n\">label_image</span><span class=\"p\">,</span> <span class=\"n\">name</span><span class=\"o\">=</span><span class=\"s1\">'segmentation'</span><span class=\"p\">)</span>\n\n<span class=\"n\">napari</span><span class=\"o\">.</span><span class=\"n\">run</span><span class=\"p\">()</span>\n</pre></div>\n</div>\n<p><img alt=\"image: segmentation labels\" src=\"../../_images/segmentation_labels.png\"></p>\n</div>\n<div class=\"section\" id=\"analyzing-the-segmentation\">\n<h2>Analyzing the segmentation<a class=\"headerlink\" href=\"#analyzing-the-segmentation\" title=\"Permalink to this headline\">¶</a></h2>\n<p>Next, we use <a class=\"reference external\" href=\"https://scikit-image.org/docs/dev/api/skimage.measure.html#regionprops-table\" target=\"_blank\" rel=\"noreferrer\"><code class=\"docutils literal notranslate\"><span class=\"pre\">regionprops_table</span></code></a> from skimage to quantify some parameters of each detection object (e.g., area and perimeter).</p>\n<div class=\"highlight-python notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"c1\"># create the properties dictionary</span>\n<span class=\"n\">properties</span> <span class=\"o\">=</span> <span class=\"n\">regionprops_table</span><span class=\"p\">(</span>\n    <span class=\"n\">label_image</span><span class=\"p\">,</span> <span class=\"n\">properties</span><span class=\"o\">=</span><span class=\"p\">(</span><span class=\"s1\">'label'</span><span class=\"p\">,</span> <span class=\"s1\">'bbox'</span><span class=\"p\">,</span> <span class=\"s1\">'perimeter'</span><span class=\"p\">,</span> <span class=\"s1\">'area'</span><span class=\"p\">)</span>\n<span class=\"p\">)</span>\n</pre></div>\n</div>\n<p>Conveniently, <code class=\"docutils literal notranslate\"><span class=\"pre\">regionprops_table()</span></code> returns a dictionary in the same format as the napari layer properties dictionary, so we will be able to use it directly. If we inspect the values of properties, we see each key is the name of the properties and the values are arrays with an element containing the property value for each shape. Note that the bounding boxes have been output as <code class=\"docutils literal notranslate\"><span class=\"pre\">bbox-0</span></code>,  <code class=\"docutils literal notranslate\"><span class=\"pre\">bbox-1</span></code>, <code class=\"docutils literal notranslate\"><span class=\"pre\">bbox-1</span></code>, <code class=\"docutils literal notranslate\"><span class=\"pre\">bbox-2</span></code>, <code class=\"docutils literal notranslate\"><span class=\"pre\">bbox-3</span></code> which correspond with the min_row, min_column, max_row, amnd max_column of each bounding box, respectively.</p>\n<div class=\"highlight-python notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"p\">{</span>\n\t<span class=\"s1\">'label'</span><span class=\"p\">:</span> <span class=\"n\">array</span><span class=\"p\">([</span><span class=\"mi\">1</span><span class=\"p\">,</span> <span class=\"mi\">2</span><span class=\"p\">,</span> <span class=\"mi\">3</span><span class=\"p\">,</span> <span class=\"mi\">4</span><span class=\"p\">,</span> <span class=\"mi\">5</span><span class=\"p\">,</span> <span class=\"mi\">6</span><span class=\"p\">,</span> <span class=\"mi\">7</span><span class=\"p\">,</span> <span class=\"mi\">8</span><span class=\"p\">]),</span>\n\t<span class=\"s1\">'bbox-0'</span><span class=\"p\">:</span> <span class=\"n\">array</span><span class=\"p\">([</span> <span class=\"mi\">46</span><span class=\"p\">,</span>  <span class=\"mi\">55</span><span class=\"p\">,</span>  <span class=\"mi\">57</span><span class=\"p\">,</span>  <span class=\"mi\">60</span><span class=\"p\">,</span> <span class=\"mi\">120</span><span class=\"p\">,</span> <span class=\"mi\">122</span><span class=\"p\">,</span> <span class=\"mi\">125</span><span class=\"p\">,</span> <span class=\"mi\">129</span><span class=\"p\">]),</span>\n\t<span class=\"s1\">'bbox-1'</span><span class=\"p\">:</span> <span class=\"n\">array</span><span class=\"p\">([</span><span class=\"mi\">195</span><span class=\"p\">,</span> <span class=\"mi\">136</span><span class=\"p\">,</span>  <span class=\"mi\">34</span><span class=\"p\">,</span>  <span class=\"mi\">84</span><span class=\"p\">,</span> <span class=\"mi\">139</span><span class=\"p\">,</span> <span class=\"mi\">201</span><span class=\"p\">,</span>  <span class=\"mi\">30</span><span class=\"p\">,</span>  <span class=\"mi\">85</span><span class=\"p\">]),</span>\n\t<span class=\"s1\">'bbox-2'</span><span class=\"p\">:</span> <span class=\"n\">array</span><span class=\"p\">([</span> <span class=\"mi\">94</span><span class=\"p\">,</span>  <span class=\"mi\">94</span><span class=\"p\">,</span>  <span class=\"mi\">95</span><span class=\"p\">,</span>  <span class=\"mi\">95</span><span class=\"p\">,</span> <span class=\"mi\">166</span><span class=\"p\">,</span> <span class=\"mi\">166</span><span class=\"p\">,</span> <span class=\"mi\">167</span><span class=\"p\">,</span> <span class=\"mi\">167</span><span class=\"p\">]),</span>\n\t<span class=\"s1\">'bbox-3'</span><span class=\"p\">:</span> <span class=\"n\">array</span><span class=\"p\">([</span><span class=\"mi\">246</span><span class=\"p\">,</span> <span class=\"mi\">177</span><span class=\"p\">,</span>  <span class=\"mi\">72</span><span class=\"p\">,</span> <span class=\"mi\">124</span><span class=\"p\">,</span> <span class=\"mi\">187</span><span class=\"p\">,</span> <span class=\"mi\">247</span><span class=\"p\">,</span>  <span class=\"mi\">74</span><span class=\"p\">,</span> <span class=\"mi\">124</span><span class=\"p\">]),</span>\n\t<span class=\"s1\">'perimeter'</span><span class=\"p\">:</span>\n\t\t<span class=\"n\">array</span><span class=\"p\">(</span>\n\t\t\t<span class=\"p\">[</span>\n\t\t\t\t<span class=\"mf\">165.88225099</span><span class=\"p\">,</span> <span class=\"mf\">129.05382387</span><span class=\"p\">,</span> <span class=\"mf\">123.98275606</span><span class=\"p\">,</span> <span class=\"mf\">121.98275606</span><span class=\"p\">,</span>\n       \t\t\t<span class=\"mf\">155.88225099</span><span class=\"p\">,</span> <span class=\"mf\">149.05382387</span><span class=\"p\">,</span> <span class=\"mf\">140.46803743</span><span class=\"p\">,</span> <span class=\"mf\">125.39696962</span>\n       \t\t<span class=\"p\">]</span>\n   \t\t<span class=\"p\">),</span>\n   \t<span class=\"s1\">'area'</span><span class=\"p\">:</span> <span class=\"n\">array</span><span class=\"p\">([</span><span class=\"mi\">1895</span><span class=\"p\">,</span> <span class=\"mi\">1212</span><span class=\"p\">,</span> <span class=\"mi\">1124</span><span class=\"p\">,</span> <span class=\"mi\">1102</span><span class=\"p\">,</span> <span class=\"mi\">1720</span><span class=\"p\">,</span> <span class=\"mi\">1519</span><span class=\"p\">,</span> <span class=\"mi\">1475</span><span class=\"p\">,</span> <span class=\"mi\">1155</span><span class=\"p\">])</span>\n<span class=\"p\">}</span>\n</pre></div>\n</div>\n<p>Since we know the coins are circular, we want to calculate the circularity of each detected region. We define a function <code class=\"docutils literal notranslate\"><span class=\"pre\">circularity()</span></code> to determine the circularity of each region.</p>\n<div class=\"highlight-python notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"k\">def</span> <span class=\"nf\">circularity</span><span class=\"p\">(</span><span class=\"n\">perimeter</span><span class=\"p\">,</span> <span class=\"n\">area</span><span class=\"p\">):</span>\n    <span class=\"sd\">\"\"\"Calculate the circularity of the region</span>\n\n<span class=\"sd\">    Parameters</span>\n<span class=\"sd\">    ----------</span>\n<span class=\"sd\">    perimeter : float</span>\n<span class=\"sd\">        the perimeter of the region</span>\n<span class=\"sd\">    area : float</span>\n<span class=\"sd\">        the area of the region</span>\n\n<span class=\"sd\">    Returns</span>\n<span class=\"sd\">    -------</span>\n<span class=\"sd\">    circularity : float</span>\n<span class=\"sd\">        The circularity of the region as defined by 4*pi*area / perimeter^2</span>\n<span class=\"sd\">    \"\"\"</span>\n    <span class=\"n\">circularity</span> <span class=\"o\">=</span> <span class=\"mi\">4</span> <span class=\"o\">*</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">pi</span> <span class=\"o\">*</span> <span class=\"n\">area</span> <span class=\"o\">/</span> <span class=\"p\">(</span><span class=\"n\">perimeter</span> <span class=\"o\">**</span> <span class=\"mi\">2</span><span class=\"p\">)</span>\n\n    <span class=\"k\">return</span> <span class=\"n\">circularity</span>\n</pre></div>\n</div>\n<p>We can then calculate the circularity of each region and save it as a property.</p>\n<div class=\"highlight-python notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">properties</span><span class=\"p\">[</span><span class=\"s1\">'circularity'</span><span class=\"p\">]</span> <span class=\"o\">=</span> <span class=\"n\">circularity</span><span class=\"p\">(</span>\n    <span class=\"n\">properties</span><span class=\"p\">[</span><span class=\"s1\">'perimeter'</span><span class=\"p\">],</span> <span class=\"n\">properties</span><span class=\"p\">[</span><span class=\"s1\">'area'</span><span class=\"p\">]</span>\n<span class=\"p\">)</span>\n</pre></div>\n</div>\n<p>We will use a napari shapes layer to visualize the bounding box of the segmentation. The napari shapes layer requires each shape to be defined by the coordinates of corner. Since regionprops returns the bounding box as a tuple of <code class=\"docutils literal notranslate\"><span class=\"pre\">(min_row,</span> <span class=\"pre\">min_column,</span> <span class=\"pre\">max_row,</span> <span class=\"pre\">max_column)</span></code> we define a function <code class=\"docutils literal notranslate\"><span class=\"pre\">make_bbox()</span></code> to convert the regionprops bounding box to the napari shapes format.</p>\n<div class=\"highlight-python notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"k\">def</span> <span class=\"nf\">make_bbox</span><span class=\"p\">(</span><span class=\"n\">bbox_extents</span><span class=\"p\">):</span>\n    <span class=\"sd\">\"\"\"Get the coordinates of the corners of a</span>\n<span class=\"sd\">    bounding box from the extents</span>\n\n<span class=\"sd\">    Parameters</span>\n<span class=\"sd\">    ----------</span>\n<span class=\"sd\">    bbox_extents : list (4xN)</span>\n<span class=\"sd\">        List of the extents of the bounding boxes for each of the N regions.</span>\n<span class=\"sd\">        Should be ordered: [min_row, min_column, max_row, max_column]</span>\n\n<span class=\"sd\">    Returns</span>\n<span class=\"sd\">    -------</span>\n<span class=\"sd\">    bbox_rect : np.ndarray</span>\n<span class=\"sd\">        The corners of the bounding box. Can be input directly into a</span>\n<span class=\"sd\">        napari Shapes layer.</span>\n<span class=\"sd\">    \"\"\"</span>\n    <span class=\"n\">minr</span> <span class=\"o\">=</span> <span class=\"n\">bbox_extents</span><span class=\"p\">[</span><span class=\"mi\">0</span><span class=\"p\">]</span>\n    <span class=\"n\">minc</span> <span class=\"o\">=</span> <span class=\"n\">bbox_extents</span><span class=\"p\">[</span><span class=\"mi\">1</span><span class=\"p\">]</span>\n    <span class=\"n\">maxr</span> <span class=\"o\">=</span> <span class=\"n\">bbox_extents</span><span class=\"p\">[</span><span class=\"mi\">2</span><span class=\"p\">]</span>\n    <span class=\"n\">maxc</span> <span class=\"o\">=</span> <span class=\"n\">bbox_extents</span><span class=\"p\">[</span><span class=\"mi\">3</span><span class=\"p\">]</span>\n\n    <span class=\"n\">bbox_rect</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">array</span><span class=\"p\">(</span>\n        <span class=\"p\">[[</span><span class=\"n\">minr</span><span class=\"p\">,</span> <span class=\"n\">minc</span><span class=\"p\">],</span> <span class=\"p\">[</span><span class=\"n\">maxr</span><span class=\"p\">,</span> <span class=\"n\">minc</span><span class=\"p\">],</span> <span class=\"p\">[</span><span class=\"n\">maxr</span><span class=\"p\">,</span> <span class=\"n\">maxc</span><span class=\"p\">],</span> <span class=\"p\">[</span><span class=\"n\">minr</span><span class=\"p\">,</span> <span class=\"n\">maxc</span><span class=\"p\">]]</span>\n    <span class=\"p\">)</span>\n    <span class=\"n\">bbox_rect</span> <span class=\"o\">=</span> <span class=\"n\">np</span><span class=\"o\">.</span><span class=\"n\">moveaxis</span><span class=\"p\">(</span><span class=\"n\">bbox_rect</span><span class=\"p\">,</span> <span class=\"mi\">2</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">)</span>\n\n    <span class=\"k\">return</span> <span class=\"n\">bbox_rect</span>\n</pre></div>\n</div>\n<p>Finally, we can use an list comprension to pass the bounding box extents to <code class=\"docutils literal notranslate\"><span class=\"pre\">make_bbox()</span></code> and calculate the bounding box corners required by the <code class=\"docutils literal notranslate\"><span class=\"pre\">Shapes</span></code> layer.</p>\n<div class=\"highlight-python notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"c1\"># create the bounding box rectangles</span>\n<span class=\"n\">bbox_rects</span> <span class=\"o\">=</span> <span class=\"n\">make_bbox</span><span class=\"p\">([</span><span class=\"n\">properties</span><span class=\"p\">[</span><span class=\"sa\">f</span><span class=\"s1\">'bbox-</span><span class=\"si\">{</span><span class=\"n\">i</span><span class=\"si\">}</span><span class=\"s1\">'</span><span class=\"p\">]</span> <span class=\"k\">for</span> <span class=\"n\">i</span> <span class=\"ow\">in</span> <span class=\"nb\">range</span><span class=\"p\">(</span><span class=\"mi\">4</span><span class=\"p\">)])</span>\n</pre></div>\n</div>\n</div>\n<div class=\"section\" id=\"visualizing-the-segmentation-results\">\n<h2>Visualizing the segmentation results<a class=\"headerlink\" href=\"#visualizing-the-segmentation-results\" title=\"Permalink to this headline\">¶</a></h2>\n<p>Now that we have performed out analysis, we can visualize the results in napari. To do so, we will utilize 3 napari layer types: (1) Image, (2) Labels, and (3) Shapes.</p>\n<p>As we saw above in the segmentation section, we can visualize the original image and the resulting label images as follows:</p>\n<div class=\"highlight-python notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"c1\"># initialise viewer with coins image</span>\n<span class=\"n\">viewer</span> <span class=\"o\">=</span> <span class=\"n\">napari</span><span class=\"o\">.</span><span class=\"n\">view_image</span><span class=\"p\">(</span><span class=\"n\">image</span><span class=\"p\">,</span> <span class=\"n\">name</span><span class=\"o\">=</span><span class=\"s1\">'coins'</span><span class=\"p\">,</span> <span class=\"n\">rgb</span><span class=\"o\">=</span><span class=\"kc\">False</span><span class=\"p\">)</span>\n\n<span class=\"c1\"># add the labels</span>\n<span class=\"n\">label_layer</span> <span class=\"o\">=</span> <span class=\"n\">viewer</span><span class=\"o\">.</span><span class=\"n\">add_labels</span><span class=\"p\">(</span><span class=\"n\">label_image</span><span class=\"p\">,</span> <span class=\"n\">name</span><span class=\"o\">=</span><span class=\"s1\">'segmentation'</span><span class=\"p\">)</span>\n\n<span class=\"n\">napari</span><span class=\"o\">.</span><span class=\"n\">run</span><span class=\"p\">()</span>\n</pre></div>\n</div>\n<p>Next, we will use the Shapes layer to overlay the bounding boxes for each detected object as well as display the calculated circularity. The code for creating the Shapes layer is listed here and each keyword argument is explained below.</p>\n<div class=\"highlight-python notranslate\"><div class=\"highlight\"><pre><span></span>    <span class=\"n\">shapes_layer</span> <span class=\"o\">=</span> <span class=\"n\">viewer</span><span class=\"o\">.</span><span class=\"n\">add_shapes</span><span class=\"p\">(</span>\n        <span class=\"n\">bbox_rects</span><span class=\"p\">,</span>\n        <span class=\"n\">face_color</span><span class=\"o\">=</span><span class=\"s1\">'transparent'</span><span class=\"p\">,</span>\n        <span class=\"n\">edge_color</span><span class=\"o\">=</span><span class=\"s1\">'green'</span><span class=\"p\">,</span>\n        <span class=\"n\">name</span><span class=\"o\">=</span><span class=\"s1\">'bounding box'</span>\n    <span class=\"p\">)</span>\n</pre></div>\n</div>\n<p><img alt=\"image: segmentation bounding box\" src=\"../../_images/segmentation_bbox.png\"></p>\n<p>The first positional argument (<code class=\"docutils literal notranslate\"><span class=\"pre\">bbox_rects</span></code>) contains the bounding boxes we created above. We specified that the face of each bounding box has no color (<code class=\"docutils literal notranslate\"><span class=\"pre\">face_color='transparent'</span></code>) and the edges of the bounding box are green (<code class=\"docutils literal notranslate\"><span class=\"pre\">edge_color='green'</span></code>). Finally, the name of the layer displayed in the layer list in the napari GUI is <code class=\"docutils literal notranslate\"><span class=\"pre\">bounding</span> <span class=\"pre\">box</span></code> (<code class=\"docutils literal notranslate\"><span class=\"pre\">name='bounding</span> <span class=\"pre\">box'</span></code>).</p>\n</div>\n<div class=\"section\" id=\"annotating-shapes-with-text\">\n<h2>Annotating shapes with text<a class=\"headerlink\" href=\"#annotating-shapes-with-text\" title=\"Permalink to this headline\">¶</a></h2>\n<p>We can further annotate our analysis by using text to display properties of each segmentation. The code to create a shapes layer with text is pasted here and explained below.</p>\n<div class=\"highlight-python notranslate\"><div class=\"highlight\"><pre><span></span>    <span class=\"n\">shapes_layer</span> <span class=\"o\">=</span> <span class=\"n\">viewer</span><span class=\"o\">.</span><span class=\"n\">add_shapes</span><span class=\"p\">(</span>\n        <span class=\"n\">bbox_rects</span><span class=\"p\">,</span>\n        <span class=\"n\">face_color</span><span class=\"o\">=</span><span class=\"s1\">'transparent'</span><span class=\"p\">,</span>\n        <span class=\"n\">edge_color</span><span class=\"o\">=</span><span class=\"s1\">'green'</span><span class=\"p\">,</span>\n        <span class=\"n\">properties</span><span class=\"o\">=</span><span class=\"n\">properties</span><span class=\"p\">,</span>\n        <span class=\"n\">text</span><span class=\"o\">=</span><span class=\"n\">text_parameters</span><span class=\"p\">,</span>\n        <span class=\"n\">name</span><span class=\"o\">=</span><span class=\"s1\">'bounding box'</span>\n    <span class=\"p\">)</span>\n</pre></div>\n</div>\n<p>We will use <code class=\"docutils literal notranslate\"><span class=\"pre\">Shapes.properties</span></code> to store the annotations for each bounding box. The properties are definined as a dictionary where each key is the name of the property (i.e., label, circularity) and the values are arrays where each element contains the value for the corresponding shape (i.e., index matched to the Shape data). As a reminder, we created <code class=\"docutils literal notranslate\"><span class=\"pre\">labels</span></code> and <code class=\"docutils literal notranslate\"><span class=\"pre\">circularity</span></code> above and each is a list containing where each element is property value for the corresponding (i.e., index matched) shape.</p>\n<div class=\"highlight-python notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"c1\"># create the properties dictionary</span>\n<span class=\"n\">properties</span> <span class=\"o\">=</span> <span class=\"p\">{</span>\n    <span class=\"s1\">'label'</span><span class=\"p\">:</span> <span class=\"n\">labels</span><span class=\"p\">,</span>\n    <span class=\"s1\">'circularity'</span><span class=\"p\">:</span> <span class=\"n\">circularity</span><span class=\"p\">,</span>\n<span class=\"p\">}</span>\n</pre></div>\n</div>\n<p>Each bounding box can be annotated with text drawn from the layer <code class=\"docutils literal notranslate\"><span class=\"pre\">properties</span></code>. To specity the text and display properties of the text, we pass a dictionary with the text parameters (<code class=\"docutils literal notranslate\"><span class=\"pre\">text_parameters</span></code>). We define <code class=\"docutils literal notranslate\"><span class=\"pre\">text_parameters</span></code> as:</p>\n<div class=\"highlight-python notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">text_parameters</span> <span class=\"o\">=</span> <span class=\"p\">{</span>\n    <span class=\"s1\">'text'</span><span class=\"p\">:</span> <span class=\"s1\">'label: </span><span class=\"si\">{label}</span><span class=\"se\">\\n</span><span class=\"s1\">circ: </span><span class=\"si\">{circularity:.2f}</span><span class=\"s1\">'</span><span class=\"p\">,</span>\n    <span class=\"s1\">'size'</span><span class=\"p\">:</span> <span class=\"mi\">12</span><span class=\"p\">,</span>\n    <span class=\"s1\">'color'</span><span class=\"p\">:</span> <span class=\"s1\">'green'</span><span class=\"p\">,</span>\n    <span class=\"s1\">'anchor'</span><span class=\"p\">:</span> <span class=\"s1\">'upper_left'</span><span class=\"p\">,</span>\n    <span class=\"s1\">'translation'</span><span class=\"p\">:</span> <span class=\"p\">[</span><span class=\"o\">-</span><span class=\"mi\">3</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">]</span>\n<span class=\"p\">}</span>\n</pre></div>\n</div>\n<p>The <code class=\"docutils literal notranslate\"><span class=\"pre\">text</span></code> key specifies pattern for the text to be displayed. If <code class=\"docutils literal notranslate\"><span class=\"pre\">text</span></code> is set to the name of a <code class=\"docutils literal notranslate\"><span class=\"pre\">properties</span></code> key, the value for that property will be displayed. napari text also accepts f-string-like syntax, as used here. napari will substitute each pair of curly braces(<code class=\"docutils literal notranslate\"><span class=\"pre\">{}</span></code>) with the values from the property specified inside of the curley braces. For numbers, the precision can be specified in the same style as f-strings. Additionally, napari recognizes standard special characters such as <code class=\"docutils literal notranslate\"><span class=\"pre\">\\n</span></code> for new line.</p>\n<p>As an example, if a given object has a <code class=\"docutils literal notranslate\"><span class=\"pre\">label=1</span></code> and <code class=\"docutils literal notranslate\"><span class=\"pre\">circularity=0.8322940</span></code>, the resulting text string would be:</p>\n<div class=\"highlight-default notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"n\">label</span><span class=\"p\">:</span> <span class=\"mi\">1</span>\n<span class=\"n\">circ</span><span class=\"p\">:</span> <span class=\"mf\">0.83</span>\n</pre></div>\n</div>\n<p>We set the text to green (<code class=\"docutils literal notranslate\"><span class=\"pre\">'color':</span> <span class=\"pre\">'green'</span></code>) with a font size of 12 (<code class=\"docutils literal notranslate\"><span class=\"pre\">'size':</span> <span class=\"pre\">12</span></code>). We specify that the text will be anchored in the upper left hand corner of the bounding box (<code class=\"docutils literal notranslate\"><span class=\"pre\">'anchor':</span> <span class=\"pre\">'upper_left'</span></code>). The valid anchors are: <code class=\"docutils literal notranslate\"><span class=\"pre\">'upper_right'</span></code>, <code class=\"docutils literal notranslate\"><span class=\"pre\">'upper_left'</span></code>, <code class=\"docutils literal notranslate\"><span class=\"pre\">'lower_right'</span></code>, <code class=\"docutils literal notranslate\"><span class=\"pre\">'lower_left'</span></code>, and <code class=\"docutils literal notranslate\"><span class=\"pre\">'center'</span></code>. We then offset the text from the anchor in order to make sure it does not overlap with the bounding box edge (<code class=\"docutils literal notranslate\"><span class=\"pre\">'translation':</span> <span class=\"pre\">[-3,</span> <span class=\"pre\">0]</span></code>). The translation is relative to the anchor point. The first dimension is the vertical axis on the canvas (negative is “up”) and the second dimension is along the horizontal axis of the canvas.</p>\n<p>All together, the visualization code is:</p>\n<div class=\"highlight-python notranslate\"><div class=\"highlight\"><pre><span></span><span class=\"c1\"># create the properties dictionary</span>\n<span class=\"n\">properties</span> <span class=\"o\">=</span> <span class=\"p\">{</span>\n    <span class=\"s1\">'label'</span><span class=\"p\">:</span> <span class=\"n\">labels</span><span class=\"p\">,</span>\n    <span class=\"s1\">'circularity'</span><span class=\"p\">:</span> <span class=\"n\">circularity</span><span class=\"p\">,</span>\n<span class=\"p\">}</span>\n\n<span class=\"c1\"># specify the display parameters for the text</span>\n<span class=\"n\">text_kwargs</span> <span class=\"o\">=</span> <span class=\"p\">{</span>\n    <span class=\"s1\">'text'</span><span class=\"p\">:</span> <span class=\"s1\">'label: </span><span class=\"si\">{label}</span><span class=\"se\">\\n</span><span class=\"s1\">circ: </span><span class=\"si\">{circularity:.2f}</span><span class=\"s1\">'</span><span class=\"p\">,</span>\n    <span class=\"s1\">'size'</span><span class=\"p\">:</span> <span class=\"mi\">12</span><span class=\"p\">,</span>\n    <span class=\"s1\">'color'</span><span class=\"p\">:</span> <span class=\"s1\">'green'</span><span class=\"p\">,</span>\n    <span class=\"s1\">'anchor'</span><span class=\"p\">:</span> <span class=\"s1\">'upper_left'</span><span class=\"p\">,</span>\n    <span class=\"s1\">'translation'</span><span class=\"p\">:</span> <span class=\"p\">[</span><span class=\"o\">-</span><span class=\"mi\">3</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">]</span>\n<span class=\"p\">}</span>\n\n<span class=\"c1\"># initialise viewer with coins image</span>\n<span class=\"n\">viewer</span> <span class=\"o\">=</span> <span class=\"n\">napari</span><span class=\"o\">.</span><span class=\"n\">view_image</span><span class=\"p\">(</span><span class=\"n\">image</span><span class=\"p\">,</span> <span class=\"n\">name</span><span class=\"o\">=</span><span class=\"s1\">'coins'</span><span class=\"p\">,</span> <span class=\"n\">rgb</span><span class=\"o\">=</span><span class=\"kc\">False</span><span class=\"p\">)</span>\n\n<span class=\"c1\"># add the labels</span>\n<span class=\"n\">label_layer</span> <span class=\"o\">=</span> <span class=\"n\">viewer</span><span class=\"o\">.</span><span class=\"n\">add_labels</span><span class=\"p\">(</span><span class=\"n\">label_image</span><span class=\"p\">,</span> <span class=\"n\">name</span><span class=\"o\">=</span><span class=\"s1\">'segmentation'</span><span class=\"p\">)</span>\n\n<span class=\"n\">shapes_layer</span> <span class=\"o\">=</span> <span class=\"n\">viewer</span><span class=\"o\">.</span><span class=\"n\">add_shapes</span><span class=\"p\">(</span>\n    <span class=\"n\">bbox_rects</span><span class=\"p\">,</span>\n    <span class=\"n\">face_color</span><span class=\"o\">=</span><span class=\"s1\">'transparent'</span><span class=\"p\">,</span>\n    <span class=\"n\">edge_color</span><span class=\"o\">=</span><span class=\"s1\">'green'</span><span class=\"p\">,</span>\n    <span class=\"n\">properties</span><span class=\"o\">=</span><span class=\"n\">properties</span><span class=\"p\">,</span>\n    <span class=\"n\">text</span><span class=\"o\">=</span><span class=\"n\">text_parameters</span><span class=\"p\">,</span>\n    <span class=\"n\">name</span><span class=\"o\">=</span><span class=\"s1\">'bounding box'</span>\n<span class=\"p\">)</span>\n\n<span class=\"n\">napari</span><span class=\"o\">.</span><span class=\"n\">run</span><span class=\"p\">()</span>\n</pre></div>\n</div>\n</div>\n<div class=\"section\" id=\"summary\">\n<h2>Summary<a class=\"headerlink\" href=\"#summary\" title=\"Permalink to this headline\">¶</a></h2>\n<p>In this tutorial, we have used napari to view and annotate segmentation results.</p>\n<p><img alt=\"image: annotated bounding box\" src=\"../../_images/annotated_bbox.png\"></p>\n</div>\n</div>\n\n    <script type=\"text/x-thebe-config\">\n    {\n        requestKernel: true,\n        binderOptions: {\n            repo: \"binder-examples/jupyter-stacks-datascience\",\n            ref: \"master\",\n        },\n        codeMirrorConfig: {\n            theme: \"abcdef\",\n            mode: \"python\"\n        },\n        kernelOptions: {\n            kernelName: \"python3\",\n            path: \"./tutorials/segmentation\"\n        },\n        predefinedOutput: true\n    }\n    </script>\n    <script>kernelName = 'python3'</script>\n      ","pageHeaders":[{"href":"#segmentation","text":"Segmentation"},{"href":"#analyzing-the-segmentation","text":"Analyzing the segmentation"},{"href":"#visualizing-the-segmentation-results","text":"Visualizing the segmentation results"},{"href":"#annotating-shapes-with-text","text":"Annotating shapes with text"},{"href":"#summary","text":"Summary"}],"ipynbSource":"","mdSource":"/_sources/tutorials/segmentation/annotate_segmentation.md"}},"__N_SSG":true}